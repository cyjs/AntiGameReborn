!function(e,a){if("object"==typeof exports&&"object"==typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var t=a();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(window,function(){return function(e){var a={};function t(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var r in e)t.d(n,r,function(a){return e[a]}.bind(null,r));return n},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="",t(t.s=2)}([function(e,a,t){"use strict";t.d(a,"b",function(){return n}),t.d(a,"a",function(){return r});var n={},r={};window.AGO=n,window.AGB=r},,function(e,a,t){"use strict";t.r(a);var n=t(0);function r(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,a){var t=[],n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(t.push(o.value),!a||t.length!==a);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.a.App={Data:{},Player:{},Page:{overview:{page:"Overview",js:["pages"],css:"pages"},resources:{page:"Resources",js:["pages"],css:"pages"},resourcesettings:{page:"ResourcesSettings",js:["pages"],css:"pages"},station:{page:"Station",js:["pages"],css:"pages"},traderoverview:{page:"Trader",js:["pages"],css:"pages"},research:{page:"Research",js:["pages"],css:"pages"},techtree:{page:"Techtree",js:["pages"],css:"pages"},shipyard:{page:"Shipyard",js:["pages"],css:"pages"},defense:{page:"Defense",js:["pages"],css:"pages"},fleet1:{page:"Fleet1",js:["fleet1"],css:"pages_fleet1"},fleet2:{page:"Fleet2",js:["fleet2"],css:"pages_fleet2"},fleet3:{page:"Fleet3",js:["fleet3"],css:"pages_fleet3"},movement:{page:"Movement",js:["movement"],css:"pages_movement"},galaxy:{page:"Galaxy",js:["jquery","messages","galaxy"],css:"pages_galaxy"},empire:{page:"Empire",js:["jquery","empire"],css:"pages_empire"},alliance:{page:"Alliance",js:["pages"],css:"pages"},messages:{page:"Messages",js:["jquery","messages"],css:"pages_messages"},websim:{page:"Websim",js:["simulators"],css:""},osimulate:{page:"Osimulate",js:["simulators"],css:""}},Extern:{"speedsim.net":2,"osimulate.com":2,"gamestats.org":1,"ogametools.com":1,"oraiders.com":1,"ghiroblu.com":1,"projet-alternative.fr":1,"galaxy.ddns.us":1,"logserver.net":1,"war-riders.de":1,"kb.un1matr1x.de":1,"savekb.de":1,"drago-sim.com":1,"ogniter.org":1,"infuza.com":1,"savecr.com":1},Messages:function(e,a,t,r){"Start"===e?n.a.App.Start(a,t,r):"Update"===e?n.a.App.Update(a,t):"Refresh"===e?n.a.App.Refresh(a,t):"Script"===e&&s.is(a)&&n.a.Manager.loadScripts(a.scripts,r)},Check:function(e){var a,t;return e=c.check(e).toLowerCase(),t=(e.split("//")[1]||"").split("/")[0]||"",e?(a={href:e,host:t},e.match(/https:\/\/.+\.ogame.gameforge.com\/game\/index\.php\?+.*page=*/i)?a.mode=3:s.iterate(n.a.App.Extern,function(e){(t===e||-1<t.indexOf("."+e))&&(a.mode=n.a.App.Extern[e])}),a):null},Start:function(e,a,t){var r;s.is(e)&&e.page&&a&&(n.a.Manager.loadScripts(s.get(n.a.App.Page[e.page],"js")||["pages"],t),2===e.mode?a({Page:s.get(n.a.App.Page[e.page],"page")||"Page",Label:n.a.Label.Data[e.abbrCom],Background:n.a.Background.Data}):3<=e.mode&&e.accountId&&e.keyCom&&e.keyUni&&e.keyPlayer&&n.a.Com.Check(e.abbrCom)&&e.abbrUni&&e.urlUni&&(r=e.keyPlayer,s.is(n.a.App.Player[e.keyUni])||(n.a.App.Player[e.keyUni]={abbrUni:e.abbrUni,urlUni:e.urlUni}),n.a.App.Player[e.keyUni].keyPlayer=r,s.is(n.a.App.Player[r])||(n.a.App.Player[r]={accountId:e.accountId,abbrCom:e.abbrCom,abbrUni:e.abbrUni,keyCom:e.keyCom,keyUni:e.keyUni,urlUni:e.urlUni}),e.reload=e.reload||1!==n.a.App.Player[r].status,n.a.App.Player[r].status=1,n.a.Core.clearTimeout(n.a.App.Player[r].timeout),n.a.App.Player[r].timeout=n.a.Core.setTimeout(function(){n.a.status&&n.a.App.Stop(r)},5e3),n.a.Data.Init(e,function(t){a({Page:s.get(n.a.App.Page[e.page],"page")||"Page",reload:e.reload||t,keyPlayer:r,Option:n.a.Option.Data[r],DataBase:n.a.DataBase.Status(e),Label:n.a.Label.Data[r],Item:n.a.Item.Data[r],App:n.a.App.Data[r],Uni:n.a.Uni.Data[r],Panel:n.a.Panel.Data[r],Box:n.a.Box.Data[r],Token:"galaxy"===e.page?n.a.Token.Data[r]:n.a.Token.Data[r].Info,Units:n.a.Units.Start(r),Fleet:n.a.Fleet.Data[r],Background:n.a.Background.Data})})))},Stop:function(e){},Update:function(e,a){var t=n.a.App.getPlayer(e,"copy");t&&(e.reload||2e3<n.a.Time.timestamp()-(+n.a.App.Player[t].timestampUpdate||0))&&(n.a.App.Player[t].timestampUpdate=n.a.Time.timestamp(),n.a.Uni.Load(e),n.a.Label.Load(e),n.a.DataBase.Init(e),a&&a())},Refresh:function(e,a){var t=n.a.App.getPlayer(e);t&&a&&a({Option:n.a.Option.Data[t],Panel:n.a.Panel.Data[t],Box:n.a.Box.Data[t],Fleet:n.a.Fleet.Data[t],Background:n.a.Background.Data})},Init:function(e,a){var t,r,i;r=n.a.App.getPlayer(e,"copy"),i=n.a.Data.get("App","Data","version"),r&&(t=s.parse(a[n.a.Data.getKey(r,"App","Data")]),n.a.App.Data[r]=t.version===i?t:{version:i},n.a.App.Data[r].storage=n.a.Storage.status)},Load:function(e){var a,t;(a=n.a.App.getPlayer(e,"copy"))&&((t=new XMLHttpRequest).open("POST","https://###########/ago_appdata.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onerror=t.onload=function(){var a,r,i;r=n.a.App.getPlayer(e),a=n.a.App.Data[r],r&&a&&(a.storage=n.a.Storage.status,(i=s.parse(200==+t.status?t.responseText:"")).versionFinal&&(a.versionLoca=i.versionLoca,a.versionLocaMenu=i.versionLocaMenu,a.versionUpdate=1<n.a.Config.beta?"":1===n.a.Config.beta?i.versionPreview:i.versionFinal,n.a.App.Save({player:r})),n.a.Core.Log("Update   - App      : "+a.versionUpdate+"https://##################/ago_appdata.php"+(i.versionFinal?"":" - failed !"),!0))},t.send("domain=antigame.de&loca="+e.abbrCom+"&locamenu="+(n.a.Option.Get(a,"A10")||e.abbrCom)))},Save:function(e){e=n.a.App.getPlayer(e),n.a.Data.isStorage(e,"App","Data")&&s.is(n.a.App.Data[e])&&n.a.Data.setStorage(e,"App","Data",n.a.App.Data[e])},Get:function(e,a,t){var r;return e&&n.a.App.Data[e]&&a&&(r=n.a.App.Data[e][a]),6===t?c.check(r):+r||0},Set:function(e,a,t){e&&n.a.App.Data[e]&&a&&n.a.App.Data[e][a]!==t&&(n.a.App.Data[e][a]=t,n.a.App.Save({player:e}))},getUni:function(e){return n.a.status&&e&&e.keyUni&&n.a.App.Player[e.keyUni]?(e.keyPlayer=n.a.App.Player[e.keyUni].keyPlayer,e.abbrUni=n.a.App.Player[e.keyUni].abbrUni,e.urlUni=n.a.App.Player[e.keyUni].urlUni,e.keyUni):""},getPlayer:function(e,a){return n.a.status&&e&&e.keyPlayer&&n.a.App.Player[e.keyPlayer]&&1===n.a.App.Player[e.keyPlayer].status?(a&&(e.accountId=n.a.App.Player[e.keyPlayer].accountId,e.abbrCom=n.a.App.Player[e.keyPlayer].abbrCom,e.abbrUni=n.a.App.Player[e.keyPlayer].abbrUni,e.keyCom=n.a.App.Player[e.keyPlayer].keyCom,e.keyUni=n.a.App.Player[e.keyPlayer].keyUni,e.urlUni=n.a.App.Player[e.keyPlayer].urlUni),e.keyPlayer):""}},n.a.Background={Data:{},Messages:function(e,a){"Set"===e&&n.a.Background.Set(a)},Set:function(e){s.is(e)&&e.key&&(n.a.Background.Data[e.key]=e.value||"")}},n.a.Data={Status:{},Info:{App:{Data:{storage:1,version:3,tab:2}},Uni:{Data:{storage:1,version:3,tab:2}},Option:{Data:{storage:4,version:12,upgrade:1},Local:{storage:1}},Label:{Loca:{storage:1,version:1,key:0},Api:{storage:1,version:1,key:2}},Units:{Data:{storage:2,version:2}},Fleet:{Data:{storage:2,version:2},Routine:{tab:2},Expo:{tab:2},Last:{tab:3},Cooldown:{tab:2}},Token:{Alliance:{storage:3,version:3,tab:2},Player:{storage:3,version:3,tab:2},Target:{storage:3,version:3,tab:2},Current:{storage:3,version:3,tab:2},Info:{tab:1}},Panel:{Data:{storage:2,version:1},Settings:{tab:2,label:"I10"},Account:{tab:2,label:"I20"},Flights:{tab:2,label:"I40"},Construction:{tab:2,label:"I30"},Alliance:{tab:2,label:"I60"},Player:{tab:2,label:"I70"},Target:{tab:2,label:"I80"},Tools:{tab:2,label:"I90"},Box:{tab:2},Cache:{tab:1}},Box:{Cache:{tab:1}},Construction:{Data:{storage:2,version:1}}},Messages:function(e,a,t){"Backup"===e?n.a.Data.Backup(a,t):"Restore"===e?n.a.Data.Restore(a,t):"Remove"===e?n.a.Data.Remove(a,t):"List"===e&&n.a.Data.List(a)},Init:function(e,a){var t,r;(t=n.a.App.getPlayer(e))&&(!n.a.Data.Status[t]||e.reload&&1===n.a.Data.Status[t])?(n.a.Data.Status[t]=3,r={},s.iterate(n.a.Data.Info,function(a){s.iterate(n.a.Data.Info[a],function(i){var o;1<=n.a.Data.Info[a][i].storage&&(o=2===n.a.Data.Info[a][i].key?e.keyCom:1===n.a.Data.Info[a][i].key?e.keyUni:t,r[n.a.Data.getKey(o,a,i)]=i)})}),n.a.Storage.Get({key:r},function(r){r=s.is(r)?r:{},n.a.App.Init(e,r),n.a.Uni.Init(e,r),n.a.Option.Init(e,r),n.a.Label.Init(e,r),n.a.Units.Init(e,r),n.a.Fleet.Init(e,r),n.a.Token.Init(e,r),n.a.Panel.Init(e,r),n.a.Box.Init(e,r),n.a.Construction.Init(e,r),n.a.Item.Init(e),n.a.Data.Status[t]=1,a&&a(!0)})):a&&a(!1)},Change:function(){n.a.Core.clearTimeout(n.a.Data.changeTimeout),n.a.Data.changeTimeout=n.a.Core.setTimeout(function(){n.a.status&&n.a.Data.Save()},3e3)},Save:function(e,a){function t(e){var t;n.a.Data.isStatus(e)&&(t={keyPlayer:e,save:{}},a&&(t.backup={}),s.iterate(n.a.Data.Info,function(e){n.a[e]&&"function"==typeof n.a[e].Save&&"App"!==e&&n.a[e].Save(t)}),a?n.a.Storage.Set({data:t.save},function(){a(t.backup)}):n.a.Storage.Set({data:t.save}))}n.a.App.getPlayer(e)?t(e.keyPlayer):s.iterate(n.a.Data.Status,t)},Sync:function(e){var a,t,r;a=n.a.App.getPlayer(e),n.a.Data.isStatus(a)&&(r=Boolean(n.a.Option.Get(a,"D60")&&3===n.a.Option.Get(a,"D61")),(t={})[a+"_SYNC_Sync_Data"]=r,n.a.Data.iterate("",function(e,i){2<=n.a.Data.get(e,i,"storage")&&(t[a+"_SYNC_"+e+"_"+i]=r)}),n.a.Storage.Sync({sync:!0,mode:r,key:t}))},Backup:function(e,a){var t,r,i,o;t=n.a.App.getPlayer(e,"copy"),n.a.Data.isStatus(t)&&(r=e.tab,(o=s.create(e)).timestamp=n.a.Time.timestamp(),o.list={},o.data={},o.timestampLocal=n.a.App.Get(t,"timestampSync"),o.data.Sync_Data={com:e.abbrCom,uni:e.abbrUni,player:e.accountId,timestamp:o.timestamp},i=3===r?4e3:2===r?1e4:3e5,n.a.Data.Save(e,function(e){s.iterate(e,function(a){var t;t=s.parse(e[a]),c.check(e[a]).length>i?(o.data[a]={version:0},o.data.Sync_Data[a]=1,o.list[a]=-1):(o.data[a]=t.version?t:{version:1},o.data.Sync_Data[a]=c.hash(JSON.stringify(o.data[a])),o.list[a]=1)}),1===r?a&&a(o):2===r?function(e,a){var t,r;r="com="+e.abbrCom+"&uni="+e.abbrUni+"&user_id="+e.accountId+"&ident="+e.ident+"&type=Sync&action=put&domain=antigame.de&string="+encodeURIComponent(JSON.stringify(e.data))+"&header="+encodeURIComponent(JSON.stringify(e.data.Sync_Data)),(t=new XMLHttpRequest).open("POST","https://antigame.de/antigame/usave/ago_sync.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onerror=t.onload=function(){a&&(e.status=200==+t.status&&7<=+t.responseText?1:-1,e.error=-1===e.status,e.data=null,e.error||n.a.App.Set(e.keyPlayer,"timestampSync",e.timestamp),a(e))},t.send(r)}(o,a):3===r&&function(e,a){var t={};s.iterate(e.data,function(a){t[e.keyPlayer+"_SYNC_"+a]=JSON.stringify(e.data[a])}),n.a.Storage.Set({sync:!0,data:t},function(t){a&&(e.status=t,e.error=-1===t,e.data=null,e.error||n.a.App.Set(e.keyPlayer,"timestampSync",e.timestamp),a(e))})}(o,a)}))},Restore:function(e,a){function t(t,r){var o;o={tab:e.tab,list:{}},s.is(t)&&!t.error?(o.universal=r=1===e.tab&&r,o.timestampLocal=n.a.App.Get(i,"timestampSync"),o.timestamp=+t.timestamp||0,o.com=t.com===e.abbrCom?1:t.com&&!r?-1:0,o.uni=t.uni===e.abbrUni?1:t.uni&&!r?-1:0,o.player=+t.player==+e.accountId?1:t.player&&!r?-1:0,o.status=o.timestamp?o.timestamp===o.timestampLocal?1:o.timestamp>o.timestampLocal?4:3:-1,1===e.tab?(-1===o.com&&(e.type=Math.max(e.type,3)),-1===o.uni&&(e.type=Math.max(e.type,4)),-1===o.player&&(e.type=9)):1===o.com&&1===o.uni&&1===o.player||(e.type=0),2<=e.type?n.a.Data.Save(e,function(r){n.a.Data.iterate("",function(a,i){var s;n.a.Data.get(a,i,"storage")>=e.type&&(s=a+"_"+i,o.list[s]=t[s]?1===t[s]?-1:t[s]===c.hash(r[s])?1:2:0)}),a&&a(o)}):(o.status=-1,a&&a(o))):(o.status=-1,a&&a(o))}function r(t,r){var o,c;c={tab:e.tab,list:{},data:{}},s.is(t)&&!t.error&&s.is(t.Sync_Data)?(o=t.Sync_Data,c.universal=r=1===e.tab&&r,c.timestamp=+o.timestamp||0,c.com=o.com===e.abbrCom?1:o.com&&!r?-1:0,c.uni=o.uni===e.abbrUni?1:o.uni&&!r?-1:0,c.player=+o.player==+e.accountId?1:o.player&&!r?-1:0,1===e.tab?(-1===c.com&&(e.type=Math.max(e.type,3)),-1===c.uni&&(e.type=Math.max(e.type,4)),-1===c.player&&(e.type=9)):1===c.com&&1===c.uni&&1===c.player||(e.type=9),n.a.Data.iterate("",function(a,r){var o;o=a+"_"+r,n.a.Data.get(a,r,"storage")>=e.type&&1<=+s.get(t[o],"version")&&(c.list[o]=1,c.data[i+"_"+o]=JSON.stringify(t[o]))}),Object.keys(c.data).length?n.a.Storage.Set({data:c.data},function(e){1===e&&n.a.App.Set(i,"timestampSync",+c.timestamp||n.a.Time.timestamp()),n.a.Data.Status[i]=0,c.status=e,c.data=null,a&&a(c)}):(c.status=0,c.data=null,a&&a(c))):(c.status=-1,a&&a(c))}var i,o,u;i=n.a.App.getPlayer(e,"copy"),n.a.Data.isStatus(i)&&(1===e.tab?"restore"===e.action?r(s.parse(e.value),e.universal):t(s.parse(e.value).Sync_Data,e.universal):2===e.tab?(u="com="+e.abbrCom+"&uni="+e.abbrUni+"&user_id="+e.accountId+"&ident="+e.ident+"&type=Sync&action="+("restore"===e.action?"get":"header")+"&domain=antigame.de",(o=new XMLHttpRequest).open("POST","https://antigame.de/antigame/usave/ago_sync.php",!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onerror=o.onload=function(){var a;a=200==+o.status&&o.responseText?s.parse(o.responseText):{error:!0},"restore"===e.action?r(a):t(a)},o.send(u)):3===e.tab&&((u={})[i+"_SYNC_Sync_Data"]="Sync_Data",n.a.Data.iterate("",function(e,a){2<=n.a.Data.get(e,a,"storage")&&(u[i+"_SYNC_"+e+"_"+a]=e+"_"+a)}),n.a.Storage.Get({sync:!0,key:u},function(a){var n={};s.iterate(a,function(e){var t=c.check(e).split("_SYNC_")[1];t&&(n[t]=s.parse(a[e]))}),"restore"===e.action?r(n):t(n.Sync_Data)})))},List:function(e){s.is(e)&&n.a.Storage.List(e)},Remove:function(e,a){var t,r,i,s;t=n.a.App.getPlayer(e,"copy"),n.a.Data.isStatus(t)&&(r=e.mode,s=(i=o.check(r,"acc","ago"))||!1,(i||"Account"===r)&&(s=!0,n.a.Data.removeStorageGroup(e,"App"),n.a.Data.removeStorageGroup(e,"Label"),n.a.Data.removeStorageGroup(e,"Units"),n.a.Data.removeStorageGroup(e,"Fleet"),n.a.Data.removeStorageGroup(e,"Messages")),(i||"Token"===r)&&(s=!0,n.a.Data.removeStorageGroup(e,"Token")),(i||"Panel"===r)&&(s=!0,n.a.Data.removeStorageGroup(e,"Panel"),n.a.Data.removeStorageGroup(e,"Construction")),(i||"Option"===r)&&(s=!0,n.a.Data.removeStorageGroup(e,"Option")),(i||"DataBase"===r)&&n.a.DataBase.Remove(e),"acc"===r&&n.a.Storage.RemoveFilter({filter:t}),"ago"===r&&n.a.Storage.RemoveFilter({filter:""}),s&&(n.a.Data.Status[t]=0)),a&&a(s)},removeStorageGroup:function(e,a){s.is(e)&&n.a.Data.Info[a]&&n.a.Data.iterate(a,function(t,r){var i;1<=t.storage&&(i=2===t.key?e.keyCom:1===t.key?e.keyUni:e.keyPlayer,n.a.Storage.Remove({key:n.a.Data.getKey(i,a,r)}))})},setStorage:function(e,a,t,r){e&&(r=s.is(r)?JSON.stringify(r):r||"",n.a.Storage.Set({key:n.a.Data.getKey(e,a,t),data:r}))},iterate:function(e,a){var t;if(n.a.Data.Info[e])for(t in n.a.Data.Info[e])n.a.Data.Info[e].hasOwnProperty(t)&&a(n.a.Data.Info[e][t],t);else if(!e)for(e in n.a.Data.Info)if(n.a.Data.Info.hasOwnProperty(e))for(t in n.a.Data.Info[e])n.a.Data.Info[e].hasOwnProperty(t)&&a(e,t)},getKey:function(e,a,t){return n.a.Data.Info[a]&&n.a.Data.Info[a][t]?e+"_"+a+"_"+t:""},get:function(e,a,t,r){return n.a.Data.Info[e]&&n.a.Data.Info[e][a]?6===r?c.check(n.a.Data.Info[e][a][t]||""):+n.a.Data.Info[e][a][t]||0:6===r?"":0},getTab:function(e,a){return e&&e.tab&&n.a.Data.Info[a]&&n.a.Data.Info[a][e.tab]&&n.a.Data.Info[a][e.tab].tab?e.tab:""},set:function(e,a,t,r){n.a.Data.Info[e]&&n.a.Data.Info[e][a]&&(n.a.Data.Info[e][a][t]=+r||0)},isStorage:function(e,a,t){return e&&n.a.Data.Status[e]&&a&&n.a.Data.Info[a]&&n.a.Data.Info[a][t]?n.a.Data.Info[a][t].storage:0},isBackup:function(e,a,t,r){return Boolean(e&&n.a.Data.Status[e]&&a&&n.a.Data.Info[a]&&n.a.Data.Info[a][t]&&n.a.Data.Info[a][t].storage>=r)},isStatus:function(e){return e&&1===n.a.Data.Status[e]}},n.a.Com={Data:{AE:{infuzaServer:"ae.ogame.org",websim:"en",osimulate:"ae",dragosim:"english",warriders:"",infuza:"fr",ogniter:"en",trashsim:"en"},AR:{infuzaServer:"ogame.com.ar",websim:"sp",osimulate:"ar",dragosim:"spanish",warriders:"",infuza:"es",ogniter:"ar",trashsim:"es"},BA:{infuzaServer:"ba.ogame.org",websim:"ba",osimulate:"hr",dragosim:"bosnian",warriders:"",infuza:"en",ogniter:"yu",trashsim:"hr"},BR:{infuzaServer:"ogame.com.br",websim:"pt",osimulate:"br",dragosim:"brazilian",warriders:"",infuza:"pt",ogniter:"br",trashsim:"pt-BR"},CZ:{infuzaServer:"ogame.cz",websim:"cz",osimulate:"cz",dragosim:"czech",warriders:"",infuza:"cs",ogniter:"cz",trashsim:"cs"},DE:{infuzaServer:"ogame.de",websim:"de",osimulate:"de",dragosim:"german",warriders:"de",infuza:"de",ogniter:"de",trashsim:"de"},DK:{infuzaServer:"ogame.dk",websim:"dk",osimulate:"dk",dragosim:"danish",warriders:"",infuza:"da",ogniter:"dk",trashsim:"da"},EN:{infuzaServer:"ogame.org",websim:"en",osimulate:"en",dragosim:"english",warriders:"org",infuza:"en",ogniter:"en",trashsim:"en"},ES:{infuzaServer:"ogame.com.es",websim:"sp",osimulate:"es",dragosim:"spanish",warriders:"es",infuza:"es",ogniter:"es",trashsim:"es"},FI:{infuzaServer:"fi.ogame.org",websim:"fi",osimulate:"fi",dragosim:"english",warriders:"",infuza:"en",ogniter:"fi",trashsim:"sv"},FR:{infuzaServer:"ogame.fr",websim:"fr",osimulate:"fr",dragosim:"french",warriders:"fr",infuza:"fr",ogniter:"fr",trashsim:"fr"},GR:{infuzaServer:"ogame.gr",websim:"gr",osimulate:"gr",dragosim:"greek",warriders:"",infuza:"en",ogniter:"gr",trashsim:"el"},HR:{infuzaServer:"ogame.com.hr",websim:"ba",osimulate:"hr",dragosim:"english",warriders:"",infuza:"en",ogniter:"hr",trashsim:"hr"},HU:{infuzaServer:"ogame.hu",websim:"hu",osimulate:"hu",dragosim:"hungarian",warriders:"",infuza:"hu",ogniter:"hu",trashsim:"hu"},IT:{infuzaServer:"ogame.it",websim:"it",osimulate:"it",dragosim:"italian",warriders:"",infuza:"it",ogniter:"it",trashsim:"it"},JP:{infuzaServer:"ogame.jp",websim:"ja",osimulate:"jp",dragosim:"english",warriders:"",infuza:"en",ogniter:"jp",trashsim:"en"},MX:{infuzaServer:"mx.ogame.org",websim:"sp",osimulate:"mx",dragosim:"spanish",warriders:"",infuza:"es",ogniter:"mx",trashsim:"es"},NL:{infuzaServer:"ogame.nl",websim:"nl",osimulate:"nl",dragosim:"dutch",warriders:"",infuza:"nl",ogniter:"nl",trashsim:"nl"},NO:{infuzaServer:"ogame.no",websim:"no",osimulate:"no",dragosim:"english",warriders:"",infuza:"en",ogniter:"no",trashsim:"en"},PL:{infuzaServer:"ogame.pl",websim:"pl",osimulate:"pl",dragosim:"polish",warriders:"pl",infuza:"pl",ogniter:"pl",trashsim:"pl"},PT:{infuzaServer:"ogame.com.pt",websim:"pt",osimulate:"pt",dragosim:"portuguese",warriders:"",infuza:"pt",ogniter:"pt",trashsim:"pt"},RO:{infuzaServer:"ogame.ro",websim:"ro",osimulate:"ro",dragosim:"romanian",warriders:"",infuza:"ro",ogniter:"ro",trashsim:"ro"},RU:{infuzaServer:"ogame.ru",websim:"ru",osimulate:"ru",dragosim:"russian",warriders:"",infuza:"ru",ogniter:"ru",trashsim:"ru"},SE:{infuzaServer:"ogame.se",websim:"sv",osimulate:"se",dragosim:"swedish",warriders:"",infuza:"sv",ogniter:"se",trashsim:"sv"},SI:{infuzaServer:"ogame.si",websim:"si",osimulate:"si",dragosim:"english",warriders:"",infuza:"en",ogniter:"si",trashsim:"en"},SK:{infuzaServer:"ogame.sk",websim:"sk",osimulate:"sk",dragosim:"slovak",warriders:"",infuza:"en",ogniter:"sk",trashsim:"en"},TR:{infuzaServer:"tr.ogame.org",websim:"tr",osimulate:"tr",dragosim:"turkish",warriders:"",infuza:"en",ogniter:"tr",trashsim:"tr"},TW:{infuzaServer:"ogame.tw",websim:"tw",osimulate:"tw",dragosim:"taiwanese",warriders:"",infuza:"en",ogniter:"tw",trashsim:"zh"},US:{infuzaServer:"ogame.us",websim:"en",osimulate:"us",dragosim:"english",warriders:"us",infuza:"en",ogniter:"us",trashsim:"en"},ORIGIN:{infuzaServer:"pioneers.ogame.org",websim:"en",osimulate:"en",dragosim:"english",warriders:"",infuza:"en",ogniter:"en",trashsim:"en"}},Get:function(e,a){return e&&n.a.Com.Data[e]&&n.a.Com.Data[e][a]||""},Check:function(e){return e&&e in n.a.Com.Data}},n.a.Uni={Data:{},Info:{status:2,speed:1,speedFleet:1,galaxies:50,systems:499,positions:17,rapidFire:1,acs:1,defToTF:0,debrisFactor:.3,debrisFactorDef:.3,repairFactor:.7,newbieProtectionLimit:0,newbieProtectionHigh:0,topScore:0,donutGalaxy:0,donutSystem:0,probeCargo:0,globalDeuteriumSaveFactor:1,cargoHyperspaceTechMultiplier:2,name:""},Init:function(e,a){var t,r,i;i=n.a.Data.get("Uni","Data","version"),(r=n.a.App.getPlayer(e))&&(n.a.Uni.Data[r]=s.create(n.a.Uni.Info),n.a.Uni.Data[r].version=i,(t=s.parse(a[n.a.Data.getKey(r,"Uni","Data")])).version===i&&s.copy(t,n.a.Uni.Data[r]))},Save:function(e){e=n.a.App.getPlayer(e),n.a.Data.isStatus(e)&&s.is(n.a.Uni.Data[e])&&n.a.Data.setStorage(e,"Uni","Data",n.a.Uni.Data[e])},Load:function(e){var a;n.a.App.getPlayer(e,"copy")&&((a=new XMLHttpRequest).open("GET",e.urlUni+"/api/serverData.xml?nocache="+n.a.Time.timestamp(),!0),a.overrideMimeType("text/html"),a.setRequestHeader("Cache-Control","no-cache"),a.setRequestHeader("Pragma","no-cache"),a.onerror=a.onload=function(){var t,r,i;r=n.a.App.getPlayer(e),t=n.a.Uni.Data[r],r&&t&&(200==+a.status&&a.responseText&&s.iterate(n.a.Uni.Info,function(e){var r;2===(r=a.responseText.split("<"+e+">")).length&&(i=1,r=((r=(r[1]||"").split("<")[0])||"").trim(),t[e]="number"==typeof n.a.Uni.Info[e]?+r||0:r)}),1===i&&(t.status=1,n.a.Uni.Save(e)),n.a.Core.Log("Update   - Uni      : "+e.urlUni+"/api/serverData.xml"+(i=1,""),!0))},a.send(null))},Get:function(e,a,t){var r;return e&&n.a.Uni.Data[e]&&a&&(r=n.a.Uni.Data[e][a]),6===t?c.check(r):+r||0}},n.a.Time={timestamp:function(){return Math.floor(Date.now()/1e3)},timestampMinute:function(){return Math.floor((Date.now()-1381e9)/6e4)},timestampMinuteConvert:function(e){return 1e3<e?60*(+e||0)+1381e6:0}};var o={check:function(e){for(var a=1;a<arguments.length;a++)if(e===arguments[a])return!0;return!1}},s={is:function(e){return e&&"object"===i(e)},get:function(e,a){return e&&"object"===i(e)&&a in e?e[a]:""},iterate:function(e,a){if(e&&"object"===i(e))for(var t in e)e.hasOwnProperty(t)&&a(t)},iterateArray:function(e,a){Array.isArray(e)&&e.forEach(a)},create:function(e){var a={};if(e&&"object"===i(e))for(var t in e)"object"!==i(e[t])&&"function"!=typeof e[t]&&(a[t]=e[t]);return a},createKey:function(e,a){var t={};return e&&(t[e]=a),t},createFilter:function(e,a){var t={};if(e&&"object"===i(e))for(var n in e)e.hasOwnProperty(n)&&"object"!==i(e[n])&&(!a||n in a)&&(t[n]=e[n]);return t},copy:function(e,a){if(e&&"object"===i(e)&&a&&"object"===i(a))for(var t in e)"object"!==i(e[t])&&(a[t]=e[t])},parse:function(e){if(e&&"object"===i(e))return e;try{return JSON.parse(e||"{}")}catch(e){return{}}},parseCopy:function(e,a){var t;if(e&&a){try{t=e&&"object"===i(e)?e:JSON.parse(e||"{}")}catch(e){t=null}if(t)for(var n in t)"object"!==i(t[n])&&(a[n]=t[n])}},split:function(e){var a={};e=c.check(e).split(";");for(var t=0;t<e.length;t++){var n=(e[t]||"").split("=");n[0]&&(a[n[0]]=n[1]||"")}return a}},c={is:function(e){return Boolean(e&&"string"==typeof e)},check:function(e){return"string"==typeof e?e:"number"==typeof e&&e?e+"":""},trim:function(e){return"string"==typeof e?e.trim():"number"==typeof e&&e?e+"":""},trimZero:function(e,a){return(e="0000"+e).substr(-a)},getAttribute:function(e,a){return"string"==typeof e?((e.split(" "+a+'="')[1]||"").split('"')[0]||"").trim():""},addUrlPara:function(e,a){return a=encodeURI(c.check(a).trim()),e&&a?"&"+e+"="+a:""},hash:function(e){var a=0;if("string"==typeof e&&0<e.length)for(var t=0;t<e.length;t++)a=(a<<5)-a+e.charCodeAt(t),a&=a;return a}},u={minMax:function(e,a,t){return Math.max(Math.min(+e||0,t),a)},isMinMax:function(e,a,t){return+e>=a&&+e<=t},parseInt:function(e){function a(a){return e.apply(this,arguments)}return a.toString=function(){return e.toString()},a}(function(e){return"string"==typeof e?parseInt(e,10):"number"==typeof e?Math.floor(e):0}),parseIntFormat:function(e){return"string"==typeof e?+e.replace(/[^\d\-]/g,"")||0:"number"==typeof e?Math.floor(e):0},parseIntAbs:function(e){return"string"==typeof e?+e.replace(/[^\d]/g,"")||0:"number"==typeof e?Math.floor(Math.abs(e)):0}};n.a.Option={Data:{},Limit:{U11:[0,7],U62:[0,100],U65:[0,20],U66:[0,100],U67:[0,100],B21:[0,3],B35:[0,2],CM3:[0,100],I05:[1,100],CT2:[0,100],D04:[1,3],D61:[1,3],D71:[0,2],D81:[0,2],O03:[0,4],I02:[0,9],I85:[0,500],F02:[0,3],F70:[0,3],F80:[0,3],F90:[0,3],FA0:[0,3],FA1:[0,3],FH0:[0,3],FL0:[0,3],FL2:[0,6],E23:[1,2],E41:[0,8],E42:[0,8],E43:[0,8],E44:[0,8],E45:[0,8],E46:[0,8],E47:[0,8],E48:[0,8],E49:[0,8],G42:[0,3],G45:[0,3],M12:[0,4],M28:[1,9],M30:[0,5]},Messages:function(e,a,t){"Set"===e?n.a.Option.Set(a,t):"Menu"===e?n.a.Option.Menu(a,t):"Save"===e&&n.a.Option.MenuSave(a,t)},Init:function(e,a){var t,r,i,o,l,p;if(i=n.a.App.getPlayer(e)){if(n.a.Option.Data[i]={status:2},t=s.parse(s.get(a,n.a.Data.getKey(i,"Option","Data"))),r=s.parse(s.get(a,n.a.Data.getKey(i,"Option","Local"))),t.version){for(n.a.Option.Data[i].version=t.version,n.a.Option.Data[i].status=u.minMax(t.status,1,2),l=c.check(t.empty).split(","),p=0;p<l.length;p++)t[l[p]]="";for(l=c.check(t.one).split(","),p=0;p<l.length;p++)t[l[p]]=1;t.version===r.version&&s.parseCopy(r,t)}o=n.a.Option.get(t,"D04"),o=u.isMinMax(o,1,3)?o:u.minMax(n.a.Option.getDefault("D04",0),1,3),s.iterate(n.a.Para,function(e){n.a.Para[e][0]&&(n.a.Option.set(n.a.Option.Data[i],e,n.a.Option.getDefault(e,o)),e in t&&n.a.Option.set(n.a.Option.Data[i],e,t[e]))}),n.a.Option.Upgrade(n.a.Option.Data[i])}},Upgrade:function(e){var a;a=n.a.Data.get("Option","Data","version"),e.version&&12>e.version&&(n.a.Core.Log("Option - Upgrade version 12 ",!0),e.F01=0,e.F13=e.FH0=1,e.F70=2,e.FA0=3,e.F80=e.F90=e.FL0=4,e.F63=""),e.version!==a&&(e.version=a,e.changed=!0,n.a.Data.Change())},Save:function(e){var a,t,r,i,o,c;t=n.a.App.getPlayer(e),a=n.a.Option.Data[t],n.a.Data.isStatus(t)&&a&&(e.backup||a.changed)&&(delete a.changed,o=[],c=[],r={version:n.a.Data.get("Option","Data","version")},i={version:n.a.Data.get("Option","Data","version")},s.iterate(n.a.Para,function(e){n.a.Para[e][1]&&(a[e]?1===a[e]?c.push(e):r[e]=a[e]:o.push(e),3===n.a.Para[e][1]&&(i[e]=a[e]))}),r.empty=o.join(","),r.one=c.join(","),e.save&&(e.save[t+"_Option_Data"]=JSON.stringify(r),e.save[t+"_Option_Local"]=JSON.stringify(i)),e.backup&&n.a.Data.isBackup(t,"Option","Data",2)&&(e.backup.Option_Data=JSON.stringify(r)))},Menu:function(e,a){var t;t=n.a.App.getPlayer(e),n.a.Data.isStatus(t)&&a&&a({Limit:n.a.Option.Limit,Para:n.a.Para,Data:n.a.Option.Data[t]})},MenuSave:function(e,a){var t,r;r=n.a.App.getPlayer(e),t=n.a.Option.Data[r],n.a.Data.isStatus(r)&&t&&(s.is(e.data)&&(s.iterate(n.a.Para,function(a){n.a.Para[a][0]&&a in e.data&&n.a.Option.set(t,a,e.data[a])}),t.status=1),e.data=null,t.changed=!0,n.a.Data.Change(r),n.a.Token.InitInfo(e),n.a.Data.Sync(e),a&&a(t))},Set:function(e,a){var t,r,i;r=n.a.App.getPlayer(e),t=n.a.Option.Data[r],r&&t&&((i=n.a.Option.valid(e.id))&&n.a.Para[i]&&n.a.Para[i][0]?((r=n.a.Option.get(t,i))!==(i={id:i,value:n.a.Option.set(t,i,e.value)}).value&&(t.changed=!0,n.a.Data.Change()),a&&a(i)):i&&(t[i]=e.value))},Get:function(e,a){return(a=n.a.Option.valid(a))&&e&&s.is(n.a.Option.Data[e])?n.a.Option.get(n.a.Option.Data[e],a):""},set:function(e,a,t){var r;if(r=s.get(n.a.Para[a],0),e&&a&&r){if(1===r)e[a]=t&&"0"!==t?1:0;else if(2===r)t=u.parseIntFormat(t),a in n.a.Option.Limit&&(t=Math.max(Math.min(t,n.a.Option.Limit[a][1]),n.a.Option.Limit[a][0])),e[a]=t;else if(6===r)e[a]=n.a.Option.valid(t);else if(o.check(r,20,21,22,23)){for((t=c.check(t).split("|"))[0]=n.a.Option.valid(t[0]),t[1]=21<=r&&u.minMax(+t[1],0,100)||"",t[2]=22<=r&&u.minMax(+t[2],0,19)||"",t[3]=t[2]&&+t[3]||"",t[4]=23<=r?n.a.Option.valid(t[4]):"",t=t[0]?t.join("|"):"";t.length&&"|"===t[t.length-1];)t=t.substring(0,t.length-1);e[a]=n.a.Option.valid(t)}else 25===r?("|"!==(t=(c.check(t)+"|").split("|",2).join("|").trim())&&"0|"!==t&&"0"!==t||(t=""),e[a]=n.a.Option.valid(t)):-1===r&&(e[a]=n.a.Option.validTask(t));return e[a]}},get:function(e,a){var t;return t=s.get(n.a.Para[a],0),e&&a?1===t?e[a]?1:0:2===t?+e[a]||0:t?"string"==typeof e[a]?e[a]:"number"==typeof e[a]?(e[a]||"")+"":"":e[a]:""},getDefault:function(e,a){var t;return t=s.get(n.a.Para[e],0),e&&t?(a=u.minMax(n.a.Para[e].length-3,0,+a||0),n.a.Para[e][2+a]||""):""},valid:function(e){return c.check(e).replace(/[\"\;]/g,"").trim()},validTask:function(e){return c.check(e).replace(/\"/g,"").replace(/^\;*/g,"").replace(/\;*$/g,"").trim()}},n.a.Label={Data:{},Messages:function(e,a){"Update"===e&&n.a.Label.Update(a)},Init:function(e,a){var t,r;r=n.a.App.getPlayer(e,"copy"),t=n.a.Label.Data,r&&(t[r]={status:2},s.parseCopy(n.a.Core.resourceFile("loca/EN.json"),t[r]),s.parseCopy(n.a.Core.resourceFile("loca/"+e.abbrCom+".json"),t[r]),t[e.abbrCom]=s.create(t[r]),s.parseCopy(s.get(a,n.a.Data.getKey(r,"Label","Loca")),t[r]),s.parseCopy(s.get(a,n.a.Data.getKey(e.keyCom,"Label","Api")),t[r]))},Load:function(e){var a;n.a.App.getPlayer(e,"copy")&&((a=new XMLHttpRequest).open("GET",e.urlUni+"/api/localization.xml?nocache="+n.a.Time.timestamp(),!0),a.overrideMimeType("text/html"),a.setRequestHeader("Cache-Control","no-cache"),a.setRequestHeader("Pragma","no-cache"),a.onerror=a.onload=function(){var t,r,i,o,u,l,p,m;if(t={},(r=n.a.App.getPlayer(e))&&n.a.Label.Data[r]){if(200==+a.status&&a.responseText)for(i=c.check(a.responseText).split("<name"),m=0;m<i.length;m++)(o=c.check(i[m]))&&(t.status=1,p=c.getAttribute(o,"id"),l=c.check((o.split(">")[1]||"").split("<")[0]).trim(),+p&&l&&("techs"===u&&(t["L"+c.trimZero(p,Math.max(3,p.toString().length))]=l),"missions"===u&&(t["LM"+c.trimZero(p,2)]=l)),-1<o.indexOf("<techs>")&&(u="techs"),-1<o.indexOf("<missions>")&&(u="missions"));1===t.status&&(s.copy(t,n.a.Label.Data[r]),n.a.Item.Init(e),n.a.Data.setStorage(e.keyCom,"Label","Api",t)),n.a.Core.Log("Update   - Label    : "+e.urlUni+"/api/localization.xml"+(t.status=1,""),!0)}},a.send(null))},Update:function(e){var a,t,r,i,o;(t=n.a.App.getPlayer(e))&&s.is(e.data)&&(a={},r=s.is(e.data.localization)?e.data.localization:{},i=s.is(r.timeunits)&&r.timeunits.short?r.timeunits.short:{},a.KU0S=r.thousandSeperator||".",a.KU0C="."===r.thousandSeperator?",":".",a.KU0K=r.unitKilo||"k",a.KU0M=r.unitMega||"m",a.KU0B=r.unitMilliard||"b",a.KD0Y=i.year||"y",a.KD0W=i.week||"w",a.KD0D=i.day||"d",a.KD0H=i.hour||"h",a.KD0M=i.minute||"m",a.KD0S=i.second||"s",r=s.is(e.data.production)?e.data.production:{},o={metal:"091",crystal:"092",deuterium:"093",energy:"094"},s.iterate(o,function(e){s.is(r[e])&&(a["L"+o[e]]=(c.check(r[e].tooltip).split("|")[0]||"").trim()||e)}),n.a.Core.Log("Update   - Label    : "+a.KU0B+":"+a.KU0M+":"+a.KU0K+" - "+a.KD0Y+":"+a.KD0W+":"+a.KD0D+" - "+a.KD0H+":"+a.KD0M+":"+a.KD0S,!0),n.a.Data.setStorage(t,"Label","Loca",a),s.copy(a,n.a.Label.Data[t]),n.a.Item.Init(e))},Get:function(e,a,t){return(e=n.a.App.getPlayer(e))&&n.a.Label.Data[e]&&a?(t&&(a=1===a.length?"L00"+a:2===a.length?"L0"+a:"L"+a),a in n.a.Label.Data[e]?n.a.Label.Data[e][a]||"":a):""}},n.a.Styles={Data:{},opacity:33,colorType:["","#99CC00","#FFFFFF","#FD8A1C"],classType:["","ago_color_planet","ago_color_debris","ago_color_moon"],colorStatusUnits:"#6A0A0A #640 #640 #640 #004A00 #170 #0D0".split(" "),Messages:function(e,a,t){"Init"===e&&n.a.Styles.Init(a,t)},Init:function(e,a){var t;(t=n.a.App.getPlayer(e))&&a&&1===n.a.Data.Status[t]&&(function(e,a){function t(e,t,i,o,c){c||t&&!n.a.Option.Get(r,t)?(t="",i=0):(t=s.get(n.a.App.Page[e],"css")||"",i=+n.a.Option.Get(r,i)||0),t!==a.Page.file&&(a[e]||(a[e]={}),a[e].file=t),i!==a.Page.improve&&(a[e]||(a[e]={}),a[e].improve=i),a.Events&&o&&(o=+n.a.Option.Get(r,o)||0)!==a.Page.events&&(a[e]||(a[e]={}),a[e].events=o)}var r,i,o,c;r=e.keyPlayer,a.Main="main",n.a.Option.Get(r,"O50")&&(a.Planets=n.a.Option.Get(r,"O51")?"main_planets_improve":"main_planets"),n.a.Option.Get(r,"E30")&&(a.Events=n.a.Option.Get(r,"E31")?"main_events_improve":"main_events"),e.mobile&&(a.Mobile="ogame_mobile"),(i=n.a.Option.Get(r,"U11"))&&(c="  middle dark    color".split(" ")[i],o=n.a.Option.Get(r,"U19"),a.Skin='@import url("'+n.a.Config.pathSkin+'cache/cache.css");'+(c?'@import url("'+n.a.Config.pathSkin+"cache/"+c+'.css");':"")+(7===i&&o?"body { background: "+o+" !important; }":"")),a.Page={file:"pages",improve:0,events:+n.a.Option.Get(r,"E49")||0},t("overview","B01","B01","E41"),t("resources","B00","B00","E47"),t("resourcesettings","","B00","E47"),t("station","B00","B00","E47"),t("research","B00","B00",""),t("shipyard","B00","B00","E48"),t("defense","B00","B00","E48"),t("fleet1","F00","","E42"),t("fleet2","F00","","E43"),t("fleet3","F00","","E44"),t("movement","E10","E11","E45",e.mobile),t("galaxy","G40","G41","E46",e.mobile),t("empire","G20","G21",""),t("messages","","M12","")}(e,t={}),function(e,a){var t,r,i,o,c,l;if(t=e.keyPlayer,r=[],i=[],s.copy(n.a.Styles.colorType,i),n.a.Option.Get(t,"CM0")&&(s.iterate(n.a.Item.Mission,function(e){r.push(".ago_color_"+e+"{color:"+n.a.Option.Get(t,e.replace(/M/,"C"))+"!important;}")}),o=n.a.Option.Get(t,"CM3"),u.isMinMax(o,1,99)&&r.push("#eventContent .ago_events_reverse, #eventContent .ago_events_reverse + .ago_eventlist, #inhalt div.fleetDetails[ago_events_reverse] > span{opacity:"+n.a.Styles.getOpacity(o)+"!important;}")),n.a.Option.Get(t,"CT0"))for(o=21;80>o;o++)(c=n.a.Token.getColor(t,o))&&"INHERIT"!==c&&r.push("."+n.a.Token.getClass(t,o)+"{color:"+c+"!important;}");if(n.a.Option.Get(t,"CE0"))for(o=91;100>o;o++)(c=n.a.Token.getColor(t,o))&&"INHERIT"!==c&&r.push("."+n.a.Token.getClass(t,o)+"{color:"+c+"!important;}");if(n.a.Option.Get(t,"CS0")){for((c=n.a.Token.getColor(t,"S5"))&&r.push(".ago_selected_S5{box-shadow: 0 0 3px 2px "+c+", 0 0 1px 1px "+c+" inset;}"),l=1;3>=l;l++)o="S"+l,(c=n.a.Token.getColor(t,o))&&(i[l]=c,r.push(".ago_selection_"+o+"{color:"+c+"!important;}"),r.push(".ago_selected_"+o+"{box-shadow: 0 0 0 1px "+c+" inset;}"),r.push(".ago_selected_"+o+"_own{box-shadow: 0 0 0 1px "+c+" inset;color:"+c+"!important;}"),r.push(".ago_hover_"+o+":hover, .ago_hovered_"+o+"{box-shadow: 0 0 1px 0 "+c+" inset;}"),r.push(".ago_hover_"+o+"_own:hover{color:"+c+"!important;box-shadow: 0 0 1px 0 "+c+" inset;}"),n.a.Token.getCondition(t,o)&&(r.push(".ago_highlight_"+o+"{background-color:"+n.a.Token.getColorOpacity(t,o)+";}"),r.push(".ago_highlight_"+o+"_active{background-color:"+n.a.Token.getColorOpacity(t,o,"active")+";}")));n.a.Option.Get(t,"O55")&&((c=n.a.Token.getColor(t,"S1"))&&(r.push("#rechts .ago_highlight .planet-name, #rechts .ago_highlight .planet-koords{color:"+c+"!important;}"),r.push("#rechts .smallplanet:hover .planet-name, #rechts .smallplanet:hover .planet-koords{color:"+c+"!important;}")),(c=n.a.Token.getColor(t,"S3"))&&(r.push("#rechts .ago_highlight_S3 .planet-name, #rechts .ago_highlight_S3 .planet-koords{color:"+c+"!important;}"),r.push("#rechts .ago_highlight_S3_active .planet-name, #rechts .ago_highlight_S3_active .planet-koords{color:"+c+"!important;}"),r.push("#rechts .ago_hover_S3:hover .planet-name, #rechts .ago_hover_S3:hover .planet-koords, #rechts .ago_hovered_S3 .planet-name, #rechts .ago_hovered_S3 .planet-koords{color:"+c+"!important;}"))),(c=n.a.Token.getColor(t,"SA"))&&r.push(".ago_selected_SA{outline:"+c+" thin solid;}")}for(l=1;3>=l;l++)r.push("."+n.a.Styles.classType[l]+"{color:"+i[l]+"!important;}");a.colorType=i,a.Color=r.join("")}(e,t),a(t))},getOpacity:function(e){return"0."+(10>e?"0"+e:e)},getImport:function(e){return e?'@import url("'+n.a.Config.pathSkin+"ago/"+e+'.css");':""},getColor:function(e,a){return!e||4!==e.length&&7!==e.length?"":0<a&&100>a?"rgba("+(e=7===e.length?parseInt(e.substring(1,3),16)+","+parseInt(e.substring(3,5),16)+","+parseInt(e.substring(5,7),16):parseInt(e.substring(1,2),16)+","+parseInt(e.substring(2,3),16)+","+parseInt(e.substring(3,4),16))+(10>a?",0.0":",0.")+a+")":e}},n.a.Item={Data:{},Info:{timeResource:{index:0},metal:{index:1},crystal:{index:2},deuterium:{index:3},energy:{index:4},timeMining:{index:31},timeStation:{index:32},1:{index:33,metal:60,crystal:15,deuterium:0,factor:1.5},2:{index:34,metal:48,crystal:24,deuterium:0,factor:1.6},3:{index:35,metal:225,crystal:75,deuterium:0,factor:1.5},4:{index:36,metal:75,crystal:30,deuterium:0,factor:1.5},12:{index:37,metal:900,crystal:360,deuterium:180,factor:1.8},14:{index:38,metal:400,crystal:120,deuterium:200,factor:2},15:{index:39,metal:1e6,crystal:5e5,deuterium:1e5,factor:2},21:{index:41,metal:400,crystal:200,deuterium:100,factor:2},22:{index:42,metal:1e3,crystal:0,deuterium:0,factor:2},23:{index:43,metal:1e3,crystal:500,deuterium:0,factor:2},24:{index:44,metal:1e3,crystal:1e3,deuterium:0,factor:2},25:{index:45,metal:2645,crystal:0,deuterium:0,factor:2.3},26:{index:46,metal:2645,crystal:1322,deuterium:0,factor:2.3},27:{index:47,metal:2645,crystal:2645,deuterium:0,factor:2.3},31:{index:48,metal:200,crystal:400,deuterium:200,factor:2},33:{index:49,metal:0,crystal:5e4,deuterium:1e5,factor:2},34:{index:50,metal:2e4,crystal:4e4,deuterium:0,factor:2},41:{index:51,metal:2e4,crystal:4e4,deuterium:2e4,factor:2},42:{index:52,metal:2e4,crystal:4e4,deuterium:2e4,factor:2},43:{index:53,metal:2e6,crystal:4e6,deuterium:2e6,factor:2},44:{index:54,metal:2e4,crystal:2e4,deuterium:1e3,factor:2},timeResearch:{index:31},106:{index:32,metal:200,crystal:1e3,deuterium:200,factor:2},108:{index:33,metal:0,crystal:400,deuterium:600,factor:2},109:{index:34,metal:800,crystal:200,deuterium:0,factor:2},110:{index:35,metal:200,crystal:600,deuterium:0,factor:2},111:{index:36,metal:1e3,crystal:0,deuterium:0,factor:2},113:{index:37,metal:0,crystal:800,deuterium:400,factor:2},114:{index:38,metal:0,crystal:4e3,deuterium:2e3,factor:2},115:{index:39,metal:400,crystal:0,deuterium:600,factor:2},117:{index:40,metal:2e3,crystal:4e3,deuterium:600,factor:2},118:{index:41,metal:1e4,crystal:2e4,deuterium:6e3,factor:2},120:{index:42,metal:200,crystal:100,deuterium:0,factor:2},121:{index:43,metal:1e3,crystal:300,deuterium:100,factor:2},122:{index:44,metal:2e3,crystal:4e3,deuterium:1e3,factor:2},123:{index:45,metal:24e4,crystal:4e5,deuterium:16e4,factor:2},124:{index:46,metal:4e3,crystal:8e3,deuterium:4e3,factor:1.75},199:{index:47,metal:0,crystal:0,deuterium:0,factor:3},timeShip:{index:5},202:{index:6,metal:2e3,crystal:2e3,deuterium:0,retreat:1e3,drive:"115",speed:5e3,capacity:5e3,consumption:20},203:{index:7,metal:6e3,crystal:6e3,deuterium:0,retreat:3e3,drive:"115",speed:7500,capacity:25e3,consumption:50},204:{index:8,metal:3e3,crystal:1e3,deuterium:0,retreat:4e3,drive:"115",speed:12500,capacity:50,consumption:20},205:{index:9,metal:6e3,crystal:4e3,deuterium:0,retreat:1e4,drive:"117",speed:1e4,capacity:100,consumption:75},206:{index:10,metal:2e4,crystal:7e3,deuterium:2e3,retreat:29e3,drive:"117",speed:15e3,capacity:800,consumption:300},207:{index:11,metal:45e3,crystal:15e3,deuterium:0,retreat:6e4,drive:"118",speed:1e4,capacity:1500,consumption:500},208:{index:12,metal:1e4,crystal:2e4,deuterium:1e4,retreat:1e4,drive:"117",speed:2500,capacity:7500,consumption:1e3},209:{index:13,metal:1e4,crystal:6e3,deuterium:2e3,retreat:4500,drive:"115",speed:2e3,capacity:2e4,consumption:300},210:{index:14,metal:0,crystal:1e3,deuterium:0,retreat:0,drive:"115",speed:1e8,capacity:0,consumption:1},211:{index:15,metal:5e4,crystal:25e3,deuterium:15e3,retreat:9e4,drive:"117",speed:4e3,capacity:500,consumption:1e3},212:{index:16,metal:0,crystal:2e3,deuterium:500,retreat:0,drive:0,speed:0,capacity:0,consumption:0},213:{index:17,metal:6e4,crystal:5e4,deuterium:15e3,retreat:125e3,drive:"118",speed:5e3,capacity:2e3,consumption:1e3},214:{index:18,metal:5e6,crystal:4e6,deuterium:1e6,retreat:1e7,drive:"118",speed:100,capacity:1e6,consumption:1},215:{index:19,metal:3e4,crystal:4e4,deuterium:15e3,retreat:85e3,drive:"118",speed:1e4,capacity:750,consumption:250},timeDefense:{index:20},401:{index:21,metal:2e3,crystal:0,deuterium:0,retreat:2e3},402:{index:22,metal:1500,crystal:500,deuterium:0,retreat:2e3},403:{index:23,metal:6e3,crystal:2e3,deuterium:0,retreat:8e3},404:{index:24,metal:2e4,crystal:15e3,deuterium:2e3,retreat:37e3},405:{index:25,metal:2e3,crystal:6e3,deuterium:0,retreat:8e3},406:{index:26,metal:5e4,crystal:5e4,deuterium:3e4,retreat:13e4},407:{index:27,metal:1e4,crystal:1e4,deuterium:0,retreat:2e4},408:{index:28,metal:5e4,crystal:5e4,deuterium:0,retreat:1e5},502:{index:29,metal:8e3,crystal:0,deuterium:2e3,retreat:0},503:{index:30,metal:12500,crystal:2500,deuterium:1e4,retreat:0}},Mining:{1:1,2:1,3:1,4:1,12:1,22:1,23:1,24:1,25:1,26:1,27:1,212:1},Station:{14:1,15:1,21:1,31:1,33:1,34:1,41:1,42:1,43:1,44:1},Ship:{202:1,203:1,204:2,205:2,206:2,207:2,208:1,209:1,210:1,211:2,212:3,213:2,214:2,215:2},ShipCivil:{202:1,203:1,208:1,209:1,210:1},ShipCombat:{204:2,205:2,206:2,207:2,215:2,211:2,213:2,214:2},ShipTransport:{203:1,202:1,209:1,214:1},Defense:{401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,502:2,503:2},Resource:{metal:"091",crystal:"092",deuterium:"093"},ResourceEnergy:{metal:"091",crystal:"092",deuterium:"093",energy:"094"},Coordinates:{galaxy:1,system:1,position:1},Research:{106:8,108:10,109:3,110:6,111:2,113:12,114:-8,115:6,117:6,118:8,120:-12,121:5,122:7,123:0,124:8,199:-1},ByName:{},Mission:{M15:0,M07:0,M08:0,M03:0,M04:0,M06:0,M05:0,M01:0,M02:0,M09:0},Init:function(e){var a,t;(t=n.a.App.getPlayer(e))&&1==+s.get(n.a.Label.Data[t],"status")&&(n.a.Item.Data[t]={},a=n.a.Item.Data[t],s.iterate(n.a.Item.Ship,function(t){a[n.a.Label.Get(e,t,1)||t]=t}),s.iterate(n.a.Item.Defense,function(t){a[n.a.Label.Get(e,t,1)||t]=t}),s.iterate(n.a.Item.Research,function(t){a[n.a.Label.Get(e,t,1)||t]=t}),s.iterate(n.a.Item.ResourceEnergy,function(t){a[n.a.Label.Get(e,n.a.Item.ResourceEnergy[t],1)||t]=t}))},valid:function(e){return e in n.a.Item.Info?e:""}},n.a.Units={Data:{},Messages:function(e,a,t){"Action"===e?n.a.Units.Action(a,t):"Update"===e?n.a.Units.Update(a,t):"List"===e&&n.a.Units.List(a,t)},Start:function(e){var a,t;return t={},(a=n.a.Units.Data[e])&&a.account&&(t.status=a.status,t.timeResearch=n.a.Time.timestampMinuteConvert(a.account.timeResearch),s.iterate(n.a.Item.Research,function(e){t[e]=+a.account[e]||0}),t.Moons={},s.is(a)&&s.iterate(a,function(e){!isNaN(e)&&s.is(a[e])&&a[e][43]&&(t.Moons[e]={43:a[e][43]})})),t},Init:function(e,a){var t,r,i,o,u;o=n.a.Data.get("Units","Data","version"),(i=n.a.App.getPlayer(e))&&(n.a.Units.Data[i]={status:2,version:o},(t=n.a.Units.Data[i]).account={},(r=s.parse(a[n.a.Data.getKey(i,"Units","Data")])).version===o&&(t.status=r.status||2,r.account&&(u=c.check(r.account).split(","),n.a.Item.Info.timeResearch&&(t.account.timeResearch=+u[n.a.Item.Info.timeResearch.index]||0),s.iterate(n.a.Item.Research,function(e){n.a.Item.Info[e]&&(t.account[e]=+u[n.a.Item.Info[e].index]||0)})),s.iterate(r,function(e){var a;0<+e&&(t[e]={},a=c.check(r[e]).split(","),s.iterate(n.a.Item.Info,function(r){100<+r&&200>+r||"timeResearch"===r||(t[e][r]=+a[n.a.Item.Info[r].index]||0)}))})),n.a.Units.SummarizePlanets(e))},Save:function(e){var a,t,r,i;r=n.a.App.getPlayer(e),a=n.a.Units.Data[r],n.a.Data.isStatus(r)&&a&&(e.backup||a.changed)&&(i={version:a.version,status:a.status},delete a.changed,a.account&&(t=[],n.a.Item.Info.timeResearch&&(t[n.a.Item.Info.timeResearch.index]=+a.account.timeResearch||""),s.iterate(n.a.Item.Research,function(e){n.a.Item.Info[e]&&(t[n.a.Item.Info[e].index]=+a.account[e]||"")}),i.account=t.join(",")),n.a.Units.iterate(r,function(e,a){var t,r;for(t=[],s.iterate(n.a.Item.Info,function(a){100<+a&&200>+a||"timeResearch"===a||(t[n.a.Item.Info[a].index]=+e[a]||"")}),r=t.length;0<r&&!t[r-1];)r--;t.length=r,i[a]=t.join(",")}),e.save&&(e.save[r+"_Units_Data"]=JSON.stringify(i)),e.backup&&n.a.Data.isBackup(r,"Units","Data",2)&&(e.backup.Units_Data=JSON.stringify(i)))},Update:function(e,a){var t,r,i;r=n.a.App.getPlayer(e),t=n.a.Units.Data[r],r&&t&&s.is(e.data)&&(i=[{planet:e.planet,tabs:["Resource"],data:e.data}],(t={research:"Research",resources:"Mining",station:"Station",shipyard:"Ship",defense:"Defense",fleet1:"Ship"}[e.data.page])&&i.push({planet:"Research"===t?"account":e.planet,tabs:[t],data:e.data}),n.a.Units.Action({keyPlayer:r,list:i},a))},Action:function(e,a){var t,r;r=n.a.App.getPlayer(e),t=n.a.Units.Data[r],r&&t&&Array.isArray(e.list)&&(s.iterateArray(e.list,function(e){e&&function(e,a,r,i){var o,c;if(("account"===e||0<+e)&&Array.isArray(a)&&s.is(i))for(s.is(t[e])||(t[e]={}),o=t[e],c=0;c<a.length;c++)"Resource"===(e=a[c])?(s.iterate(n.a.Item.ResourceEnergy,function(e){o[e]=+i[e]||0}),o.resources=o.metal+o.crystal+o.deuterium,o.timeResource=n.a.Time.timestampMinute()):"Ship"===e?(o.shipsCivil=0,o.shipsCombat=0,s.iterate(n.a.Item.Ship,function(e){var a=+i[e]||0;o[e]="add"===r?(+o[e]||0)+a:"remove"===r?Math.max((+o[e]||0)-a,0):a,e in n.a.Item.ShipCivil&&(o.shipsCivil+=o[e]),e in n.a.Item.ShipCombat&&(o.shipsCombat+=o[e])}),o.ships=o.shipsCivil+o.shipsCombat,o.timeShip=n.a.Time.timestampMinute()):"Research"===e?(s.iterate(n.a.Item.Research,function(e){o[e]=+i[e]||0}),o.timeResearch=n.a.Time.timestampMinute(),t.status=1):n.a.Item[e]&&(s.iterate(n.a.Item[e],function(e){o[e]=+i[e]||0}),o["time"+e]=1)}(e.planet,e.tabs,e.action,e.data)}),e.planets&&(function(e){var a,n;n=0,a={account:1,status:1,version:1,changed:1},s.iterate(e,function(r){var i;n++,i=e[r],a[i]=r,s.is(t[i])||(t[i]={})}),n&&s.iterate(t,function(e){e in a||(t[e]="")})}(e.planets),n.a.Units.SummarizePlanets(e)),t.changed=!0,n.a.Data.Change()),a&&a()},List:function(e,a){var t,r,i;r=n.a.App.getPlayer(e),t=n.a.Units.Data[r],r&&t&&(i={},"summarized"===e.action&&s.iterate(t,function(e){var a;0<+e&&(a=t[e],i[e]={ships:a.ships,shipsCivil:a.shipsCivil,shipsCombat:a.shipsCombat,timeShip:a.timeShip})})),a&&a(i)},Get:function(e,a,t,r){var i;return e&&n.a.Units.Data[e]&&a&&n.a.Units.Data[e][a]&&t&&(i=n.a.Units.Data[e][a][t]),6===r?c.check(i):+i||0},XXsummarizeAccount:function(e){var a,t;e=n.a.App.getPlayer(e),a=n.a.Units.Data[e],e&&a&&(a.account||(a.account={}),(t=a.account).resources=0,s.iterate(n.a.Item.Resource,function(e){t[e]=0}),t.ships=0,t.shipsCivil=0,t.shipsCombat=0,s.iterate(n.a.Item.Ship,function(e){t[e]=0}),s.iterate(a,function(e){var r;0<+e&&(r=a[e],s.iterate(n.a.Item.Resource,function(e){t[e]+=+r[e]||0}),t.resources+=+t.resources||0,s.iterate(n.a.Item.Ship,function(e){t[e]+=+r[e]||0}),t.ships+=+r.ships||0,t.shipsCivil+=+r.shipsCivil||0,t.shipsCombat+=+r.shipsCombat||0)}))},SummarizePlanets:function(e){var a;a=n.a.App.getPlayer(e),e=n.a.Units.Data[a],a&&e&&n.a.Units.iterate(a,function(e){e.resources=0,s.iterate(n.a.Item.Resource,function(a){e.resources+=+e[a]||0}),e.shipsCivil=0,e.shipsCombat=0,s.iterate(n.a.Item.ShipCivil,function(a){e.shipsCivil+=+e[a]||0}),s.iterate(n.a.Item.ShipCombat,function(a){e.shipsCombat+=+e[a]||0}),e.ships=e.shipsCivil+e.shipsCombat})},SummarizePosition:function(e){function a(e){u[e]=o?(+i[e]||0)+(+o[e]||0):+i[e]||0}function t(a){var t,n;t=+s.get(i,a)||0,n=+s.get(o,a)||0,u[a]=e.moon?t&&n?t:t||n?-1:0:t}var r,i,o,c,u;return c=n.a.App.getPlayer(e),r=n.a.Units.Data[c],u={},c&&r&&(i=r[e.planet]||{},o=r[e.moon],s.iterate(n.a.Item.Resource,a),s.iterate(n.a.Item.Ship,a),s.iterate({resources:0,ships:0,shipsCivil:0,shipsCombat:0},a),t("timeResource"),t("timeShip")),u},SummarizeAccount:function(e){var a,t;return a=n.a.App.getPlayer(e),e=n.a.Units.Data[a],a&&e&&(t={resources:0,ships:0,shipsCivil:0,shipsCombat:0,timeResource:0,timeShip:0},s.iterate(n.a.Item.Resource,function(e){t[e]=0}),s.iterate(n.a.Item.Ship,function(e){t[e]=0}),n.a.Units.iterate(a,function(e){e.timeResource&&(t.timeResource=1),e.timeShip&&(t.timeShip=1),s.iterate(n.a.Item.Resource,function(a){t[a]+=+e[a]||0}),t.resources+=+e.resources||0,s.iterate(n.a.Item.Ship,function(a){t[a]+=+e[a]||0}),t.ships+=+e.ships||0,t.shipsCivil+=+e.shipsCivil||0,t.shipsCombat+=+e.shipsCombat||0})),t},create:function(e,a,t){var r;return r=n.a.Units.Data[e],e&&r&&a?s.createFilter(n.a.Units.Data[e][a],t):{}},iterate:function(e,a){var t,r;if(t=n.a.Units.Data[e],e&&t)for(r in t)t.hasOwnProperty(r)&&0<+r&&a(t[r],r)}},n.a.Task={splitActive:function(e,a,t){var r,i;if((e=s.split(e)).standard&&e[t]){for(i in r=AGO.Task.split(e.standard,a,-1),a=AGO.Task.split(e[t],a,-1))a[i]&&(r[i]="string"==typeof a[i]?a[i]:Math.max(a[i],0));return r.ships=0,s.iterate(n.a.Item.Ship,function(e){r.ships+=+r[e]||0}),r}return n.a.Task.split(e[t]||e.standard,a)},split:function(e,a){var t,n,r,i;if((t={galaxy:+(n=c.check(e).split(":"))[0]||0,system:+n[1]||0,position:+n[2]||0,type:+n[3]||0,mission:+n[4]||0,speed:+n[5]||0,holdingtime:+n[6]||0}).expeditiontime=+n[7]||0,t.union=+n[8]||0,t.routine=+n[9]||0,t.name=n[10]||"",t.detail=n[11]||"",t.detail2=+n[12]||0,t.preferCargo=n[13]||"",t.preferShip=n[14]||"",t.arrival=+n[15]||0,1<=a&&(t.metal=+n[16]||0,t.crystal=+n[17]||0,t.deuterium=+n[18]||0,t.preferResource=+n[19]||0,t.timeResource=+n[20]||0,t.resources=t.metal+t.crystal+t.deuterium),2<=a)for(t.timeShip=+n[21]||0,t.ships=0,i=22;35>=i;i++)r=+n[i]||0,(t[String(i+180)]=r)&&(t.ships+=r);return t},join:function(e,a){var t,n;if(s.is(e)){if((t=[e.galaxy||"",e.system||"",e.position||"",e.type||"",e.mission||"",e.speed||"",e.holdingtime||""])[7]=e.expeditiontime||"",t[8]=e.union||"",t[9]=e.routine||"",t[10]=e.name||"",t[11]=e.detail||"",t[12]=e.detail2||"",t[13]=e.preferCargo||"",t[14]=e.preferShip||"",t[15]=e.arrival||"",1<=a&&(t[16]=e.metal||"",t[17]=e.crystal||"",t[18]=e.deuterium||"",t[19]=e.preferResource||"",t[20]=e.timeResource||""),2<=a)for(t[21]=e.timeShip||"",n=22;35>=n;n++)e[String(n+180)]&&(t[n]=e[String(n+180)]||"");for(n=t.length;0<n&&!t[n-1];)n--;return t.length=n,t.join(":")}return""},getCoordsType:function(e){return s.is(e)&&e.galaxy&&e.system&&e.position&&e.type?e.galaxy+":"+e.system+":"+e.position+":"+e.type:""},updateCoordsType:function(e,a){var t;a=c.check(a),s.is(e)&&a&&(t=a.split(":"),u.isMinMax(+t[3],1,3)&&(e.type=+t[3]||0),e.galaxy=+t[0]||0,e.system=+t[1]||0,e.position=+t[2]||0,e.coords=e.galaxy+":"+e.system+":"+e.position,e.coordstype=e.type?e.coords+":"+e.type:"")},cut:function(e,a){return"string"==typeof e?e.split(":",a).join(":"):""},cutSystem:function(e){return"string"==typeof e?e.split(":",2).join(":"):""},cutCoords:function(e){return"string"==typeof e?e.split(":",3).join(":"):""},cutCoordsType:function(e){return"string"==typeof e?e.split(":",4).join(":"):""}},n.a.Construction={Data:{},Messages:function(e,a,t){"List"===e?n.a.Construction.List(a,t):"Action"===e&&n.a.Construction.Action(a,t)},Init:function(e,a){var t,r;(t=n.a.App.getPlayer(e))&&(r=s.parse(a[n.a.Data.getKey(t,"Construction","Data")]),n.a.Construction.Data[t]={version:r.version},s.iterate(r,function(e){Array.isArray(r[e])&&(n.a.Construction.Data[t][e]=[],r[e].forEach(function(a){n.a.Construction.Data[t][e].push(n.a.Construction.split(a))}))}),n.a.Construction.Upgrade(n.a.Construction.Data[t]))},Upgrade:function(e){var a;a=n.a.Data.get("Construction","Data","version"),e.version!==a&&(e.changed=!0,e.version=a,n.a.Data.Change())},Save:function(e){var a,t,r;r=n.a.App.getPlayer(e),a=n.a.Construction.Data[r],n.a.Data.isStatus(r)&&a&&(e.backup||a.changed)&&(delete a.changed,t={version:n.a.Data.get("Construction","Data","version")},s.iterate(a,function(e){Array.isArray(a[e])&&a[e].length&&(t[e]=[],a[e].forEach(function(a){t[e].push(n.a.Construction.join(a))}))}),e.save&&(e.save[r+"_Construction_Data"]=JSON.stringify(t)),e.backup&&n.a.Data.isBackup(r,"Construction","Data",2)&&(e.backup.Construction_Data=JSON.stringify(t)))},Action:function(e,a){var t,r,i,c,u,l,p;r=n.a.App.getPlayer(e),t=n.a.Construction.Data[r],r&&t&&e.value&&("set"===(i=e.action)?s.get(e.value,"id")&&((c=s.create(e.value)).time=0,u=n.a.Task.getCoordsType(c))&&(n.a.Construction.update(r,c),s.is(t[u])?t[u].unshift(c):t[u]=[c],t.changed=!0,n.a.Data.Change(),a({tab:"Construction",data:u+":0"})):"remove"===i?(u=n.a.Construction.getKey(e.value),l=n.a.Construction.getIndex(e.value),s.is(t[u])&&t[u][l]&&(t[u].splice(l,1),t.changed=!0,n.a.Data.Change(),a({tab:"Construction",data:u+":"+l}))):"reserve"===i?(u=n.a.Construction.getKey(e.value),l=n.a.Construction.getIndex(e.value),s.is(t[u])&&t[u][l]&&(c=s.create(t[u][l]),s.get(c,"id")&&u!==e.coords&&c.reserved&&(n.a.Task.updateCoordsType(c,e.coords),c.coordstype===e.coords&&(t[u].splice(l,1),u=c.coordstype,s.is(t[u])?t[u].push(c):t[u]=[c],l=t[u].length-1,t.changed=!0,n.a.Data.Change(),a({tab:"Construction",data:u+":"+l}))))):o.check(i,"increase","decrease","increaseRange","decreaseRange")&&(u=n.a.Construction.getKey(e.value),l=n.a.Construction.getIndex(e.value),s.is(t[u])&&t[u][l]&&(c=s.create(t[u][l]),s.get(c,"id")))&&(200>+c.id?((p={increase:1,decrease:-1}[i]||0)&&(c.increase+=p),(p={increaseRange:1,decreaseRange:-1}[i]||0)&&c.increase&&(c.range+=p)):(p={increase:1,decrease:-1,increaseRange:10,decreaseRange:-10}[i]||0)&&(c.level+=p),n.a.Construction.update(r,c),t[u][l]=c,t.changed=!0,n.a.Data.Change(),a({tab:"Construction",data:u+":"+l})))},update:function(e,a){var t,r,i,o,c,u,l;s.is(a)&&n.a.Item.valid(a.id)&&(t=a.id,s.copy({metal:0,crystal:0,deuterium:0,resources:0,duration:0},a),t in n.a.Item.Ship||t in n.a.Item.Defense?(a.level=Math.max(a.level,1),a.duration=a.time*a.level,a.range=0,a.increase=0,s.iterate(n.a.Item.Resource,function(e){var r;r=s.get(n.a.Item.Info[t],e),a[e]=r?r*a.level:0}),a.resources=a.metal+a.crystal+a.deuterium):(t in n.a.Item.Mining||t in n.a.Item.Station||t in n.a.Item.Research)&&(r=s.get(n.a.Item.Info[t],"factor"),a.increase=t in n.a.Item.Research?Math.max(a.increase||0,0):Math.max(a.increase||0,-1*a.level),a.range=a.reserved?0:0>a.increase?Math.max(Math.min(a.level+a.increase,a.range||0),0):Math.max(a.range||0,0),0>a.increase?(o=Math.max(a.level+a.increase,0),i=Math.max(o-a.range,0),c=4*n.a.Units.Get(e,"account","121")):(0<a.increase?(i=a.level+a.increase,o=i+a.range):i=o=a.level,c=0),a.start=i,a.stop=o,u={metal:0,crystal:0},s.iterate(n.a.Item.Resource,function(e){var p;if(p=s.get(n.a.Item.Info[t],e)){for(l=i;l<=o;l++)a[e]+=Math.floor(p*Math.pow(r,l-1));u[e]=a[e],c&&(a[e]=Math.floor(a[e]-a[e]/100*c))}}),a.duration=Math.floor((u.metal+u.crystal)*a.time),a.resources=a.metal+a.crystal+a.deuterium))},List:function(e,a){var t,r,i;r=n.a.App.getPlayer(e),t=n.a.Construction.Data[r],r&&t&&((i={tab:"Construction",list:t}).Active=n.a.Units.SummarizePosition({keyPlayer:r,planet:e.active}),i.Units=e.planet&&"account"!==e.planet?n.a.Units.SummarizePosition(e):n.a.Units.SummarizeAccount(e)),n.a.Panel.Cache(e,i),a&&a(i)},split:function(e){return(e={galaxy:+(e=c.check(e).split(":"))[0]||0,system:+e[1]||0,position:+e[2]||0,type:+e[3]||0,mission:+e[4]||0,speed:+e[5]||0,holdingtime:+e[6]||0,disabled:+e[7]||0,time:+e[8]||0,id:e[10]||"",level:+e[11]||0,increase:+e[12]||0,range:+e[13]||0,reserved:+e[14]||0,arrival:+e[15]||0,metal:+e[16]||0,crystal:+e[17]||0,deuterium:+e[18]||0,preferResource:+e[19]||0,timeResource:+e[20]||0}).resources=e.metal+e.crystal+e.deuterium,e},join:function(e){var a;if(s.is(e)){for(a=(e=[e.galaxy||"",e.system||"",e.position||"",e.type||"",e.mission||"",e.speed||"",e.holdingtime||"",e.disabled||"",e.time||"","",e.id||"",e.level||"",e.increase||"",e.range||"",e.reserved||"",e.arrival||"",e.metal||"",e.crystal||"",e.deuterium||"",e.preferResource||"",e.timeResource||""]).length;0<a&&!e[a-1];)a--;return e.length=a,e.join(":")}return""},getKey:function(e){return c.check(e).split(":",4).join(":")},getIndex:function(e){return+c.check(e).split(":")[4]||0}},n.a.Token={Data:{},Sort:{},Info:{21:{cls:"active"},22:{cls:"inactive"},23:{cls:"longinactive"},24:{cls:"noob"},25:{cls:"strong"},26:{cls:"honorableTarget"},27:{cls:"outlaw"},28:{cls:"banned"},29:{cls:"vacation"},30:{cls:"admin"},41:{cls:"ally_own"},42:{},43:{},44:{},45:{},46:{},47:{},48:{},49:{},51:{cls:"buddy"},52:{},53:{},54:{},55:{},56:{},57:{},58:{},59:{},61:{},62:{},63:{},64:{},65:{},66:{},67:{},68:{},69:{},71:{},72:{},73:{},74:{},75:{},76:{},77:{},78:{},79:{},81:{},91:{},92:{},94:{},95:{},96:{},97:{},98:{},99:{},S1:{},S2:{},S3:{},S4:{},S5:{},S6:{},S7:{},S8:{},S9:{},SA:{},SB:{},SC:{}},Messages:function(e,a,t){"Get"===e?n.a.Token.Get(a,t):"Action"===e?n.a.Token.Action(a,t):"List"===e&&n.a.Token.List(a,t)},Init:function(e,a){var t;(t=n.a.App.getPlayer(e))&&(n.a.Token.Data[t]={},n.a.Token.Sort[t]={},n.a.Data.iterate("Token",function(e,r){2<=e.tab?(n.a.Token.Data[t][r]=s.parse(a[n.a.Data.getKey(t,"Token",r)]),n.a.Token.Upgrade(t,r)):e.tab&&(n.a.Token.Data[t][r]={})}),n.a.Token.InitInfo(e))},InitInfo:function(e){var a,t;(t=n.a.App.getPlayer(e))&&n.a.Token.Data[t]&&(n.a.Token.Data[t].Info={},a=n.a.Token.Data[t].Info,s.iterate(n.a.Token.Info,function(e){var r;a[e]={},n.a.Token.Info[e].cls&&(a[e].cls=n.a.Token.Info[e].cls),(r=n.a.Option.Get(t,"C"+e))&&"string"==typeof r&&((r=r.split("|"))[0]&&(a[e].color=r[0],r[1]&&(a[e].opacity=+r[1]),r[2]&&(a[e].condition=+r[2]),r[3]&&(a[e].limit=+r[3]),r[4]&&(a[e].name=r[4])))}))},Upgrade:function(e,a){var t,r;r=n.a.Data.get("Token",a,"version"),t=n.a.Token.Data[e],s.is(t[a])||(t[a]={}),t[a].version!==r&&(t[a].changed=!0,t[a].version=r,n.a.Data.Change())},Save:function(e){var a,t;t=n.a.App.getPlayer(e),a=n.a.Token.Data[t],s.iterate(a,function(r){n.a.Data.isStorage(t,"Token",r)&&(e.backup||a[r].changed)&&(delete a[r].changed,e.save&&(e.save[n.a.Data.getKey(t,"Token",r)]=JSON.stringify(a[r])),e.backup&&n.a.Data.isBackup(t,"Token",r,2)&&(e.backup["Token_"+r]=JSON.stringify(a[r])))})},Action:function(e,a){var t,r,i,o,l,p,m,g;r=n.a.App.getPlayer(e),i=n.a.Token.getTab(e),t=n.a.Token.Data[r],o=-1===(o=+e.token||0)?o:"Alliance"!==i||!u.isMinMax(o,41,49)&&81!==o?"Player"===i&&u.isMinMax(o,51,89)?o:"Target"===i&&u.isMinMax(o,61,89)?o:0:o,r&&i&&t&&o&&(l=c.check(e.id),"Target"===i&&(1e8<e.time?l=n.a.Task.cutCoordsType(e.coords)||e.time:(e.time=0,l=l||n.a.Task.cutCoords(e.coords))),g={tab:i,action:e.action,id:l,token:o},"set"===e.action&&(p=o+"|"+c.check(e.name),"Alliance"===i&&e.tag&&(p+="|"+e.tag),"Target"===i&&(p+="|"+c.check(e.coords),e.time&&(p+="|"+e.time))),80>o?"set"===e.action?(g.changed=!0,t[i].changed=!0,t[i][l]=p):"remove"===e.action&&l in t[i]&&(g.changed=!0,t[i].changed=!0,delete t[i][l]):81===o&&s.is(t.Current)&&(l=i[0]+l,"set"===e.action?(g.changed=!0,t.Current.changed=!0,t.Current[l]=p,m=0,s.iterate(t.Current,function(e){e[0]===i[0]&&m++}),m=Math.max(0,m-n.a.Option.Get(r,"I05")),s.iterate(t.Current,function(e){0<m&&e[0]===i[0]&&(m--,delete t.Current[e])})):"remove"===e.action&&l in t.Current&&(g.changed=!0,t.Current.changed=!0,delete t.Current[l])),g.changed&&(s.is(n.a.Token.Sort[r])&&(n.a.Token.Sort[r][i]=null),e.refresh&&(g.Data=t),n.a.Data.Change())),a&&a(g)},List:function(e,a){var t,r,i,o,u;i=n.a.App.getPlayer(e),o=n.a.Token.getTab(e),t=n.a.Token.Data[i],o&&s.is(t)&&(n.a.Token.Sort[i]||(n.a.Token.Sort[i]={}),(r=n.a.Token.Sort[i])[o]||(r[o]={},s.iterate(t[o],function(e){var a;"version"!==e&&"changed"!==e&&(41<=(a=c.check(t[o][e]).split("|")[0])&&79>=a&&(r[o][a]?r[o][a].push(e):r[o][a]=[e]))}),s.iterate(t.Current,function(e){var a;"version"!==e&&"changed"!==e&&(a=c.check(t.Current[e]).split("|")[0],e[0]===o[0]&&81<=a&&89>=a&&(e=e.slice(1),r[o][a]?r[o][a].push(e):r[o][a]=[e]))})),u={tab:o,token:e.token,listTab:{},listToken:[]},s.iterate(r[o],function(e){u.listTab[e]=r[o][e].length}),e.token&&(s.iterateArray(r[o][e.token],function(a){(a=n.a.Token.get(t,o,e.token,a))&&u.listToken.push(a)}),"Target"===o&&e.sort?u.listToken.sort(function(e,a){var t=(s.get(e,"coords")||"").split(":"),n=(s.get(a,"coords")||"").split(":");return+t[0]<+n[0]?-1:+t[0]>+n[0]?1:+t[1]<+n[1]?-1:+t[1]>+n[1]?1:+t[2]<+n[2]?-1:+t[2]>+n[2]?1:0}):u.listToken.sort(function(e,a){var t=(s.get(e,"name")||"").toLowerCase(),n=(s.get(a,"name")||"").toLowerCase();return t<n?-1:t===n?0:1}))),n.a.Panel.Cache(e,u),a&&a(u)},Get:function(e,a){var t,r,i;if(t=n.a.App.getPlayer(e),(r=n.a.Token.getTab(e))&&(i=n.a.Token.get(n.a.Token.Data[t],r,e.token,e.id)),!a)return i||"";a(i)},get:function(e,a,t,r){var i;return s.is(e)&&a&&r&&(80>t?s.is(e[a])&&e[a][r]&&(i={id:r,name:n.a.Token.getName(e[a],r)},"Alliance"===a&&(i.tag=n.a.Token.getTag(e[a],r)),"Target"===a&&(i.coords=n.a.Token.getCoords(e[a],r),i.time=n.a.Token.getTime(e[a],r))):81===t&&s.is(e.Current)&&e.Current[a[0]+r]&&(i={id:r,name:n.a.Token.getName(e.Current,a[0]+r)},"Alliance"===a&&(i.tag=n.a.Token.getTag(e.Current,a[0]+r)),"Target"===a&&(i.coords=n.a.Token.getCoords(e.Current,a[0]+r),i.time=n.a.Token.getTime(e.Current,a[0]+r)))),i||""},getName:function(e,a){return s.is(e)&&a&&c.check(e[a]).split("|")[1]||""},getCoords:function(e,a){return s.is(e)&&a&&c.check(e[a]).split("|")[2]||""},getTag:function(e,a){return s.is(e)&&a&&c.check(e[a]).split("|")[2]||""},getTime:function(e,a){var t;return s.is(e)&&a?1e8<(t=+c.check(e[a]).split("|")[3]||0)?t:0:0},getColor:function(e,a){return n.a.Token.is(e,"Info")&&n.a.Token.Data[e].Info[a]&&n.a.Token.Data[e].Info[a].color||""},getClass:function(e,a){return n.a.Token.is(e,"Info")&&n.a.Token.Data[e].Info[a]?"status_abbr_"+(n.a.Token.Data[e].Info[a].cls||a):""},getCondition:function(e,a){return n.a.Token.is(e,"Info")&&n.a.Token.Data[e].Info[a]&&+n.a.Token.Data[e].Info[a].condition||0},getOpacity:function(e,a){return n.a.Token.is(e,"Info")&&n.a.Token.Data[e].Info[a]&&+n.a.Token.Data[e].Info[a].opacity||0},getColorOpacity:function(e,a,t){var r,i;return r=n.a.Token.getColor(e,a),i=n.a.Token.getOpacity(e,a),r?(i=i||(80>a?n.a.Option.Get(e,"CT2"):n.a.Styles.opacity)||100,"INHERIT"===r?i/100:n.a.Styles.getColor(r,t?2*i:i)):""},getTab:function(e){return s.is(e)&&e.keyPlayer&&n.a.Token.Data[e.keyPlayer]&&e.tab&&s.is(n.a.Token.Data[e.keyPlayer][e.tab])?e.tab:""},is:function(e,a){return e&&a&&n.a.Token.Data[e]&&s.is(n.a.Token.Data[e][a])?a:""}},n.a.Fleet={Data:{},Messages:function(e,a){"Set"===e?n.a.Fleet.Set(a):"Action"===e&&n.a.Fleet.Action(a)},Init:function(e,a){var t,r,i,o;(i=n.a.App.getPlayer(e))&&(t=n.a.Fleet.Data[i]={version:n.a.Data.get("Fleet","Data","version")},r=s.parse(a[n.a.Data.getKey(i,"Fleet","Data")]),o=t.version!==r.version,n.a.Data.iterate("Fleet",function(e,a){2<=e.tab?t[a]=s.is(r[a])&&!o?r[a]:3===e.tab?[]:{}:e.tab&&(t[a]={})}),o&&(t.changed=!0,n.a.Data.Change())),t=r=i=o=null},Save:function(e){var a,t;t=n.a.App.getPlayer(e),a=n.a.Fleet.Data[t],n.a.Data.isStatus(t)&&a&&(e.backup||a.changed)&&(delete a.changed,e.save&&(e.save[t+"_Fleet_Data"]=JSON.stringify(a)),e.backup&&n.a.Data.isBackup(t,"Fleet","Data",2)&&(e.backup.Fleet_Data=JSON.stringify(a)))},Set:function(e){var a,t,r,i;t=n.a.App.getPlayer(e),r=n.a.Data.getTab(e,"Fleet"),a=n.a.Fleet.Data[t],t&&r&&a&&(s.is(a[r])||(a[r]={}),s.iterate(e.data,function(t){a[r][t]!==e.data[t]&&(a[r][t]=e.data[t],i=!0)}),i&&(a.changed=!0,n.a.Data.Change())),a=t=r=i=null},Action:function(e){var a,t,r,i,c;if(t=n.a.App.getPlayer(e),r=n.a.Data.getTab(e,"Fleet"),a=n.a.Fleet.Data[t],t&&r&&a&&"Last"===r&&s.get(e.data,"coords"))if(Array.isArray(a.Last)||(a.Last=[]),i=+(r=e.data).routine||0,c=r.mission,r.routine=0,!i||o.check(i,1,2,3,4)){for(1!==c&&delete r.retreatAfterDefenderRetreat,5!==c&&delete r.holdingtime,15!==c&&delete r.expeditiontime,2!==c&&delete r.union,3===i?(1===c&&(r.routine=3),r.metal=r.crystal=r.deuterium=0):4===i?(8===c&&(r.routine=4),r.metal=r.crystal=r.deuterium=0):(2===i||r.resources)&&(!r.resources||3!==c&&4!==c?r.metal=r.crystal=r.deuterium=0:r.routine=2),i=[n.a.Task.join(r,2)],t=0;t<a.Last.length;t++)(e=n.a.Task.split(a.Last[t],2)).mission&&(r.coordstype===n.a.Task.cutCoordsType(a.Last[t])&&c===e.mission&&r.routine===e.routine||i.push(a.Last[t]));for(a.Last=[],t=0;t<i.length&&(i[t]&&a.Last.push(i[t]),!(8<a.Last.length));t++);a.changed=!0,n.a.Data.Change()}else 5===i?(e=n.a.Task.split(s.get(a.Routine,"Collect"))).routine&&(r.routine=e.routine,i=n.a.Task.cut(n.a.Task.join(r),10),n.a.Fleet.Set({keyPlayer:t,tab:"Routine",data:{Collect:i}})):6===i?(e=n.a.Task.split(s.get(a.Routine,"Save"))).routine&&(r.routine=e.routine,i=n.a.Task.cut(n.a.Task.join(r),10),n.a.Fleet.Set({keyPlayer:t,tab:"Routine",data:{Save:i}})):7===i&&(i=n.a.Task.cutSystem(e.coords),15===c&&i&&n.a.Fleet.Set({keyPlayer:t,tab:"Expo",data:s.createKey(i,(+s.get(a.Expo,i)||0)+1)}))}},n.a.DataBase={status:0,readLimit:2e3,Info:{Player:{keyPath:"I",hour:24,url:"/api/players.xml",split:"<player "},Universe:{keyPath:"pI",hour:168,url:"/api/universe.xml",split:"<planet "}},Data:{},Cache:{},Messages:function(e,a,t){s.is(a)&&("Remove"===e?n.a.DataBase.Remove(a):"Set"===e?n.a.DataBase.Set(a,t):"GetPlayer"===e?n.a.DataBase.GetPlayer(a,t):"GetPlanet"===e&&n.a.DataBase.GetPlanet(a,t))},Start:function(e){s.is(e.indexedDB)&&"function"==typeof e.IDBKeyRange&&(n.a.DataBase.indexedDB=e.indexedDB,n.a.DataBase.IDBKeyRange=e.IDBKeyRange,n.a.DataBase.status=1)},Init:function(e){var a;(a=n.a.App.getUni(e))&&(s.is(n.a.DataBase.Data[a])||(n.a.DataBase.Data[a]={status:0,keyUni:e.keyUni,urlUni:e.urlUni}),0<=(a=n.a.DataBase.Data[a]).status&&2>=a.status&&(a.status=3,a.keyPlayer=e.keyPlayer,a.api=n.a.Option.Get(e.keyPlayer,"D20"),n.a.DataBase.Open(s.create(a),"Player")))},Status:function(e){var a,t;return(t=n.a.App.getUni(e))&&n.a.DataBase.Data[t]&&(a={status:n.a.DataBase.Data[t].status,tab:e.tab},s.iterate(n.a.DataBase.Info,function(e){var r;r=n.a.DataBase.Data[t+"_"+e]||{},a[e]={status:+r.status||0,timestamp:+r.timestamp||0,loading:+r.loading||0,entries:+r.entries||0}})),a},Close:function(e){if(s.is(n.a.DataBase.Data[e])){if(s.is(n.a.DataBase.Data[e].db))try{n.a.DataBase.Data[e].db.close()}catch(e){}n.a.DataBase.Data[e].db=null}},Remove:function(e){var a;(a=n.a.App.getUni(e))&&(n.a.DataBase.set(a,"status",-3),s.iterate(n.a.DataBase.Info,function(e){var t;t=a+"_"+e,n.a.DataBase.Close(t),n.a.DataBase.Data[t]={status:-3},n.a.DataBase.indexedDB.deleteDatabase(t).onsuccess=function(){!function(e,a){var t;n.a.App.getUni({keyUni:e})&&n.a.DataBase.Info[a]&&(n.a.Core.Log("DataBase - Remove   : "+e+"_"+a,!0),t=!0,n.a.DataBase.set(e+"_"+a,"status",0),s.iterate(n.a.DataBase.Info,function(a){-3===n.a.DataBase.get(e+"_"+a,"status")&&(t=!1)}),t&&n.a.DataBase.set(e,"status",0))}(a,e)}}))},set:function(e,a,t){e&&a&&s.is(n.a.DataBase.Data[e])&&(n.a.DataBase.Data[e][a]=t)},get:function(e,a){return e&&a&&s.is(n.a.DataBase.Data[e])?n.a.DataBase.Data[e][a]:0},isStatus:function(e,a){var t,r;if((t=n.a.App.getUni(e))&&a&&n.a.DataBase.Info[a]){if(1===n.a.DataBase.get(t,"status"))return t=t+"_"+a,1===(r=n.a.DataBase.get(t,"status"))||2===r?t:"";e.error=!0}return""},ObjectStore:function(e,a,t,r){if(e&&s.is(n.a.DataBase.Data[e].db))try{r(n.a.DataBase.Data[e].db.transaction(a,t||"readonly").objectStore(a))}catch(i){n.a.DataBase.indexedDB.open(e).onsuccess=function(i){try{n.a.DataBase.Data[e].db=i.target.result}catch(a){n.a.DataBase.Data[e].db=null}try{r(n.a.DataBase.Data[e].db.transaction(a,t||"readonly").objectStore(a))}catch(e){r(null)}}}else r(null)},Set:function(e){var a;s.is(e)&&s.is(e.data)&&(a=n.a.DataBase.isStatus(e,"Player"),e.api=n.a.DataBase.get(e.keyUni,"api"),a&&s.is(e.data.Player)&&n.a.DataBase.ObjectStore(a,"I","readwrite",function(a){a&&s.iterate(e.data.Player,function(t){var r;(r=e.data.Player[t]).I&&(a.get(+t).onsuccess=function(t){(t=t.target.result)&&r.N===t.N&&r.s===t.s&&r.aI===t.aI||(e.api&&n.a.Core.Log("Galaxy - Update Player "+r.N),a.put(r))})})}),(a=n.a.DataBase.isStatus(e,"Universe"))&&s.is(e.data.Planet)&&n.a.DataBase.ObjectStore(a,"pI","readwrite",function(a){a&&s.iterate(e.data.Planet,function(t){var r;r=e.data.Planet[t],a.index("c").get(t).onsuccess=function(i){i=i.target.result,r&&!i?(e.api&&n.a.Core.Log("Galaxy - New planet: "+t),a.put(r)):r&&i?r.I!==i.I?(n.a.Core.Log("Galaxy - Different player: "+t+" - Player "+i.I),i.c="moved",a.put(i),a.put(r)):r.pI!==i.pI?(n.a.Core.Log("Galaxy - Different planet: "+t),i.c="moved",a.put(i),a.put(r)):r.pN===i.pN&&r.mI===i.mI&&r.mN===i.mN||(n.a.Core.Log("Galaxy - Update planet: "+t),a.put(r)):!r&&i&&(n.a.Core.Log("Galaxy - Missing planet: "+t+" - Player "+i.I),i.c="moved",a.put(i))}})}))},GetPlayer:function(e,a){function t(t){e.error&&a(e),e.planets?(t=t||{},n.a.DataBase.getPlanetsByPlayerId(e,function(n){t.planets=n,Array.isArray(t.planets)&&(s.iterateArray(t.planets,function(e){e&&(!t.planetHome||+e.planetId<+t.planetHome)&&(t.planetHome=e.planetId)}),1===e.planets?t.planets.sort(function(e,a){var t,n;return t=c.check(e.coords).split(":"),n=c.check(a.coords).split(":"),+t[0]<+n[0]?-1:+t[0]>+n[0]?1:+t[1]<+n[1]?-1:+t[1]>+n[1]?1:+t[2]<+n[2]?-1:+t[2]>+n[2]?1:0}):2===e.planets&&t.planets.sort(function(e,a){return c.check(e.planetName),c.check(a.planetName),e<a?-1:e===a?0:1})),a(t)})):a(t)}"function"==typeof a&&(e.id?n.a.DataBase.getPlayerById(e,t):e.coords?n.a.DataBase.getPlanetByCoords(e,function(a){e.id=s.get(a,"playerId"),n.a.DataBase.getPlayerById(e,t)}):a())},GetPlanet:function(e,a){"function"==typeof a&&(e.id?a():e.coords?n.a.DataBase.getPlanetByCoords(e,function(t){t=t||{},e.id=t.playerId,n.a.DataBase.getPlayerById(e,function(e){s.copy(e,t),a(t)})}):a())},getPlayerById:function(e,a){var t;if("function"==typeof a)if(t=n.a.DataBase.isStatus(e,"Player"))try{n.a.DataBase.ObjectStore(t,"I","readonly",function(t){t&&+e.id?t.get(+e.id).onsuccess=function(e){var t;e=e.target.result,s.is(e)&&e.I&&(t={playerId:(e.I||"")+"",playerName:e.N||"",playerStatus:e.s||"",allianceId:(e.aI||"")+""}),a(t)}:a()})}catch(e){a()}else a()},getPlanetsByPlayerId:function(e,a){var t;if("function"==typeof a)if(t=n.a.DataBase.isStatus(e,"Universe"))try{n.a.DataBase.ObjectStore(t,"pI","readonly",function(t){var r;t&&+e.id?(r=[],t.index("I").openCursor(n.a.DataBase.IDBKeyRange.only(+e.id)).onsuccess=function(e){var t,n;e.target.result?(n=e.target.result.value,s.get(n,"pI")&&(t={coords:n.c||"",planetId:(n.pI||"")+"",planetName:n.pN||""},n.mI&&(t.moonId=(n.mI||"")+"",t.moonName=n.mN||""),r.push(t)),e.target.result.continue()):a(r)}):a()})}catch(e){a()}else a()},getPlanetByCoords:function(e,a){var t;if("function"==typeof a)if(t=n.a.DataBase.isStatus(e,"Universe"))try{n.a.DataBase.ObjectStore(t,"pI","readonly",function(t){t&&e.coords?t.index("c").get(e.coords).onsuccess=function(e){var t;e=e.target.result,s.is(e)&&e.pI&&(t={playerId:(e.I||"")+"",coords:e.c||"",planetId:(e.pI||"")+"",planetName:e.pN||"",moonId:(e.mI||"")+"",moonName:e.mN||""}),a(t)}:a()})}catch(e){a()}else a()},Open:function(e,a){function t(a,t,i){r.timestamp=+i||1,r.status=t||("blocked"===a.type?-1:-2);try{r.db=a.target.result}catch(e){r.db=null}n.a.DataBase.Check(e)}var r,i,o;o=-3,n.a.App.getUni(e)&&a&&(e.key="",e.tab=a,n.a.DataBase.Info[e.tab]&&(e.key=e.keyUni+"_"+e.tab,s.is(n.a.DataBase.Data[e.key])||(n.a.DataBase.Data[e.key]={}),o=-1>(o=+(r=n.a.DataBase.Data[e.key]).status||0)?o:1===o||2===o?o:0,r.status=o)),0>o?n.a.DataBase.Check(e):s.is(r.db)&&r.timestamp?n.a.DataBase.Check(e):(r.status=4,n.a.DataBase.Close(e.key),(i=n.a.DataBase.indexedDB.open(e.key,2)).onblocked=t,i.onerror=t,i.onupgradeneeded=function(r){var o,s;o=n.a.DataBase.Info[e.tab].keyPath,i.onsuccess=null,(s=r.target.result).onerror=t,s.objectStoreNames.contains("info")||s.createObjectStore("info"),s.objectStoreNames.contains(o)||(o=s.createObjectStore(o,{keyPath:o}),"Universe"===a&&(o.createIndex("I","I",{unique:!1}),o.createIndex("c","c",{unique:!1}))),t(r,2)},i.onsuccess=function(e){var a;try{(a=e.target.result.transaction("info").objectStore("info").get("timestampServer")).onerror=t,a.onsuccess=function(a){t(e,1,a.target.result)}}catch(a){t(e,-2)}})},isRead:function(e){return n.a.status&&e.api&&e.key&&3<=n.a.DataBase.get(e.keyUni,"status")?n.a.DataBase.Data[e.key].status:0},Check:function(e){var a,t,r;1<=n.a.DataBase.isRead(e)?((a=n.a.DataBase.Data[e.key]).status=1!==a.status?a.status:1e3>a.timestamp?2:n.a.Time.timestamp()-a.timestamp>3600*n.a.DataBase.Info[e.tab].hour?2:1,2<=a.status&&(e.load||!a.timestampRead||n.a.Time.timestamp()-a.timestampRead>n.a.DataBase.readLimit)?((t=new XMLHttpRequest).timeout=2e3,t.open("HEAD",e.urlUni+n.a.DataBase.Info[e.tab].url,!0),t.onerror=t.onload=function(){n.a.DataBase.isRead(e)&&(a.timestampRead=n.a.Time.timestamp(),a.timestampHeader=Math.floor(new Date(t.getResponseHeader("Last-Modified")).getTime()/1e3),200==+t.status&&1e4<a.timestampHeader?a.status=a.timestamp/100<a.timestampHeader/100?3:1:(a.timestampHeader=0,n.a.Core.Log("DataBase   - ########## Problem: These OGame API is not available - "+e.tab,!0))),n.a.DataBase.Read(e)},t.send(null)):n.a.DataBase.Read(e)):(-1===(r=n.a.DataBase.get(e.key,"status"))&&n.a.Core.Log("DataBase   - Problem: Please restart your browser ("+e.key+")",!0),-2===r&&n.a.Core.Log("DataBase   - Problem: Please delete the database "+e.tab+" for the universe "+e.keyUni,!0),n.a.DataBase.Read(e))},Read:function(e){function a(a,r){var s,u,l,p,m,g;g=0,s=r.split(n.a.DataBase.Info[e.tab].split),p={a:30,v:29,b:28,o:27,h:26,I:23,i:22},m=a.target.result,i.db=a.target.result,i.entries=s.length,i.timestamp=i.timestampHeader||+c.getAttribute(s[0],"timestamp")||n.a.Time.timestamp(),m.objectStoreNames.contains("info")&&m.objectStoreNames.contains(o.keyPath)?((u=m.transaction("info","readwrite")).objectStore("info").put(0,"timestampServer"),u.objectStore("info").put(0,"entries"),(u=m.transaction(o.keyPath,"readwrite")).onabort=function(){t(1)},u.ontimeout=t,u.oncomplete=function(){s=null,3===n.a.DataBase.isRead(e)&&((u=m.transaction("info","readwrite")).objectStore("info").put(i.timestamp,"timestampServer"),u.objectStore("info").put(i.entries,"entries"),t(1))},(l=u.objectStore(o.keyPath)).clear(),"Player"===e.tab?function a(){var r,o;if(g++,3!==n.a.DataBase.isRead(e))t();else if(g<s.length){o=" "+s[g],r=+c.getAttribute(o,"id")||g;var u=c.getAttribute(o,"name"),m=c.getAttribute(o,"status"),d=21;m&&(m[0]&&(d=Math.max(+p[m[0]]||0,d)),m[1]&&(d=Math.max(+p[m[1]]||0,d)),m[2]&&(d=Math.max(+p[m[2]]||0,d))),r={I:r,N:u,s:d},(o=+c.getAttribute(o,"alliance")||0)&&(r.aI=o),0==g%Math.ceil(s.length/100)&&(i.loading=Math.ceil(g/(s.length/100))||1,n.a.Manager.message(e,"DataBase","Notify",{tab:e.tab,loading:i.loading})),l.add(r).onsuccess=a}}():"Universe"===e.tab&&function a(){var r,o;g++,3!==n.a.DataBase.isRead(e)?t():g<s.length&&(o=(" "+s[g]).split("<moon"),r={pI:+c.getAttribute(o[0],"id")||g,I:+c.getAttribute(o[0],"player")||2,pN:c.getAttribute(o[0],"name"),c:c.getAttribute(o[0],"coords")},o[1]&&(r.mI=+c.getAttribute(o[1],"id")||0,r.mN=c.getAttribute(o[1],"name")),0==g%Math.ceil(s.length/100)&&(i.loading=Math.ceil(g/(s.length/100))||1,n.a.Manager.message(e,"DataBase","Notify",{tab:e.tab,loading:i.loading})),l.add(r).onsuccess=a)}()):t(-2)}function t(a){i.status=a||-1,i.loading=0;try{i.db.close()}catch(e){}n.a.Manager.message(e,"DataBase","Notify",n.a.DataBase.Status(e)),n.a.Core.Log("DataBase - Read     : "+e.key+" - Finished with entries: "+(i.entries||"")+" ("+a+")",!0),r(e)}function r(e){"Player"===e.tab?n.a.DataBase.Open(e,"Universe"):"Universe"===e.tab&&e.keyUni&&(n.a.DataBase.Data[e.keyUni].status=1,s.iterate(n.a.DataBase.Info,function(a){0>=(a=+n.a.DataBase.get(e.keyUni+"_"+a,"status")||0)&&(n.a.DataBase.Data[e.keyUni].status=-1),3<=a&&-1!==n.a.DataBase.Data[e.keyUni].status&&(n.a.DataBase.Data[e.keyUni].status=3)}))}var i,o,u;3===n.a.DataBase.isRead(e)?(n.a.Core.Log("DataBase - Read     : "+e.key,!0),o=n.a.DataBase.Info[e.tab],(i=n.a.DataBase.Data[e.key]).loading=0,n.a.Manager.message(e,"DataBase","Notify",{tab:e.tab,loading:i.loading}),(u=new XMLHttpRequest).open("GET",e.urlUni+o.url,!0),u.overrideMimeType("text/html"),u.onerror=u.onload=function(){var r,i;n.a.DataBase.isRead(e)&&(r=u.responseText||"",200==+u.status&&-1<r.indexOf(o.split)?(n.a.DataBase.Close(e.key),(i=n.a.DataBase.indexedDB.open(e.key)).onerror=t,i.onblocked=t,i.onsuccess=function(e){a(e,r||"")}):(n.a.Core.Log("DataBase   - ########## Problem: These OGame API is not available - "+o.url,!0),t())),u=null},u.send(null)):r(e)}},n.a.Tools={Data:{},List:["A","B","C","D","E","F",1,2,3,4,5,6,7,8,9],Links:{T3A:"http://proxyforgame.com/ogame/calc/trade.php",T3B:"http://ogamespec.com/tools/trade.php",T4A:"http://proxyforgame.com/ogame/calc/flight.php",T4B:"http://www.toolsforogame.com/battle/batalla_ACS_SAC.aspx",T4C:"http://snaquekiller.free.fr/ogame/tableau.html",T7A:"http://kb.un1matr1x.de/save.php",T7B:"http://logserver.net/index.php",T9A:"http://wiki.ogame.org/",T9B:"http://board.origin.ogame.de/index.php?page=Thread&threadID=104"},Messages:function(e,a,t){"Action"===e&&n.a.Tools.Action(a,t)},Action:function(e,a){var t,r,i;if(r=n.a.App.getPlayer(e,"copy")){if(i={id:e.id},n.a.Option.Get(r,"T05")&&((t=n.a.Task.splitActive(n.a.Option.Get(r,"T06"),2,e.coordstype)).ships?e.Ships=s.createFilter(t,n.a.Item.Ship):e.planetId&&(e.Ships=n.a.Units.create(r,e.planetId,n.a.Item.ShipCombat))),s.is(e.Search))switch(e.tab=e.Search.tab,e.tab){case"Alliance":e.searchAlliance=e.Search.id,e.searchAllianceName=e.Search.name,e.searchAllianceTag=e.Search.tag;break;case"Player":e.searchPlayer=e.Search.id,e.searchPlayerName=e.Search.name;break;case"Target":e.searchTarget=e.Search.id,e.searchTargetCoords=e.Search.coords}else e.searchAlliance=n.a.Panel.getActive(r,"Alliance","id",6),e.searchAllianceName=n.a.Panel.getActive(r,"Alliance","name",6),e.searchAllianceTag=n.a.Panel.getActive(r,"Alliance","tag",6),e.searchPlayer=n.a.Panel.getActive(r,"Player","id",6),e.searchPlayerName=n.a.Panel.getActive(r,"Player","name",6),e.searchTarget=n.a.Panel.getActive(r,"Target","id",6),e.searchTargetCoords=n.a.Panel.getActive(r,"Target","coords",6);switch(-1<c.check(e.searchTarget).indexOf(":")&&(e.searchTarget=""),e.searchTargetMoon=3==+c.check(e.searchTargetCoords).split(":")[3],e.searchTargetCoords=n.a.Task.cutCoords(e.searchTargetCoords),e.id){case"T1A":n.a.Tools.createOgniter(e);break;case"T1B":n.a.Tools.createInfuza(e);break;case"T1C":n.a.Tools.createWarRiders(e);break;case"T2A":n.a.Tools.createCumulative(e);break;case"T2B":n.a.Tools.createOcalcAmortisation(e);break;case"T5A":n.a.Tools.createOsimulate(e);break;case"T5B":n.a.Tools.createWebsim(e);break;case"T5C":n.a.Tools.createDragosim(e);break;case"T5D":n.a.Tools.createTrashsim(e);break;default:n.a.Tools.createLink(e)}i.href=e.href}a&&a(i)},createLink:function(e){var a;a=n.a.App.getPlayer(e,"copy"),a=n.a.Tools.Links[e.id]||c.check(n.a.Option.Get(a,e.id)).split("|",2)[1],(a=c.check(a).trim())&&("http:/"!==a.slice(0,6).toLowerCase()&&"https:/"!==a.slice(0,7).toLowerCase()&&(a="http://"+a),a=(a=(a=(a=(a=(a=(a=(a=(a=a.replace(/\[UNI\]/g,u.parseIntAbs(e.abbrUni)||"")).replace(/\[ALLIANCE\]/g,e.searchAlliance||"")).replace(/\[ALLIANCENAME\]/g,e.searchAllianceName||"")).replace(/\[ALLIANCETAG\]/g,e.searchAllianceTag||"")).replace(/\[PLAYER\]/g,e.searchPlayer||"")).replace(/\[PLAYERNAME\]/g,e.searchPlayerName||"")).replace(/\[TARGET\]/g,e.searchTarget||"")).replace(/\[TARGETCOORDS\]/g,e.searchTargetCoords||"")).replace(/\[TARGETMOON\]/g,e.searchTargetMoon||""),e.href=a)},createWarRiders:function(e){var a,t;(t=n.a.Com.Get(e.abbrCom,"warriders"))&&(a="Alliance"===e.tab?"&page=details&type=ally&name="+(e.searchAllianceTag||""):"Player"===e.tab?"&page=details&type=player&name="+(e.searchPlayerName||""):"",e.href="http://ogame.gamestats.org/?lang="+t+"&uni="+(e.abbrUni||"").toLowerCase()+encodeURI(a))},createInfuza:function(e){var a;a="Alliance"===e.tab?"&pora=alliances&value="+(e.searchAllianceTag||""):"Player"===e.tab?"&pora=players&value="+(e.searchPlayerName||""):"",e.href="http://www.infuza.com/"+n.a.Com.Get(e.abbrCom,"infuza")+"/Search?server="+n.a.Com.Get(e.abbrCom,"infuzaServer")+encodeURI(a)},createOgniter:function(e){var a;a="Alliance"===e.tab?"/alliance/"+(e.searchAlliance||""):"Player"===e.tab?"/player/"+(e.searchPlayer||""):"",e.href="http://www.ogniter.org/"+n.a.Com.Get(e.abbrCom,"ogniter")+"/"+n.a.Com.Get(e.abbrCom,"ogniter")+u.parseIntAbs(e.abbrUni)+encodeURI(a)},createCumulative:function(e){var a,t;a=n.a.App.getPlayer(e,"copy"),t="http://calc.antigame.de/?lang="+(e.abbrCom||"").toLowerCase()+"&coords="+(e.coords||"")+"&type="+(e.type||"")+"&name="+(e.planetName||"")+"&uni_speed="+n.a.Uni.Get(a,"speed")+"&robo="+n.a.Units.Get(a,e.planetId,"14")+"&nanite="+n.a.Units.Get(a,e.planetId,"15")+"&rlab="+n.a.Units.Get(a,e.planetId,"31")+(n.a.Option.Get(a,"technocrat")?"&technocrat=1":""),s.iterate(n.a.Item.Mining,function(r){t+=c.addUrlPara(r+"c",n.a.Units.Get(a,e.planetId,r))}),s.iterate(n.a.Item.Station,function(r){t+=c.addUrlPara(r+"c",n.a.Units.Get(a,e.planetId,r))}),s.iterate(n.a.Item.Research,function(e){t+=c.addUrlPara(e+"c",n.a.Units.Get(a,"account",e))}),e.href=t},createOcalcAmortisation:function(e){var a,t,r;a=n.a.App.getPlayer(e,"copy"),r=n.a.Option.Get(a,"commander")&&n.a.Option.Get(a,"admiral")&&n.a.Option.Get(a,"engineer")&&n.a.Option.Get(a,"geologist")&&n.a.Option.Get(a,"technocrat")?"1.12":n.a.Option.Get(a,"geologist")?"1.1":"1",t="http://www.o-calc.com/?sec=_amortisation&lang="+(e.abbrCom||"").toLowerCase()+"&p="+n.a.Units.Get(a,"account","122")+"&g="+r+"&em=2&ec=1&ed=1&s="+n.a.Uni.Get(a,"speed")+"&d=",s.iterate(e.Planets,function(r){t+=encodeURI(s.get(e.Planets[r],"name"))+"."+((+s.get(e.Planets[r],"temp")||0)+40).toString(36)+"."+n.a.Units.Get(a,r,"1").toString(36)+"."+n.a.Units.Get(a,r,"2").toString(36)+"."+n.a.Units.Get(a,r,"3").toString(36)+"+"}),e.href=t},createOsimulate:function(e){var a,t,r;t=n.a.App.getPlayer(e,"copy"),a=e.Task,r="http://www.osimulate.com/?ref=antigame&lang="+n.a.Com.Get(e.abbrCom,"osimulate")+"&uni="+e.abbrCom+"_"+e.abbrUni+"&uni_speed="+n.a.Uni.Get(t,"speedFleet")+"&fleet_debris="+100*n.a.Uni.Get(t,"debrisFactor")+"&defense_debris="+(n.a.Uni.Get(t,"defToTF")?100*n.a.Uni.Get(t,"debrisFactorDef"):"0")+"&rapidfire="+(n.a.Uni.Get(t,"rapidFire")?1:0)+"&start_pos="+(e.coords||"")+"&engine0_0="+n.a.Units.Get(t,"account","115")+"&engine0_1="+n.a.Units.Get(t,"account","117")+"&engine0_2="+n.a.Units.Get(t,"account","118"),r=a&&!a.timeResearch&&n.a.Option.Get(t,"T03")?r+"&del_techs=1":r+"&tech_a0_0="+n.a.Units.Get(t,"account","109")+"&tech_a0_1="+n.a.Units.Get(t,"account","110")+"&tech_a0_2="+n.a.Units.Get(t,"account","111"),s.iterate(e.Ships,function(a){r+=c.addUrlPara("ship_a0_"+((+a||0)-202)+"_b",e.Ships[a])}),a&&(r+="&tech_d0_0="+(+a[109]||0)+"&tech_d0_1="+(+a[110]||0)+"&tech_d0_2="+(+a[111]||0)+"&enemy_metal="+(+a.metal||0)+"&enemy_crystal="+(+a.crystal||0)+"&enemy_deut="+(+a.deuterium||0)+"&enemy_name="+(a.name||"")+"&enemy_pos="+(a.coords||"")+"&enemy_type="+(a.type||"")+"&enemy_player="+(a.detail||"")+"&enemy_status="+(a.status||"")+"&report_time="+(a.time||"")+"&plunder_perc="+(a.plunder||"")+c.addUrlPara("abm_b",a[502]),s.iterate(n.a.Item.Ship,function(e){r+=c.addUrlPara("ship_d0_"+((+e||0)-202)+"_b",a[e])}),s.iterate(n.a.Item.Defense,function(e){1===n.a.Item.Defense[e]&&(r+=c.addUrlPara("ship_d0_"+((+e||0)-387)+"_b",a[e]))})),e.href=r},createWebsim:function(e){var a,t,r;t=n.a.App.getPlayer(e,"copy"),a=e.Task,r="http://websim.speedsim.net/index.php?version=1&ref=antigame&lang="+n.a.Com.Get(e.abbrCom,"websim")+"&uni="+e.abbrCom+"_"+e.abbrUni+"&uni_speed="+n.a.Uni.Get(t,"speedFleet")+"&perc-df="+100*n.a.Uni.Get(t,"debrisFactor")+"&def_to_df="+(n.a.Uni.Get(t,"defToTF")?1:0)+"&rf="+(n.a.Uni.Get(t,"rapidFire")?1:0)+"&start_pos="+(e.coords||"")+"&engine0_0="+n.a.Units.Get(t,"account","115")+"&engine0_1="+n.a.Units.Get(t,"account","117")+"&engine0_2="+n.a.Units.Get(t,"account","118"),r=a&&!a.timeResearch&&n.a.Option.Get(t,"T03")?r+"&del_techs=1":r+"&tech_a0_0="+n.a.Units.Get(t,"account","109")+"&tech_a0_1="+n.a.Units.Get(t,"account","110")+"&tech_a0_2="+n.a.Units.Get(t,"account","111"),s.iterate(e.Ships,function(a){r+=c.addUrlPara("ship_a0_"+((+a||0)-202)+"_b",e.Ships[a])}),a&&(r+="&tech_d0_0="+(+a[109]||0)+"&tech_d0_1="+(+a[110]||0)+"&tech_d0_2="+(+a[111]||0)+"&enemy_metal="+(+a.metal||0)+"&enemy_crystal="+(+a.crystal||0)+"&enemy_deut="+(+a.deuterium||0)+"&enemy_name="+(a.name||"")+"&enemy_pos="+(a.coords||"")+"&enemy_type="+(a.type||"")+"&enemy_player="+(a.detail||"")+"&enemy_status="+(a.status||"")+"&report_time="+(a.time||"")+"&plunder_perc="+(a.plunder||"")+c.addUrlPara("abm_b",a[502]),s.iterate(n.a.Item.Ship,function(e){r+=c.addUrlPara("ship_d0_"+((+e||0)-202)+"_b",a[e])}),s.iterate(n.a.Item.Defense,function(e){1===n.a.Item.Defense[e]&&(r+=c.addUrlPara("ship_d0_"+((+e||0)-387)+"_b",a[e]))})),e.href=r},createDragosim:function(e){var a,t,r,i;t=n.a.App.getPlayer(e,"copy"),a=e.Task,i={202:"k_t",203:"g_t",204:"l_j",205:"s_j",206:"kr",207:"sc",208:"ko",209:"re",210:"sp",211:"bo",212:"so",213:"z",214:"t",215:"sk",401:"ra",402:"l_l",403:"s_l",404:"g",405:"i",406:"p",407:"k_s",408:"g_s"},r="http://drago-sim.com/index.php?ref=antigame&lang="+n.a.Com.Get(e.abbrCom,"dragosim")+"&uni="+e.abbrCom+"_"+e.abbrUni+"&uni_speed="+n.a.Uni.Get(t,"speedFleet")+"&debris_ratio="+n.a.Uni.Get(t,"debrisFactor")+"&def_tf="+Boolean(n.a.Uni.Get(t,"defToTF"))+"&rapid_fire="+(n.a.Uni.Get(t,"rapidFire")?1:0),r=a&&!a.timeResearch&&n.a.Option.Get(t,"T03")?r+"&del_techs=1":r+"&techs[0][0][w_t]="+n.a.Units.Get(t,"account","109")+"&techs[0][0][s_t]="+n.a.Units.Get(t,"account","110")+"&techs[0][0][r_p]="+n.a.Units.Get(t,"account","111"),s.iterate(e.Ships,function(a){r+=c.addUrlPara("numunits[0][0]["+i[a]+"]",e.Ships[a])}),a&&(r+="&techs[1][0][w_t]="+(+a[109]||0)+"&techs[1][0][s_t]="+(+a[110]||0)+"&techs[1][0][r_p]="+(+a[111]||0)+"&v_met="+(+a.metal||0)+"&v_kris="+(+a.crystal||0)+"&v_deut="+(+a.deuterium||0)+"&v_planet="+(a.name||"")+"&v_coords="+(a.coords||"")+"&enemy_type="+(a.type||"")+"&enemy_player="+(a.detail||"")+"&enemy_status="+(a.status||"")+"&report_time="+(a.time||"")+"&plunder_perc="+(a.plunder||"")+c.addUrlPara("missiles_available_v",a[502]),s.iterate(n.a.Item.Ship,function(e){r+=c.addUrlPara("numunits[1][0]["+i[e]+"]",a[e])}),s.iterate(n.a.Item.Defense,function(e){1===n.a.Item.Defense[e]&&(r+=c.addUrlPara("numunits[1][0]["+i[e]+"]",a[e]))})),e.href=r},createTrashsim:function(e){var a=n.a.App.getPlayer(e,"copy"),t=r(e.coords.split(":"),3),i=t[0],o=t[1],c=t[2],u={0:[{research:{109:{level:n.a.Units.Get(a,"account","109")},110:{level:n.a.Units.Get(a,"account","110")},111:{level:n.a.Units.Get(a,"account","111")},115:{level:n.a.Units.Get(a,"account","115")},117:{level:n.a.Units.Get(a,"account","117")},118:{level:n.a.Units.Get(a,"account","118")}},planet:{galaxy:i,system:o,position:c},ships:{}}],settings:{speed_fleet:n.a.Uni.Get(a,"speedFleet"),galaxies:n.a.Uni.Get(a,"galaxies"),systems:n.a.Uni.Get(a,"systems"),rapid_fire:n.a.Uni.Get(a,"rapidFire"),def_to_tF:n.a.Uni.Get(a,"defToTF"),debris_factor:n.a.Uni.Get(a,"debrisFactor"),repair_factor:n.a.Uni.Get(a,"repairFactor"),donut_galaxy:n.a.Uni.Get(a,"donutGalaxy"),donut_system:n.a.Uni.Get(a,"donutSystem"),global_deuterium_save_factor:n.a.Uni.Get(a,"globalDeuteriumSaveFactor")}};if(s.iterate(e.Ships,function(a){e.Ships[a]&&(u[0][0].ships[a]={count:e.Ships[a]})}),e.Task){var l={ships:"ships",defense:"defence"},p=e.Task;u[1]=[{resources:{metal:p.metal,crystal:p.crystal,deuterium:p.deuterium},research:{},ships:{},defence:{},planet:p.coords}],s.iterate(p.research,function(e){u[1][0].research[e]={level:p.research[e]}}),s.iterate(p.units,function(e){s.iterate(p.units[e],function(a){u[1][0][l[e]][a]={count:p.units[e][a]}})})}u=window.btoa(JSON.stringify(u));var m="https://trashsim.universeview.be/"+n.a.Com.Get(e.abbrCom,"trashsim")+(e.api?"?SR_KEY="+e.api:"")+"#prefill="+u;e.href=m}},n.a.Panel={Data:{},Messages:function(e,a,t){"Set"===e?n.a.Panel.Set(a):"ListAccount"===e&&n.a.Panel.ListAccount(a,t)},Init:function(e,a){var t,r,i,o;(o=n.a.App.getPlayer(e))&&(n.a.Panel.Data[o]={},t=n.a.Panel.Data[o],(r=s.parse(a[n.a.Data.getKey(o,"Panel","Data")])).version!==n.a.Data.get("Panel","Data","version")&&(r={}),n.a.Data.iterate("Panel",function(e,a){e.tab&&(t[a]={},"label"in e&&(t[a].label=e.label||""),2<=e.tab&&(i=s.is(r[a])?r[a]:[],t[a].status=+i[0]||0,t[a].data=c.check(i[1])))}))},Save:function(e){var a,t,r;t=n.a.App.getPlayer(e),a=n.a.Panel.Data[t],n.a.Data.isStatus(t)&&a&&(e.backup||a.changed)&&(delete a.changed,r={version:n.a.Data.get("Panel","Data","version")},n.a.Data.iterate("Panel",function(e,a){2<=e.tab&&(r[a]=[n.a.Panel.get(t,a,"status"),n.a.Panel.get(t,a,"data",6)])}),e.save&&(e.save[t+"_Panel_Data"]=JSON.stringify(r)),e.backup&&n.a.Data.isBackup(t,"Panel","Data",2)&&(e.backup.Panel_Data=JSON.stringify(r)))},Cache:function(e,a){var t;t=n.a.App.getPlayer(e),n.a.Panel.Data[t]&&(n.a.Panel.Data[t].Cache=a)},ListAccount:function(e,a){var t,r,i;r=n.a.App.getPlayer(e),t=n.a.Panel.Data[r],r&&t&&((i={tab:"Account",statusColor:{}}).Units=e.planet&&"account"!==e.planet?n.a.Units.SummarizePosition(e):n.a.Units.SummarizeAccount(e),n.a.Units.iterate(r,function(e,a){var t,r=i.statusColor,o=+e.timeShip,s=+e.timeResource;o?t=3600<(o=n.a.Time.timestampMinute()-o)?4:60<o?5:6:s&&(t=3600<(o=n.a.Time.timestampMinute()-s)?1:60<o?2:3),r[a]=n.a.Styles.colorStatusUnits[t||0]||""})),a&&a(i)},Set:function(e){var a,t;t=n.a.App.getPlayer(e),a=n.a.Panel.Data[t],t&&a&&(t=n.a.Panel.getTab(e))&&e.key&&((s.is(e.value)||a[t][e.key]!==e.value)&&(a.changed=!0,n.a.Data.Change()),a[t][e.key]=e.value)},get:function(e,a,t,r){return e=e&&n.a.Panel.Data[e]&&a&&n.a.Panel.Data[e][a]&&t?n.a.Panel.Data[e][a][t]:"",6===r?c.check(e):+e||0},getActive:function(e,a,t,r){var i;return e&&n.a.Panel.Data[e]&&a&&n.a.Panel.Data[e][a]&&t&&(i=s.get(n.a.Panel.Data[e][a].active,t)),6===r?c.check(i):+i||0},getTab:function(e){return e.tab&&s.is(n.a.Panel.Data[e.keyPlayer][e.tab])?e.tab:""}},n.a.Box={Data:{},Messages:function(e,a,t){"List"===e&&n.a.Box.List(a,t)},Init:function(e){var a;(e=n.a.App.getPlayer(e))&&(n.a.Box.Data[e]={},a=n.a.Box.Data[e],n.a.Data.iterate("Box",function(e,t){e.tab&&(a[t]={})}))},List:function(e,a){var t;(t=n.a.App.getPlayer(e,"copy"))&&n.a.Box.Data[t]?n.a.DataBase.GetPlayer(e,function(r){(r=r||{}).tab=e.tab,r.id=e.id,n.a.Box.Data[t].Cache=r,a&&a(r)}):a&&a()}},n.a.Para={A00:[0],A01:[0],A02:[0],A03:[0],A04:[0],A05:[0],A06:[0],A07:[0],A08:[0],A10:[6,1,""],A11:[0],A30:[0],A31:[1,1,1,0,1,1],A32:[1,1,1,0,1,1],A34:[1,1,1,0,1,1],A33:[1,1,1],A38:[0],A39:[0],A50:[0],A51:[0],A52:[0],A53:[0],A54:[0],A55:[0],A56:[0],A57:[0],A59:[0],A80:[0],A81:[0],A82:[0],A83:[0],A90:[0],A99:[0],AH1:[0],AH2:[0],AH3:[0],AH5:[0],AH6:[0],AH8:[0],AH9:[0],AI1:[0],AI2:[0],AM0:[0],AM1:[0],AM2:[0],AM3:[0],AT0:[0],AT1:[0],AT2:[0],AT3:[0],AT4:[0],AT5:[0],AT6:[0],AT7:[0],AT8:[0],AT9:[0],ATC:[0],ATR:[0],ATS:[0],ATT:[0],U00:[0],U10:[0],U11:[2,1,0],U13:[0],U14:[0],U15:[0],U18:[0],U19:[20,1,"#03060b"],U22:[6,1,""],U30:[0],U31:[1,1,1,1,1,1],U32:[1,1,1,0,1,1],U33:[1,1,0,0,0,1],U34:[1,1,1,0,1,1],U35:[1,1,1],U41:[1,1,1],U51:[2,1,1],U52:[2,1,1],U60:[1,1,1,0,1,1],U61:[1,1,1,0,1,1],U62:[2,1,8],U65:[2,1,8],U66:[2,1,0],U67:[2,1,0],B00:[1,1,1],B01:[1,1,1],B02:[1,1,1],B04:[1,1,1,0,1,1],B11:[1,2,1],B12:[1,2,0],B15:[1,2,0],B16:[2,2,"203"],B17:[0],B18:[0],B19:[0],B20:[1,2,0],B21:[2,1,3],B22:[0],B23:[0],B24:[0],B31:[1,2,1,0,1,1],B32:[6,1,"2:1:1"],B35:[2,1,0],B36:[0],B37:[0],B38:[0],B40:[0],B80:[0],C00:[0],CA4:[0],CA5:[0],CA6:[0],CA7:[0],CA9:[0],CM0:[1,1,1],CM3:[2,1,55],C01:[20,1,"#D43635"],C02:[20,1,"#D43635"],C03:[20,1,"#7EAD3D"],C04:[20,1,"#36B588"],C05:[20,1,"#D57936"],C06:[20,1,"#BD9B2F"],C07:[20,1,"#2BBFBF"],C08:[20,1,"#11A140"],C09:[20,1,"#FF3356"],C15:[20,1,"#4162A5"],CT0:[1,1,1],CT2:[2,1,33],C20:[0],C21:[22,1,"#CFCBC2",""],C22:[22,1,"#6E6E6E",""],C23:[22,1,"#4F4F4F",""],C24:[22,1,"#05FF08",""],C25:[22,1,"#FF0000",""],C26:[22,1,"#FFFF66",""],C27:[22,1,"#FF33FF","#FF33FF||1"],C28:[22,1,"#FFFFFF","#FFFFFF|66|1"],C29:[22,1,"#00FFFF","INHERIT||1"],C30:[22,1,"#F48406",""],C40:[0],C41:[23,1,"#008000",""],C42:[23,1,"#008000",""],C43:[23,1,"#008000",""],C44:[23,1,"#008080",""],C45:[23,1,"#008080"],C46:[23,1,"#226EBF"],C47:[23,1,"#226EBF",""],C48:[23,1,"#ff0000",""],C49:[23,1,"#ff0000"],C50:[0],C51:[23,1,"#226EBF"],C52:[23,1,"#226EBF"],C53:[23,1,"#226EBF",""],C54:[23,1,"#226EBF",""],C55:[23,1,"#008080"],C56:[23,1,""],C57:[23,1,""],C58:[23,1,""],C59:[23,1,""],C60:[0],C61:[23,1,"#ffff00",""],C62:[23,1,"#ffff00","#ffff00||1"],C63:[23,1,"#ffff00",""],C64:[23,1,"#ffa500"],C65:[23,1,"#ffa500",""],C66:[23,1,"#ff4500","#ff4500||10"],C67:[23,1,"#ff0000"],C68:[23,1,""],C69:[23,1,""],C71:[23,1,""],C72:[23,1,""],C73:[23,1,""],C74:[23,1,""],C75:[23,1,""],C76:[23,1,""],C77:[23,1,""],C78:[23,1,""],C79:[23,1,""],CS0:[1,1,1],CS1:[22,1,"#99CC00","#99CC00|11|1"],CS2:[22,1,"#FFFFFF","#FFFFFF|11|1"],CS3:[22,1,"#FF9600","#FF9600|11|1"],CS5:[20,1,"#FF9600"],CSA:[20,1,"#69AFFC"],CSB:[20,1,"#1031A0"],CSC:[20,1,"#FF1ADA"],CE0:[1,1,1],C94:[22,1,"#D43635","#D43635||13|10000"],C95:[22,1,"#D43635","#D43635|66|13|1000000"],C96:[22,1,"#D43635","#D43635|88"],C97:[22,1,"#764DFF",""],C98:[22,1,"#764DFF",""],C99:[22,1,"#764DFF","#764DFF|88"],H01:[0],H02:[0],H03:[0],H05:[0],H06:[0],H07:[0],H08:[0],H10:[0],H11:[0],H13:[0],H15:[0],H16:[0],H18:[0],H21:[0],D00:[0],D01:[0],D02:[0],D03:[0],D04:[2,1,2,1,2,3],D05:[0],D06:[0],D07:[0],D08:[0],D09:[0],D0B:[0],D10:[6,0,""],D11:[0],D12:[0],D15:[0],D19:[0],D20:[1,1,1],D22:[0],D23:[0],D26:[0],D27:[0],D29:[0],D36:[0],D37:[0],D41:[0],D45:[0],D46:[0],D47:[0],D49:[0],D60:[1,1,1],D61:[2,1,1],D62:[6,1,""],D67:[0],D68:[0],D69:[0],D70:[0],D71:[2,3,1],D72:[0],D77:[0],D78:[0],D79:[0],D7A:[0],D80:[0],D81:[2,3,1],D82:[0],D85:[1,1,0],D87:[0],D88:[0],D89:[0],D8A:[0],D90:[0],D91:[0],D92:[0],D93:[0],D95:[0],D9A:[0],D9B:[0],D9C:[0],D9D:[0],D9E:[0],D9F:[0],DT1:[0],DX1:[2,0,0],DX2:[0],DX4:[0],DX6:[0],DX8:[0],DX9:[0],O00:[0],O02:[1,1,1],O03:[2,1,0],O04:[1,1,1,0,1,1],O50:[1,1,1],O51:[1,1,1],O52:[1,1,0],O53:[1,1,1],O54:[1,1,1],O55:[1,1,1],O60:[1,1,1],O61:[1,1,1],O70:[0],O71:[2,1,0],I00:[1,1,1],I02:[2,3,9],I03:[2,3,0],I04:[2,3,0],I05:[2,1,12],I0A:[0],I0B:[0],I0C:[0],I0D:[0],I0E:[0],I0T:[0],I10:[0],I20:[0],I21:[2,2,0],I22:[1,2,0],I23:[0],I24:[1,2,1],I25:[1,2,1],I26:[1,2,1],I27:[0],I28:[0],I29:[0],I30:[0],I31:[1,2,1],I32:[1,2,0],I33:[1,2,1],I34:[1,2,1],I35:[1,2,0],I36:[1,2,1],I37:[1,2,1],I38:[1,2,1],I39:[0],I3A:[0],I3B:[0],I40:[0],I41:[2,2,0],I42:[1,2,0],I47:[0],I80:[0],I81:[1,2,0,0,0,1],I82:[1,2,0,0,0,1],I83:[1,2,0,0,0,1],I84:[2,2,0],I85:[2,2,50],I90:[0],T00:[1,1,1],T01:[1,2,0],T02:[1,1,1],T03:[1,1,1],T05:[1,2,1],T06:[-1,1,""],T10:[0],T1A:[1,1,1],T1B:[1,1,1],T1C:[1,1,0],T11:[25,1,""],T12:[25,1,""],T13:[25,1,""],T14:[25,1,""],T15:[25,1,""],T16:[25,1,""],T17:[25,1,""],T18:[25,1,""],T19:[25,1,""],T20:[0],T2A:[1,1,1],T2B:[1,1,1],T21:[25,1,""],T22:[25,1,""],T23:[25,1,""],T24:[25,1,""],T25:[25,1,""],T26:[25,1,""],T27:[25,1,""],T28:[25,1,""],T29:[25,1,""],T30:[0],T3A:[1,1,1],T3B:[1,1,1],T31:[25,1,""],T32:[25,1,""],T33:[25,1,""],T34:[25,1,""],T35:[25,1,""],T36:[25,1,""],T37:[25,1,""],T38:[25,1,""],T39:[25,1,""],T40:[0],T4A:[1,1,1],T4B:[1,1,1],T4C:[1,1,1],T41:[25,1,""],T42:[25,1,""],T43:[25,1,""],T44:[25,1,""],T45:[25,1,""],T46:[25,1,""],T47:[25,1,""],T48:[25,1,""],T49:[25,1,""],T50:[0],T5A:[1,1,1],T5B:[1,1,1],T5C:[1,1,1],T5D:[1,1,1],T51:[25,1,""],T52:[25,1,""],T53:[25,1,""],T54:[25,1,""],T55:[25,1,""],T56:[25,1,""],T57:[25,1,""],T58:[25,1,""],T59:[25,1,""],T60:[0],T61:[25,1,""],T62:[25,1,""],T63:[25,1,""],T64:[25,1,""],T65:[25,1,""],T66:[25,1,""],T67:[25,1,""],T68:[25,1,""],T69:[25,1,""],T70:[0],T7A:[1,1,1],T7B:[1,1,1],T71:[25,1,"OGotcha|https://ogotcha.universeview.be/"],T72:[25,1,""],T73:[25,1,""],T74:[25,1,""],T75:[25,1,""],T76:[25,1,""],T77:[25,1,""],T78:[25,1,""],T79:[25,1,""],T80:[0],T81:[25,1,"Tools for Ogame|www.toolsforogame.com/"],T82:[25,1,"oRaiders|http://www.oraiders.com/"],T83:[25,1,"o-calc|o-calc.com/"],T84:[25,1,"Online tools|proxyforgame.com/"],T85:[25,1,"Project AlTernative|www.projet-alternative.fr/"],T86:[25,1,"o-tools|www.ghiroblu.com/o-tools/"],T87:[25,1,""],T88:[25,1,""],T89:[25,1,""],T90:[0],T9A:[1,1,1],T9B:[1,1,1],T91:[25,1,""],T92:[25,1,""],T93:[25,1,""],T94:[25,1,""],T95:[25,1,""],T96:[25,1,""],T97:[25,1,""],T98:[25,1,""],T99:[25,1,""],F00:[1,1,1],F01:[1,3,0],F02:[2,1,3],F03:[1,1,1,0,1,1],F05:[0],F06:[0],F07:[0],F08:[0],F09:[0],F13:[1,2,1],F14:[1,2,0],F15:[1,2,0],F16:[1,2,1,0,1,1],F18:[1,2,1],F19:[2,1,0],F21:[0],F22:[0],F23:[0],F24:[0],F26:[0],F28:[0],F31:[-1,1,""],F37:[0],F38:[0],F39:[0],F40:[0],F41:[-1,1,""],F42:[-1,1,""],F43:[-1,1,""],F44:[-1,1,""],F45:[-1,1,""],F46:[-1,1,""],F47:[-1,1,""],F48:[-1,1,""],F49:[-1,1,""],F50:[0],F51:[1,1,1],F52:[1,1,1],F53:[1,1,1],F54:[1,1,0],F60:[0],F62:[2,2,1],F63:[6,2,""],F65:[0],F67:[0],F70:[2,1,3],F71:[-1,1,""],F73:[1,1,1],F80:[2,1,3],F81:[-1,1,""],F90:[2,1,3],F91:[-1,1,""],FH0:[2,1,3],FA0:[2,1,3],FA1:[2,2,0],FA2:[2,1,0],FA3:[2,1,0],FA4:[2,1,10],FL0:[2,1,3],FL2:[2,1,0],E00:[0],E01:[0],E02:[0],E10:[1,1,1],E11:[1,1,1],E12:[1,1,0],E13:[1,1,0],E14:[1,1,1],E17:[0],E18:[0],E20:[1,1,1],E21:[1,1,1],E22:[1,1,0],E23:[2,2,1],E28:[0],E30:[1,1,1],E31:[1,1,1],E32:[1,1,0],E34:[1,1,0],E41:[2,1,3],E42:[2,1,3],E43:[2,1,3],E44:[2,1,3],E45:[2,1,3],E46:[2,1,3],E47:[2,1,3],E48:[2,1,3],E49:[2,1,3],E70:[0],E71:[0],E72:[0],E73:[0],E74:[0],E75:[0],E76:[0],E77:[0],E78:[0],G00:[0],G20:[1,1,1],G21:[1,1,1],G30:[1,1,1],G31:[1,1,1],G32:[1,1,0],G33:[1,1,1],G34:[1,2,0],G35:[1,2,0],G38:[-1,1,""],G40:[1,1,1],G41:[1,1,1],G42:[2,1,0],G43:[1,1,1],G44:[1,1,1],G45:[2,1,3],G46:[0],G47:[0],G48:[0],G51:[1,1,0,0,0,1],G52:[1,2,1],G58:[1,1,0],M04:[1,1,1],M05:[2,1,8],M06:[2,1,1e4],M10:[0],M12:[1,1,1],M14:[1,1,1],M16:[1,1,0],M20:[1,1,1],M22:[0],M24:[0],M28:[2,1,4],M30:[1,1,0],M31:[0],M32:[0],M33:[0],M34:[0],M35:[0],M36:[2,1,10],M37:[2,1,20],M51:[1,2,1],M52:[1,2,1],M53:[1,2,0],M54:[1,2,0],M70:[0],M74:[1,1,1],M80:[0],M81:[0],M82:[0],M83:[0],M84:[0],M85:[0],M86:[0],M87:[0],M88:[6,1,""],M89:[6,1,""],M90:[6,1,""],M91:[0],M92:[0],S21:[0],S24:[1,1,1,0,1,1],S25:[0],S26:[0],S27:[0],S29:[2,1,0],S2B:[0],S40:[0],S41:[0],S44:[1,1,0],S45:[1,1,0],S46:[1,1,0],S48:[1,1,0],S50:[0],S51:[0],S52:[0],S53:[0],S55:[0],S57:[0],S58:[0],S63:[0],S64:[0],S65:[0],S66:[0],S68:[0],S71:[0],S72:[0],S73:[0],S77:[0],S78:[0],S80:[0],S81:[0],S82:[0],S83:[0],S84:[0],S85:[0],B09:[2,1,2],X01:[0],X02:[0],X03:[0]},n.a.Manager={Start:function(){n.a.status=1,n.a.Config.pathSkin=chrome.extension.getURL("/skin/"),n.a.Config.id=chrome.runtime.id,n.a.Config.version=chrome.runtime.getManifest().version,n.a.Config.name=c.check(chrome.runtime.getManifest().name),n.a.Config.beta=-1<n.a.Config.name.indexOf("Alpha")?2:-1<n.a.Config.name.indexOf("Beta")?1:0,n.a.DataBase?n.a.DataBase.Start(window):n.a.DataBase={},n.a.Storage.Start(function(){var e;e=1<n.a.Config.beta?"  - Development mode":"",e+=n.a.Storage.status?"  Storage Quota: local "+chrome.storage.local.QUOTA_BYTES+"  sync "+chrome.storage.local.QUOTA_BYTES:"  Something wrong with chrome.storage",n.a.Core.Log("Start  Storage: "+n.a.Storage.status+"  DataBase: "+n.a.DataBase.status+(e||""),!0)})},Check:function(e,a,t){if(s.is(t)&&s.is(a)&&"loading"===a.status){var r=n.a.App.Check(t.url);s.is(r)&&r.mode&&n.a.Manager.Load(r,e)}},Load:function(e,a){1===e.mode&&chrome.tabs.executeScript(a,{file:"js/coordinates.js",runAt:"document_start"})},loadScripts:function(e,a){if(s.is(e)&&a)for(var t=0;t<e.length;t++)e[t]&&chrome.tabs.executeScript(a,{file:"js/"+e[t]+".js",runAt:"document_start"})},message:function(e,a,t,r){var i=n.a.App.getPlayer(e);i&&chrome.tabs.query({url:"*://*.ogame.gameforge.com/*"},function(e){for(var n=0;n<e.length;n++)e[n]&&e[n].id&&chrome.tabs.sendMessage(e[n].id,{player:i,page:a,role:t,data:r})})}},chrome.tabs.onUpdated.addListener(n.a.Manager.Check),chrome.runtime.onMessage.addListener(function(e,a,t){if(t="function"==typeof t?t:null,(a="object"===i(a)&&a.tab?a.tab.id:"")&&"object"===i(e)&&("Log"===e.page?window.console.log("AntiGameReborn:  "+e.para):"Storage"===e.page?"Set"===e.role?n.a.Storage.Set(e.para):"Get"===e.role?n.a.Storage.Get(e.para,t):"Remove"===e.role?n.a.Storage.Remove(e.para):"RemoveFilter"===e.role&&n.a.Storage.RemoveFilter(e.para,t):"Update"===e.page&&"Check"===e.role?chrome.runtime.requestUpdateCheck(function(a){n.a.Manager.message(e.para,"Menu","Install",a)}):e.page&&s.is(n.a[e.page])&&"function"==typeof n.a[e.page].Messages&&n.a[e.page].Messages(e.role,e.para,t,a),t))return!0}),n.a.Storage={status:0,Start:function(e){var a;n.a.Storage.status=0,chrome.storage&&chrome.storage.local?(a=Math.floor(Date.now()/1e3),chrome.storage.local.set({App_Start:a},function(){chrome.storage.local.get(["App_Start"],function(t){n.a.Storage.status=s.is(t)&&+t.App_Start===a?1:0,e()})})):e()},Set:function(e,a){var t,n;s.is(e)&&(t=e.sync?"sync":"local",e.key?(n={})[e.key]=e.data:(n=e.data,s.is(n)&&Object.keys(n).length&&(a?chrome.storage[t].set(n,function(){a(chrome.runtime.lastError?-1:1)}):chrome.storage[t].set(n))))},Get:function(e,a){var t;a&&(s.is(e)&&e.key?(t=e.sync?"sync":"local",s.is(e.key)?chrome.storage[t].get(Object.keys(e.key),a):chrome.storage[t].get(e.key,function(t){a(s.is(t)&&t[e.key]||"")})):a(""))},Remove:function(e){var a;s.is(e)&&e.key&&(a=e.sync?"sync":"local",n.a.Core.Log("Delete - storage  - "+e.key,!0),chrome.storage[a].remove(e.key))},List:function(e){s.is(e)&&(chrome.storage.local.get(null,function(a){s.iterate(a,function(a){e.filter&&0!==c.check(a).indexOf(e.filter)||n.a.Core.Log("List - storage  - "+a,!0)})}),chrome.storage.sync.get(null,function(a){s.iterate(a,function(a){e.filter&&0!==c.check(a).indexOf(e.filter)||n.a.Core.Log("List - sync  - "+a,!0)})}))},RemoveFilter:function(e){s.is(e)&&(chrome.storage.local.get(null,function(a){s.iterate(a,function(a){e.filter&&0!==c.check(a).indexOf(e.filter)||(n.a.Core.Log("Delete - storage  - "+a,!0),chrome.storage.local.remove(a))})}),chrome.storage.sync.get(null,function(a){s.iterate(a,function(a){e.filter&&0!==c.check(a).indexOf(e.filter)||(n.a.Core.Log("Delete - sync  - "+a,!0),chrome.storage.sync.remove(a))})}))},Sync:function(e){}},n.a.Config={id:"",beta:0,version:"",pathSkin:""},n.a.Core={Log:function(e,a){if(n.a.Config.beta||a){var t=new Date,r=c.trimZero(t.getHours(),2),i=c.trimZero(t.getMinutes(),2),o=c.trimZero(t.getSeconds(),2);window.console.log("AntiGameRebornX:  ".concat(r,":").concat(i,":").concat(o,"  ").concat(e))}},setTimeout:function(e,a){return window.setTimeout(e,a)},clearTimeout:function(e){e&&(window.clearTimeout(e),e=null)},resourceFile:function(e){var a;if(e)try{return(a=new XMLHttpRequest).open("GET",chrome.extension.getURL(e),!1),a.overrideMimeType("text/plain"),a.send(null),a.responseText||""}catch(e){return""}return""}},window.setTimeout(function(){n.a.Manager&&n.a.Manager.Start()},1e3)}])});