!function(e,t){for(var a in t)e[a]=t[a]}(window,function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=6)}({6:function(e,t,a){"use strict";a.r(t);var n={};function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.App={Data:{},Player:{},Page:{overview:{page:"Overview",js:["pages"],css:"pages"},resources:{page:"Resources",js:["pages"],css:"pages"},resourcesettings:{page:"ResourcesSettings",js:["pages"],css:"pages"},station:{page:"Station",js:["pages"],css:"pages"},traderoverview:{page:"Trader",js:["pages"],css:"pages"},research:{page:"Research",js:["pages"],css:"pages"},techtree:{page:"Techtree",js:["pages"],css:"pages"},shipyard:{page:"Shipyard",js:["pages"],css:"pages"},defense:{page:"Defense",js:["pages"],css:"pages"},fleet1:{page:"Fleet1",js:["fleet1"],css:"pages_fleet1"},fleet2:{page:"Fleet2",js:["fleet2"],css:"pages_fleet2"},fleet3:{page:"Fleet3",js:["fleet3"],css:"pages_fleet3"},movement:{page:"Movement",js:["movement"],css:"pages_movement"},galaxy:{page:"Galaxy",js:["jquery","messages","galaxy"],css:"pages_galaxy"},empire:{page:"Empire",js:["jquery","empire"],css:"pages_empire"},alliance:{page:"Alliance",js:["pages"],css:"pages"},messages:{page:"Messages",js:["jquery","messages"],css:"pages_messages"},websim:{page:"Websim",js:["simulators"],css:""},osimulate:{page:"Osimulate",js:["simulators"],css:""}},Extern:{"speedsim.net":2,"osimulate.com":2,"gamestats.org":1,"ogametools.com":1,"oraiders.com":1,"ghiroblu.com":1,"projet-alternative.fr":1,"galaxy.ddns.us":1,"logserver.net":1,"war-riders.de":1,"kb.un1matr1x.de":1,"savekb.de":1,"drago-sim.com":1,"ogniter.org":1,"infuza.com":1,"savecr.com":1},Messages:function(e,t,a,r){"Start"===e?n.App.Start(t,a,r):"Update"===e?n.App.Update(t,a):"Refresh"===e?n.App.Refresh(t,a):"Script"===e&&s.is(t)&&n.Manager.loadScripts(t.scripts,r)},Check:function(e){var t,a;return e=c.check(e).toLowerCase(),a=(e.split("//")[1]||"").split("/")[0]||"",e?(t={href:e,host:a},e.match(/https:\/\/.+\.ogame.gameforge.com\/game\/index\.php\?+.*page=*/i)?t.mode=3:s.iterate(n.App.Extern,function(e){(a===e||-1<a.indexOf("."+e))&&(t.mode=n.App.Extern[e])}),t):null},Start:function(e,t,a){var r;s.is(e)&&e.page&&t&&(n.Manager.loadScripts(s.get(n.App.Page[e.page],"js")||["pages"],a),2===e.mode?t({Page:s.get(n.App.Page[e.page],"page")||"Page",Label:n.Label.Data[e.abbrCom],Background:n.Background.Data}):3<=e.mode&&e.accountId&&e.keyCom&&e.keyUni&&e.keyPlayer&&n.Com.Check(e.abbrCom)&&e.abbrUni&&e.urlUni&&(r=e.keyPlayer,s.is(n.App.Player[e.keyUni])||(n.App.Player[e.keyUni]={abbrUni:e.abbrUni,urlUni:e.urlUni}),n.App.Player[e.keyUni].keyPlayer=r,s.is(n.App.Player[r])||(n.App.Player[r]={accountId:e.accountId,abbrCom:e.abbrCom,abbrUni:e.abbrUni,keyCom:e.keyCom,keyUni:e.keyUni,urlUni:e.urlUni}),e.reload=e.reload||1!==n.App.Player[r].status,n.App.Player[r].status=1,n.Core.clearTimeout(n.App.Player[r].timeout),n.App.Player[r].timeout=n.Core.setTimeout(function(){n.status&&n.App.Stop(r)},5e3),n.Data.Init(e,function(a){t({Page:s.get(n.App.Page[e.page],"page")||"Page",reload:e.reload||a,keyPlayer:r,Option:n.Option.Data[r],DataBase:n.DataBase.Status(e),Label:n.Label.Data[r],Item:n.Item.Data[r],App:n.App.Data[r],Uni:n.Uni.Data[r],Panel:n.Panel.Data[r],Box:n.Box.Data[r],Token:"galaxy"===e.page?n.Token.Data[r]:n.Token.Data[r].Info,Units:n.Units.Start(r),Fleet:n.Fleet.Data[r],Background:n.Background.Data})})))},Stop:function(e){},Update:function(e,t){var a=n.App.getPlayer(e,"copy");a&&(e.reload||2e3<n.Time.timestamp()-(+n.App.Player[a].timestampUpdate||0))&&(n.App.Player[a].timestampUpdate=n.Time.timestamp(),n.Uni.Load(e),n.Label.Load(e),n.DataBase.Init(e),t&&t())},Refresh:function(e,t){var a=n.App.getPlayer(e);a&&t&&t({Option:n.Option.Data[a],Panel:n.Panel.Data[a],Box:n.Box.Data[a],Fleet:n.Fleet.Data[a],Background:n.Background.Data})},Init:function(e,t){var a,r,i;r=n.App.getPlayer(e,"copy"),i=n.Data.get("App","Data","version"),r&&(a=s.parse(t[n.Data.getKey(r,"App","Data")]),n.App.Data[r]=a.version===i?a:{version:i},n.App.Data[r].storage=n.Storage.status)},Load:function(e){var t,a;(t=n.App.getPlayer(e,"copy"))&&((a=new XMLHttpRequest).open("POST","https://###########/ago_appdata.php",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onerror=a.onload=function(){var t,r,i;r=n.App.getPlayer(e),t=n.App.Data[r],r&&t&&(t.storage=n.Storage.status,(i=s.parse(200==+a.status?a.responseText:"")).versionFinal&&(t.versionLoca=i.versionLoca,t.versionLocaMenu=i.versionLocaMenu,t.versionUpdate=1<n.Config.beta?"":1===n.Config.beta?i.versionPreview:i.versionFinal,n.App.Save({player:r})),n.Core.Log("Update   - App      : "+t.versionUpdate+"https://##################/ago_appdata.php"+(i.versionFinal?"":" - failed !"),!0))},a.send("domain=antigame.de&loca="+e.abbrCom+"&locamenu="+(n.Option.Get(t,"A10")||e.abbrCom)))},Save:function(e){e=n.App.getPlayer(e),n.Data.isStorage(e,"App","Data")&&s.is(n.App.Data[e])&&n.Data.setStorage(e,"App","Data",n.App.Data[e])},Get:function(e,t,a){var r;return e&&n.App.Data[e]&&t&&(r=n.App.Data[e][t]),6===a?c.check(r):+r||0},Set:function(e,t,a){e&&n.App.Data[e]&&t&&n.App.Data[e][t]!==a&&(n.App.Data[e][t]=a,n.App.Save({player:e}))},getUni:function(e){return n.status&&e&&e.keyUni&&n.App.Player[e.keyUni]?(e.keyPlayer=n.App.Player[e.keyUni].keyPlayer,e.abbrUni=n.App.Player[e.keyUni].abbrUni,e.urlUni=n.App.Player[e.keyUni].urlUni,e.keyUni):""},getPlayer:function(e,t){return n.status&&e&&e.keyPlayer&&n.App.Player[e.keyPlayer]&&1===n.App.Player[e.keyPlayer].status?(t&&(e.accountId=n.App.Player[e.keyPlayer].accountId,e.abbrCom=n.App.Player[e.keyPlayer].abbrCom,e.abbrUni=n.App.Player[e.keyPlayer].abbrUni,e.keyCom=n.App.Player[e.keyPlayer].keyCom,e.keyUni=n.App.Player[e.keyPlayer].keyUni,e.urlUni=n.App.Player[e.keyPlayer].urlUni),e.keyPlayer):""}},n.Background={Data:{},Messages:function(e,t){"Set"===e&&n.Background.Set(t)},Set:function(e){s.is(e)&&e.key&&(n.Background.Data[e.key]=e.value||"")}},n.Data={Status:{},Info:{App:{Data:{storage:1,version:3,tab:2}},Uni:{Data:{storage:1,version:3,tab:2}},Option:{Data:{storage:4,version:12,upgrade:1},Local:{storage:1}},Label:{Loca:{storage:1,version:1,key:0},Api:{storage:1,version:1,key:2}},Units:{Data:{storage:2,version:2}},Fleet:{Data:{storage:2,version:2},Routine:{tab:2},Expo:{tab:2},Last:{tab:3},Cooldown:{tab:2}},Token:{Alliance:{storage:3,version:3,tab:2},Player:{storage:3,version:3,tab:2},Target:{storage:3,version:3,tab:2},Current:{storage:3,version:3,tab:2},Info:{tab:1}},Panel:{Data:{storage:2,version:1},Settings:{tab:2,label:"I10"},Account:{tab:2,label:"I20"},Flights:{tab:2,label:"I40"},Construction:{tab:2,label:"I30"},Alliance:{tab:2,label:"I60"},Player:{tab:2,label:"I70"},Target:{tab:2,label:"I80"},Tools:{tab:2,label:"I90"},Box:{tab:2},Cache:{tab:1}},Box:{Cache:{tab:1}},Construction:{Data:{storage:2,version:1}}},Messages:function(e,t,a){"Backup"===e?n.Data.Backup(t,a):"Restore"===e?n.Data.Restore(t,a):"Remove"===e?n.Data.Remove(t,a):"List"===e&&n.Data.List(t)},Init:function(e,t){var a,r;(a=n.App.getPlayer(e))&&(!n.Data.Status[a]||e.reload&&1===n.Data.Status[a])?(n.Data.Status[a]=3,r={},s.iterate(n.Data.Info,function(t){s.iterate(n.Data.Info[t],function(i){var o;1<=n.Data.Info[t][i].storage&&(o=2===n.Data.Info[t][i].key?e.keyCom:1===n.Data.Info[t][i].key?e.keyUni:a,r[n.Data.getKey(o,t,i)]=i)})}),n.Storage.Get({key:r},function(r){r=s.is(r)?r:{},n.App.Init(e,r),n.Uni.Init(e,r),n.Option.Init(e,r),n.Label.Init(e,r),n.Units.Init(e,r),n.Fleet.Init(e,r),n.Token.Init(e,r),n.Panel.Init(e,r),n.Box.Init(e,r),n.Construction.Init(e,r),n.Item.Init(e),n.Data.Status[a]=1,t&&t(!0)})):t&&t(!1)},Change:function(){n.Core.clearTimeout(n.Data.changeTimeout),n.Data.changeTimeout=n.Core.setTimeout(function(){n.status&&n.Data.Save()},3e3)},Save:function(e,t){function a(e){var a;n.Data.isStatus(e)&&(a={keyPlayer:e,save:{}},t&&(a.backup={}),s.iterate(n.Data.Info,function(e){n[e]&&"function"==typeof n[e].Save&&"App"!==e&&n[e].Save(a)}),t?n.Storage.Set({data:a.save},function(){t(a.backup)}):n.Storage.Set({data:a.save}))}n.App.getPlayer(e)?a(e.keyPlayer):s.iterate(n.Data.Status,a)},Sync:function(e){var t,a,r;t=n.App.getPlayer(e),n.Data.isStatus(t)&&(r=Boolean(n.Option.Get(t,"D60")&&3===n.Option.Get(t,"D61")),(a={})[t+"_SYNC_Sync_Data"]=r,n.Data.iterate("",function(e,i){2<=n.Data.get(e,i,"storage")&&(a[t+"_SYNC_"+e+"_"+i]=r)}),n.Storage.Sync({sync:!0,mode:r,key:a}))},Backup:function(e,t){var a,r,i,o;a=n.App.getPlayer(e,"copy"),n.Data.isStatus(a)&&(r=e.tab,(o=s.create(e)).timestamp=n.Time.timestamp(),o.list={},o.data={},o.timestampLocal=n.App.Get(a,"timestampSync"),o.data.Sync_Data={com:e.abbrCom,uni:e.abbrUni,player:e.accountId,timestamp:o.timestamp},i=3===r?4e3:2===r?1e4:3e5,n.Data.Save(e,function(e){s.iterate(e,function(t){var a;a=s.parse(e[t]),c.check(e[t]).length>i?(o.data[t]={version:0},o.data.Sync_Data[t]=1,o.list[t]=-1):(o.data[t]=a.version?a:{version:1},o.data.Sync_Data[t]=c.hash(JSON.stringify(o.data[t])),o.list[t]=1)}),1===r?t&&t(o):2===r?function(e,t){var a,r;r="com="+e.abbrCom+"&uni="+e.abbrUni+"&user_id="+e.accountId+"&ident="+e.ident+"&type=Sync&action=put&domain=antigame.de&string="+encodeURIComponent(JSON.stringify(e.data))+"&header="+encodeURIComponent(JSON.stringify(e.data.Sync_Data)),(a=new XMLHttpRequest).open("POST","https://antigame.de/antigame/usave/ago_sync.php",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onerror=a.onload=function(){t&&(e.status=200==+a.status&&7<=+a.responseText?1:-1,e.error=-1===e.status,e.data=null,e.error||n.App.Set(e.keyPlayer,"timestampSync",e.timestamp),t(e))},a.send(r)}(o,t):3===r&&function(e,t){var a={};s.iterate(e.data,function(t){a[e.keyPlayer+"_SYNC_"+t]=JSON.stringify(e.data[t])}),n.Storage.Set({sync:!0,data:a},function(a){t&&(e.status=a,e.error=-1===a,e.data=null,e.error||n.App.Set(e.keyPlayer,"timestampSync",e.timestamp),t(e))})}(o,t)}))},Restore:function(e,t){function a(a,r){var o;o={tab:e.tab,list:{}},s.is(a)&&!a.error?(o.universal=r=1===e.tab&&r,o.timestampLocal=n.App.Get(i,"timestampSync"),o.timestamp=+a.timestamp||0,o.com=a.com===e.abbrCom?1:a.com&&!r?-1:0,o.uni=a.uni===e.abbrUni?1:a.uni&&!r?-1:0,o.player=+a.player==+e.accountId?1:a.player&&!r?-1:0,o.status=o.timestamp?o.timestamp===o.timestampLocal?1:o.timestamp>o.timestampLocal?4:3:-1,1===e.tab?(-1===o.com&&(e.type=Math.max(e.type,3)),-1===o.uni&&(e.type=Math.max(e.type,4)),-1===o.player&&(e.type=9)):1===o.com&&1===o.uni&&1===o.player||(e.type=0),2<=e.type?n.Data.Save(e,function(r){n.Data.iterate("",function(t,i){var s;n.Data.get(t,i,"storage")>=e.type&&(s=t+"_"+i,o.list[s]=a[s]?1===a[s]?-1:a[s]===c.hash(r[s])?1:2:0)}),t&&t(o)}):(o.status=-1,t&&t(o))):(o.status=-1,t&&t(o))}function r(a,r){var o,c;c={tab:e.tab,list:{},data:{}},s.is(a)&&!a.error&&s.is(a.Sync_Data)?(o=a.Sync_Data,c.universal=r=1===e.tab&&r,c.timestamp=+o.timestamp||0,c.com=o.com===e.abbrCom?1:o.com&&!r?-1:0,c.uni=o.uni===e.abbrUni?1:o.uni&&!r?-1:0,c.player=+o.player==+e.accountId?1:o.player&&!r?-1:0,1===e.tab?(-1===c.com&&(e.type=Math.max(e.type,3)),-1===c.uni&&(e.type=Math.max(e.type,4)),-1===c.player&&(e.type=9)):1===c.com&&1===c.uni&&1===c.player||(e.type=9),n.Data.iterate("",function(t,r){var o;o=t+"_"+r,n.Data.get(t,r,"storage")>=e.type&&1<=+s.get(a[o],"version")&&(c.list[o]=1,c.data[i+"_"+o]=JSON.stringify(a[o]))}),Object.keys(c.data).length?n.Storage.Set({data:c.data},function(e){1===e&&n.App.Set(i,"timestampSync",+c.timestamp||n.Time.timestamp()),n.Data.Status[i]=0,c.status=e,c.data=null,t&&t(c)}):(c.status=0,c.data=null,t&&t(c))):(c.status=-1,t&&t(c))}var i,o,u;i=n.App.getPlayer(e,"copy"),n.Data.isStatus(i)&&(1===e.tab?"restore"===e.action?r(s.parse(e.value),e.universal):a(s.parse(e.value).Sync_Data,e.universal):2===e.tab?(u="com="+e.abbrCom+"&uni="+e.abbrUni+"&user_id="+e.accountId+"&ident="+e.ident+"&type=Sync&action="+("restore"===e.action?"get":"header")+"&domain=antigame.de",(o=new XMLHttpRequest).open("POST","https://antigame.de/antigame/usave/ago_sync.php",!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onerror=o.onload=function(){var t;t=200==+o.status&&o.responseText?s.parse(o.responseText):{error:!0},"restore"===e.action?r(t):a(t)},o.send(u)):3===e.tab&&((u={})[i+"_SYNC_Sync_Data"]="Sync_Data",n.Data.iterate("",function(e,t){2<=n.Data.get(e,t,"storage")&&(u[i+"_SYNC_"+e+"_"+t]=e+"_"+t)}),n.Storage.Get({sync:!0,key:u},function(t){var n={};s.iterate(t,function(e){var a=c.check(e).split("_SYNC_")[1];a&&(n[a]=s.parse(t[e]))}),"restore"===e.action?r(n):a(n.Sync_Data)})))},List:function(e){s.is(e)&&n.Storage.List(e)},Remove:function(e,t){var a,r,i,s;a=n.App.getPlayer(e,"copy"),n.Data.isStatus(a)&&(r=e.mode,s=(i=o.check(r,"acc","ago"))||!1,(i||"Account"===r)&&(s=!0,n.Data.removeStorageGroup(e,"App"),n.Data.removeStorageGroup(e,"Label"),n.Data.removeStorageGroup(e,"Units"),n.Data.removeStorageGroup(e,"Fleet"),n.Data.removeStorageGroup(e,"Messages")),(i||"Token"===r)&&(s=!0,n.Data.removeStorageGroup(e,"Token")),(i||"Panel"===r)&&(s=!0,n.Data.removeStorageGroup(e,"Panel"),n.Data.removeStorageGroup(e,"Construction")),(i||"Option"===r)&&(s=!0,n.Data.removeStorageGroup(e,"Option")),(i||"DataBase"===r)&&n.DataBase.Remove(e),"acc"===r&&n.Storage.RemoveFilter({filter:a}),"ago"===r&&n.Storage.RemoveFilter({filter:""}),s&&(n.Data.Status[a]=0)),t&&t(s)},removeStorageGroup:function(e,t){s.is(e)&&n.Data.Info[t]&&n.Data.iterate(t,function(a,r){var i;1<=a.storage&&(i=2===a.key?e.keyCom:1===a.key?e.keyUni:e.keyPlayer,n.Storage.Remove({key:n.Data.getKey(i,t,r)}))})},setStorage:function(e,t,a,r){e&&(r=s.is(r)?JSON.stringify(r):r||"",n.Storage.Set({key:n.Data.getKey(e,t,a),data:r}))},iterate:function(e,t){var a;if(n.Data.Info[e])for(a in n.Data.Info[e])n.Data.Info[e].hasOwnProperty(a)&&t(n.Data.Info[e][a],a);else if(!e)for(e in n.Data.Info)if(n.Data.Info.hasOwnProperty(e))for(a in n.Data.Info[e])n.Data.Info[e].hasOwnProperty(a)&&t(e,a)},getKey:function(e,t,a){return n.Data.Info[t]&&n.Data.Info[t][a]?e+"_"+t+"_"+a:""},get:function(e,t,a,r){return n.Data.Info[e]&&n.Data.Info[e][t]?6===r?c.check(n.Data.Info[e][t][a]||""):+n.Data.Info[e][t][a]||0:6===r?"":0},getTab:function(e,t){return e&&e.tab&&n.Data.Info[t]&&n.Data.Info[t][e.tab]&&n.Data.Info[t][e.tab].tab?e.tab:""},set:function(e,t,a,r){n.Data.Info[e]&&n.Data.Info[e][t]&&(n.Data.Info[e][t][a]=+r||0)},isStorage:function(e,t,a){return e&&n.Data.Status[e]&&t&&n.Data.Info[t]&&n.Data.Info[t][a]?n.Data.Info[t][a].storage:0},isBackup:function(e,t,a,r){return Boolean(e&&n.Data.Status[e]&&t&&n.Data.Info[t]&&n.Data.Info[t][a]&&n.Data.Info[t][a].storage>=r)},isStatus:function(e){return e&&1===n.Data.Status[e]}},n.Com={Data:{AE:{infuzaServer:"ae.ogame.org",websim:"en",osimulate:"ae",dragosim:"english",warriders:"",infuza:"fr",ogniter:"en",trashsim:"en"},AR:{infuzaServer:"ogame.com.ar",websim:"sp",osimulate:"ar",dragosim:"spanish",warriders:"",infuza:"es",ogniter:"ar",trashsim:"es"},BA:{infuzaServer:"ba.ogame.org",websim:"ba",osimulate:"hr",dragosim:"bosnian",warriders:"",infuza:"en",ogniter:"yu",trashsim:"hr"},BR:{infuzaServer:"ogame.com.br",websim:"pt",osimulate:"br",dragosim:"brazilian",warriders:"",infuza:"pt",ogniter:"br",trashsim:"pt-BR"},CZ:{infuzaServer:"ogame.cz",websim:"cz",osimulate:"cz",dragosim:"czech",warriders:"",infuza:"cs",ogniter:"cz",trashsim:"cs"},DE:{infuzaServer:"ogame.de",websim:"de",osimulate:"de",dragosim:"german",warriders:"de",infuza:"de",ogniter:"de",trashsim:"de"},DK:{infuzaServer:"ogame.dk",websim:"dk",osimulate:"dk",dragosim:"danish",warriders:"",infuza:"da",ogniter:"dk",trashsim:"da"},EN:{infuzaServer:"ogame.org",websim:"en",osimulate:"en",dragosim:"english",warriders:"org",infuza:"en",ogniter:"en",trashsim:"en"},ES:{infuzaServer:"ogame.com.es",websim:"sp",osimulate:"es",dragosim:"spanish",warriders:"es",infuza:"es",ogniter:"es",trashsim:"es"},FI:{infuzaServer:"fi.ogame.org",websim:"fi",osimulate:"fi",dragosim:"english",warriders:"",infuza:"en",ogniter:"fi",trashsim:"sv"},FR:{infuzaServer:"ogame.fr",websim:"fr",osimulate:"fr",dragosim:"french",warriders:"fr",infuza:"fr",ogniter:"fr",trashsim:"fr"},GR:{infuzaServer:"ogame.gr",websim:"gr",osimulate:"gr",dragosim:"greek",warriders:"",infuza:"en",ogniter:"gr",trashsim:"el"},HR:{infuzaServer:"ogame.com.hr",websim:"ba",osimulate:"hr",dragosim:"english",warriders:"",infuza:"en",ogniter:"hr",trashsim:"hr"},HU:{infuzaServer:"ogame.hu",websim:"hu",osimulate:"hu",dragosim:"hungarian",warriders:"",infuza:"hu",ogniter:"hu",trashsim:"hu"},IT:{infuzaServer:"ogame.it",websim:"it",osimulate:"it",dragosim:"italian",warriders:"",infuza:"it",ogniter:"it",trashsim:"it"},JP:{infuzaServer:"ogame.jp",websim:"ja",osimulate:"jp",dragosim:"english",warriders:"",infuza:"en",ogniter:"jp",trashsim:"en"},MX:{infuzaServer:"mx.ogame.org",websim:"sp",osimulate:"mx",dragosim:"spanish",warriders:"",infuza:"es",ogniter:"mx",trashsim:"es"},NL:{infuzaServer:"ogame.nl",websim:"nl",osimulate:"nl",dragosim:"dutch",warriders:"",infuza:"nl",ogniter:"nl",trashsim:"nl"},NO:{infuzaServer:"ogame.no",websim:"no",osimulate:"no",dragosim:"english",warriders:"",infuza:"en",ogniter:"no",trashsim:"en"},PL:{infuzaServer:"ogame.pl",websim:"pl",osimulate:"pl",dragosim:"polish",warriders:"pl",infuza:"pl",ogniter:"pl",trashsim:"pl"},PT:{infuzaServer:"ogame.com.pt",websim:"pt",osimulate:"pt",dragosim:"portuguese",warriders:"",infuza:"pt",ogniter:"pt",trashsim:"pt"},RO:{infuzaServer:"ogame.ro",websim:"ro",osimulate:"ro",dragosim:"romanian",warriders:"",infuza:"ro",ogniter:"ro",trashsim:"ro"},RU:{infuzaServer:"ogame.ru",websim:"ru",osimulate:"ru",dragosim:"russian",warriders:"",infuza:"ru",ogniter:"ru",trashsim:"ru"},SE:{infuzaServer:"ogame.se",websim:"sv",osimulate:"se",dragosim:"swedish",warriders:"",infuza:"sv",ogniter:"se",trashsim:"sv"},SI:{infuzaServer:"ogame.si",websim:"si",osimulate:"si",dragosim:"english",warriders:"",infuza:"en",ogniter:"si",trashsim:"en"},SK:{infuzaServer:"ogame.sk",websim:"sk",osimulate:"sk",dragosim:"slovak",warriders:"",infuza:"en",ogniter:"sk",trashsim:"en"},TR:{infuzaServer:"tr.ogame.org",websim:"tr",osimulate:"tr",dragosim:"turkish",warriders:"",infuza:"en",ogniter:"tr",trashsim:"tr"},TW:{infuzaServer:"ogame.tw",websim:"tw",osimulate:"tw",dragosim:"taiwanese",warriders:"",infuza:"en",ogniter:"tw",trashsim:"zh"},US:{infuzaServer:"ogame.us",websim:"en",osimulate:"us",dragosim:"english",warriders:"us",infuza:"en",ogniter:"us",trashsim:"en"},ORIGIN:{infuzaServer:"pioneers.ogame.org",websim:"en",osimulate:"en",dragosim:"english",warriders:"",infuza:"en",ogniter:"en",trashsim:"en"}},Get:function(e,t){return e&&n.Com.Data[e]&&n.Com.Data[e][t]||""},Check:function(e){return e&&e in n.Com.Data}},n.Uni={Data:{},Info:{status:2,speed:1,speedFleet:1,galaxies:50,systems:499,positions:17,rapidFire:1,acs:1,defToTF:0,debrisFactor:.3,debrisFactorDef:.3,repairFactor:.7,newbieProtectionLimit:0,newbieProtectionHigh:0,topScore:0,donutGalaxy:0,donutSystem:0,probeCargo:0,globalDeuteriumSaveFactor:1,cargoHyperspaceTechMultiplier:2,name:""},Init:function(e,t){var a,r,i;i=n.Data.get("Uni","Data","version"),(r=n.App.getPlayer(e))&&(n.Uni.Data[r]=s.create(n.Uni.Info),n.Uni.Data[r].version=i,(a=s.parse(t[n.Data.getKey(r,"Uni","Data")])).version===i&&s.copy(a,n.Uni.Data[r]))},Save:function(e){e=n.App.getPlayer(e),n.Data.isStatus(e)&&s.is(n.Uni.Data[e])&&n.Data.setStorage(e,"Uni","Data",n.Uni.Data[e])},Load:function(e){var t;n.App.getPlayer(e,"copy")&&((t=new XMLHttpRequest).open("GET",e.urlUni+"/api/serverData.xml?nocache="+n.Time.timestamp(),!0),t.overrideMimeType("text/html"),t.setRequestHeader("Cache-Control","no-cache"),t.setRequestHeader("Pragma","no-cache"),t.onerror=t.onload=function(){var a,r,i;r=n.App.getPlayer(e),a=n.Uni.Data[r],r&&a&&(200==+t.status&&t.responseText&&s.iterate(n.Uni.Info,function(e){var r;2===(r=t.responseText.split("<"+e+">")).length&&(i=1,r=((r=(r[1]||"").split("<")[0])||"").trim(),a[e]="number"==typeof n.Uni.Info[e]?+r||0:r)}),1===i&&(a.status=1,n.Uni.Save(e)),n.Core.Log("Update   - Uni      : "+e.urlUni+"/api/serverData.xml"+(i=1,""),!0))},t.send(null))},Get:function(e,t,a){var r;return e&&n.Uni.Data[e]&&t&&(r=n.Uni.Data[e][t]),6===a?c.check(r):+r||0}},n.Time={timestamp:function(){return Math.floor(Date.now()/1e3)},timestampMinute:function(){return Math.floor((Date.now()-1381e9)/6e4)},timestampMinuteConvert:function(e){return 1e3<e?60*(+e||0)+1381e6:0}};var o={check:function(e){for(var t=1;t<arguments.length;t++)if(e===arguments[t])return!0;return!1}},s={is:function(e){return e&&"object"===i(e)},get:function(e,t){return e&&"object"===i(e)&&t in e?e[t]:""},iterate:function(e,t){if(e&&"object"===i(e))for(var a in e)e.hasOwnProperty(a)&&t(a)},iterateArray:function(e,t){Array.isArray(e)&&e.forEach(t)},create:function(e){var t={};if(e&&"object"===i(e))for(var a in e)"object"!==i(e[a])&&"function"!=typeof e[a]&&(t[a]=e[a]);return t},createKey:function(e,t){var a={};return e&&(a[e]=t),a},createFilter:function(e,t){var a={};if(e&&"object"===i(e))for(var n in e)e.hasOwnProperty(n)&&"object"!==i(e[n])&&(!t||n in t)&&(a[n]=e[n]);return a},copy:function(e,t){if(e&&"object"===i(e)&&t&&"object"===i(t))for(var a in e)"object"!==i(e[a])&&(t[a]=e[a])},parse:function(e){if(e&&"object"===i(e))return e;try{return JSON.parse(e||"{}")}catch(e){return{}}},parseCopy:function(e,t){var a;if(e&&t){try{a=e&&"object"===i(e)?e:JSON.parse(e||"{}")}catch(e){a=null}if(a)for(var n in a)"object"!==i(a[n])&&(t[n]=a[n])}},split:function(e){var t={};e=c.check(e).split(";");for(var a=0;a<e.length;a++){var n=(e[a]||"").split("=");n[0]&&(t[n[0]]=n[1]||"")}return t}},c={is:function(e){return Boolean(e&&"string"==typeof e)},check:function(e){return"string"==typeof e?e:"number"==typeof e&&e?e+"":""},trim:function(e){return"string"==typeof e?e.trim():"number"==typeof e&&e?e+"":""},trimZero:function(e,t){return(e="0000"+e).substr(-t)},getAttribute:function(e,t){return"string"==typeof e?((e.split(" "+t+'="')[1]||"").split('"')[0]||"").trim():""},addUrlPara:function(e,t){return t=encodeURI(c.check(t).trim()),e&&t?"&"+e+"="+t:""},hash:function(e){var t=0;if("string"==typeof e&&0<e.length)for(var a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return t}},u={minMax:function(e,t,a){return Math.max(Math.min(+e||0,a),t)},isMinMax:function(e,t,a){return+e>=t&&+e<=a},parseInt:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return"string"==typeof e?parseInt(e,10):"number"==typeof e?Math.floor(e):0}),parseIntFormat:function(e){return"string"==typeof e?+e.replace(/[^\d\-]/g,"")||0:"number"==typeof e?Math.floor(e):0},parseIntAbs:function(e){return"string"==typeof e?+e.replace(/[^\d]/g,"")||0:"number"==typeof e?Math.floor(Math.abs(e)):0}};n.Option={Data:{},Limit:{U11:[0,7],U62:[0,100],U65:[0,20],U66:[0,100],U67:[0,100],B21:[0,3],B35:[0,2],CM3:[0,100],I05:[1,100],CT2:[0,100],D04:[1,3],D61:[1,3],D71:[0,2],D81:[0,2],O03:[0,4],I02:[0,9],I85:[0,500],F02:[0,3],F70:[0,3],F80:[0,3],F90:[0,3],FA0:[0,3],FA1:[0,3],FH0:[0,3],FL0:[0,3],FL2:[0,6],E23:[1,2],E41:[0,8],E42:[0,8],E43:[0,8],E44:[0,8],E45:[0,8],E46:[0,8],E47:[0,8],E48:[0,8],E49:[0,8],G42:[0,3],G45:[0,3],M12:[0,4],M28:[1,9],M30:[0,5]},Messages:function(e,t,a){"Set"===e?n.Option.Set(t,a):"Menu"===e?n.Option.Menu(t,a):"Save"===e&&n.Option.MenuSave(t,a)},Init:function(e,t){var a,r,i,o,l,p;if(i=n.App.getPlayer(e)){if(n.Option.Data[i]={status:2},a=s.parse(s.get(t,n.Data.getKey(i,"Option","Data"))),r=s.parse(s.get(t,n.Data.getKey(i,"Option","Local"))),a.version){for(n.Option.Data[i].version=a.version,n.Option.Data[i].status=u.minMax(a.status,1,2),l=c.check(a.empty).split(","),p=0;p<l.length;p++)a[l[p]]="";for(l=c.check(a.one).split(","),p=0;p<l.length;p++)a[l[p]]=1;a.version===r.version&&s.parseCopy(r,a)}o=n.Option.get(a,"D04"),o=u.isMinMax(o,1,3)?o:u.minMax(n.Option.getDefault("D04",0),1,3),s.iterate(n.Para,function(e){n.Para[e][0]&&(n.Option.set(n.Option.Data[i],e,n.Option.getDefault(e,o)),e in a&&n.Option.set(n.Option.Data[i],e,a[e]))}),n.Option.Upgrade(n.Option.Data[i])}},Upgrade:function(e){var t;t=n.Data.get("Option","Data","version"),e.version&&12>e.version&&(n.Core.Log("Option - Upgrade version 12 ",!0),e.F01=0,e.F13=e.FH0=1,e.F70=2,e.FA0=3,e.F80=e.F90=e.FL0=4,e.F63=""),e.version!==t&&(e.version=t,e.changed=!0,n.Data.Change())},Save:function(e){var t,a,r,i,o,c;a=n.App.getPlayer(e),t=n.Option.Data[a],n.Data.isStatus(a)&&t&&(e.backup||t.changed)&&(delete t.changed,o=[],c=[],r={version:n.Data.get("Option","Data","version")},i={version:n.Data.get("Option","Data","version")},s.iterate(n.Para,function(e){n.Para[e][1]&&(t[e]?1===t[e]?c.push(e):r[e]=t[e]:o.push(e),3===n.Para[e][1]&&(i[e]=t[e]))}),r.empty=o.join(","),r.one=c.join(","),e.save&&(e.save[a+"_Option_Data"]=JSON.stringify(r),e.save[a+"_Option_Local"]=JSON.stringify(i)),e.backup&&n.Data.isBackup(a,"Option","Data",2)&&(e.backup.Option_Data=JSON.stringify(r)))},Menu:function(e,t){var a;a=n.App.getPlayer(e),n.Data.isStatus(a)&&t&&t({Limit:n.Option.Limit,Para:n.Para,Data:n.Option.Data[a]})},MenuSave:function(e,t){var a,r;r=n.App.getPlayer(e),a=n.Option.Data[r],n.Data.isStatus(r)&&a&&(s.is(e.data)&&(s.iterate(n.Para,function(t){n.Para[t][0]&&t in e.data&&n.Option.set(a,t,e.data[t])}),a.status=1),e.data=null,a.changed=!0,n.Data.Change(r),n.Token.InitInfo(e),n.Data.Sync(e),t&&t(a))},Set:function(e,t){var a,r,i;r=n.App.getPlayer(e),a=n.Option.Data[r],r&&a&&((i=n.Option.valid(e.id))&&n.Para[i]&&n.Para[i][0]?((r=n.Option.get(a,i))!==(i={id:i,value:n.Option.set(a,i,e.value)}).value&&(a.changed=!0,n.Data.Change()),t&&t(i)):i&&(a[i]=e.value))},Get:function(e,t){return(t=n.Option.valid(t))&&e&&s.is(n.Option.Data[e])?n.Option.get(n.Option.Data[e],t):""},set:function(e,t,a){var r;if(r=s.get(n.Para[t],0),e&&t&&r){if(1===r)e[t]=a&&"0"!==a?1:0;else if(2===r)a=u.parseIntFormat(a),t in n.Option.Limit&&(a=Math.max(Math.min(a,n.Option.Limit[t][1]),n.Option.Limit[t][0])),e[t]=a;else if(6===r)e[t]=n.Option.valid(a);else if(o.check(r,20,21,22,23)){for((a=c.check(a).split("|"))[0]=n.Option.valid(a[0]),a[1]=21<=r&&u.minMax(+a[1],0,100)||"",a[2]=22<=r&&u.minMax(+a[2],0,19)||"",a[3]=a[2]&&+a[3]||"",a[4]=23<=r?n.Option.valid(a[4]):"",a=a[0]?a.join("|"):"";a.length&&"|"===a[a.length-1];)a=a.substring(0,a.length-1);e[t]=n.Option.valid(a)}else 25===r?("|"!==(a=(c.check(a)+"|").split("|",2).join("|").trim())&&"0|"!==a&&"0"!==a||(a=""),e[t]=n.Option.valid(a)):-1===r&&(e[t]=n.Option.validTask(a));return e[t]}},get:function(e,t){var a;return a=s.get(n.Para[t],0),e&&t?1===a?e[t]?1:0:2===a?+e[t]||0:a?"string"==typeof e[t]?e[t]:"number"==typeof e[t]?(e[t]||"")+"":"":e[t]:""},getDefault:function(e,t){var a;return a=s.get(n.Para[e],0),e&&a?(t=u.minMax(n.Para[e].length-3,0,+t||0),n.Para[e][2+t]||""):""},valid:function(e){return c.check(e).replace(/[\"\;]/g,"").trim()},validTask:function(e){return c.check(e).replace(/\"/g,"").replace(/^\;*/g,"").replace(/\;*$/g,"").trim()}},n.Label={Data:{},Messages:function(e,t){"Update"===e&&n.Label.Update(t)},Init:function(e,t){var a,r;r=n.App.getPlayer(e,"copy"),a=n.Label.Data,r&&(a[r]={status:2},s.parseCopy(n.Core.resourceFile("loca/EN.json"),a[r]),s.parseCopy(n.Core.resourceFile("loca/"+e.abbrCom+".json"),a[r]),a[e.abbrCom]=s.create(a[r]),s.parseCopy(s.get(t,n.Data.getKey(r,"Label","Loca")),a[r]),s.parseCopy(s.get(t,n.Data.getKey(e.keyCom,"Label","Api")),a[r]))},Load:function(e){var t;n.App.getPlayer(e,"copy")&&((t=new XMLHttpRequest).open("GET",e.urlUni+"/api/localization.xml?nocache="+n.Time.timestamp(),!0),t.overrideMimeType("text/html"),t.setRequestHeader("Cache-Control","no-cache"),t.setRequestHeader("Pragma","no-cache"),t.onerror=t.onload=function(){var a,r,i,o,u,l,p,m;if(a={},(r=n.App.getPlayer(e))&&n.Label.Data[r]){if(200==+t.status&&t.responseText)for(i=c.check(t.responseText).split("<name"),m=0;m<i.length;m++)(o=c.check(i[m]))&&(a.status=1,p=c.getAttribute(o,"id"),l=c.check((o.split(">")[1]||"").split("<")[0]).trim(),+p&&l&&("techs"===u&&(a["L"+c.trimZero(p,Math.max(3,p.toString().length))]=l),"missions"===u&&(a["LM"+c.trimZero(p,2)]=l)),-1<o.indexOf("<techs>")&&(u="techs"),-1<o.indexOf("<missions>")&&(u="missions"));1===a.status&&(s.copy(a,n.Label.Data[r]),n.Item.Init(e),n.Data.setStorage(e.keyCom,"Label","Api",a)),n.Core.Log("Update   - Label    : "+e.urlUni+"/api/localization.xml"+(a.status=1,""),!0)}},t.send(null))},Update:function(e){var t,a,r,i,o;(a=n.App.getPlayer(e))&&s.is(e.data)&&(t={},r=s.is(e.data.localization)?e.data.localization:{},i=s.is(r.timeunits)&&r.timeunits.short?r.timeunits.short:{},t.KU0S=r.thousandSeperator||".",t.KU0C="."===r.thousandSeperator?",":".",t.KU0K=r.unitKilo||"k",t.KU0M=r.unitMega||"m",t.KU0B=r.unitMilliard||"b",t.KD0Y=i.year||"y",t.KD0W=i.week||"w",t.KD0D=i.day||"d",t.KD0H=i.hour||"h",t.KD0M=i.minute||"m",t.KD0S=i.second||"s",r=s.is(e.data.production)?e.data.production:{},o={metal:"091",crystal:"092",deuterium:"093",energy:"094"},s.iterate(o,function(e){s.is(r[e])&&(t["L"+o[e]]=(c.check(r[e].tooltip).split("|")[0]||"").trim()||e)}),n.Core.Log("Update   - Label    : "+t.KU0B+":"+t.KU0M+":"+t.KU0K+" - "+t.KD0Y+":"+t.KD0W+":"+t.KD0D+" - "+t.KD0H+":"+t.KD0M+":"+t.KD0S,!0),n.Data.setStorage(a,"Label","Loca",t),s.copy(t,n.Label.Data[a]),n.Item.Init(e))},Get:function(e,t,a){return(e=n.App.getPlayer(e))&&n.Label.Data[e]&&t?(a&&(t=1===t.length?"L00"+t:2===t.length?"L0"+t:"L"+t),t in n.Label.Data[e]?n.Label.Data[e][t]||"":t):""}},n.Styles={Data:{},opacity:33,colorType:["","#99CC00","#FFFFFF","#FD8A1C"],classType:["","ago_color_planet","ago_color_debris","ago_color_moon"],colorStatusUnits:"#6A0A0A #640 #640 #640 #004A00 #170 #0D0".split(" "),Messages:function(e,t,a){"Init"===e&&n.Styles.Init(t,a)},Init:function(e,t){var a;(a=n.App.getPlayer(e))&&t&&1===n.Data.Status[a]&&(function(e,t){function a(e,a,i,o,c){c||a&&!n.Option.Get(r,a)?(a="",i=0):(a=s.get(n.App.Page[e],"css")||"",i=+n.Option.Get(r,i)||0),a!==t.Page.file&&(t[e]||(t[e]={}),t[e].file=a),i!==t.Page.improve&&(t[e]||(t[e]={}),t[e].improve=i),t.Events&&o&&(o=+n.Option.Get(r,o)||0)!==t.Page.events&&(t[e]||(t[e]={}),t[e].events=o)}var r,i,o,c;r=e.keyPlayer,t.Main="main",n.Option.Get(r,"O50")&&(t.Planets=n.Option.Get(r,"O51")?"main_planets_improve":"main_planets"),n.Option.Get(r,"E30")&&(t.Events=n.Option.Get(r,"E31")?"main_events_improve":"main_events"),e.mobile&&(t.Mobile="ogame_mobile"),(i=n.Option.Get(r,"U11"))&&(c="  middle dark    color".split(" ")[i],o=n.Option.Get(r,"U19"),t.Skin='@import url("'+n.Config.pathSkin+'cache/cache.css");'+(c?'@import url("'+n.Config.pathSkin+"cache/"+c+'.css");':"")+(7===i&&o?"body { background: "+o+" !important; }":"")),t.Page={file:"pages",improve:0,events:+n.Option.Get(r,"E49")||0},a("overview","B01","B01","E41"),a("resources","B00","B00","E47"),a("resourcesettings","","B00","E47"),a("station","B00","B00","E47"),a("research","B00","B00",""),a("shipyard","B00","B00","E48"),a("defense","B00","B00","E48"),a("fleet1","F00","","E42"),a("fleet2","F00","","E43"),a("fleet3","F00","","E44"),a("movement","E10","E11","E45",e.mobile),a("galaxy","G40","G41","E46",e.mobile),a("empire","G20","G21",""),a("messages","","M12","")}(e,a={}),function(e,t){var a,r,i,o,c,l;if(a=e.keyPlayer,r=[],i=[],s.copy(n.Styles.colorType,i),n.Option.Get(a,"CM0")&&(s.iterate(n.Item.Mission,function(e){r.push(".ago_color_"+e+"{color:"+n.Option.Get(a,e.replace(/M/,"C"))+"!important;}")}),o=n.Option.Get(a,"CM3"),u.isMinMax(o,1,99)&&r.push("#eventContent .ago_events_reverse, #eventContent .ago_events_reverse + .ago_eventlist, #inhalt div.fleetDetails[ago_events_reverse] > span{opacity:"+n.Styles.getOpacity(o)+"!important;}")),n.Option.Get(a,"CT0"))for(o=21;80>o;o++)(c=n.Token.getColor(a,o))&&"INHERIT"!==c&&r.push("."+n.Token.getClass(a,o)+"{color:"+c+"!important;}");if(n.Option.Get(a,"CE0"))for(o=91;100>o;o++)(c=n.Token.getColor(a,o))&&"INHERIT"!==c&&r.push("."+n.Token.getClass(a,o)+"{color:"+c+"!important;}");if(n.Option.Get(a,"CS0")){for((c=n.Token.getColor(a,"S5"))&&r.push(".ago_selected_S5{box-shadow: 0 0 3px 2px "+c+", 0 0 1px 1px "+c+" inset;}"),l=1;3>=l;l++)o="S"+l,(c=n.Token.getColor(a,o))&&(i[l]=c,r.push(".ago_selection_"+o+"{color:"+c+"!important;}"),r.push(".ago_selected_"+o+"{box-shadow: 0 0 0 1px "+c+" inset;}"),r.push(".ago_selected_"+o+"_own{box-shadow: 0 0 0 1px "+c+" inset;color:"+c+"!important;}"),r.push(".ago_hover_"+o+":hover, .ago_hovered_"+o+"{box-shadow: 0 0 1px 0 "+c+" inset;}"),r.push(".ago_hover_"+o+"_own:hover{color:"+c+"!important;box-shadow: 0 0 1px 0 "+c+" inset;}"),n.Token.getCondition(a,o)&&(r.push(".ago_highlight_"+o+"{background-color:"+n.Token.getColorOpacity(a,o)+";}"),r.push(".ago_highlight_"+o+"_active{background-color:"+n.Token.getColorOpacity(a,o,"active")+";}")));n.Option.Get(a,"O55")&&((c=n.Token.getColor(a,"S1"))&&(r.push("#rechts .ago_highlight .planet-name, #rechts .ago_highlight .planet-koords{color:"+c+"!important;}"),r.push("#rechts .smallplanet:hover .planet-name, #rechts .smallplanet:hover .planet-koords{color:"+c+"!important;}")),(c=n.Token.getColor(a,"S3"))&&(r.push("#rechts .ago_highlight_S3 .planet-name, #rechts .ago_highlight_S3 .planet-koords{color:"+c+"!important;}"),r.push("#rechts .ago_highlight_S3_active .planet-name, #rechts .ago_highlight_S3_active .planet-koords{color:"+c+"!important;}"),r.push("#rechts .ago_hover_S3:hover .planet-name, #rechts .ago_hover_S3:hover .planet-koords, #rechts .ago_hovered_S3 .planet-name, #rechts .ago_hovered_S3 .planet-koords{color:"+c+"!important;}"))),(c=n.Token.getColor(a,"SA"))&&r.push(".ago_selected_SA{outline:"+c+" thin solid;}")}for(l=1;3>=l;l++)r.push("."+n.Styles.classType[l]+"{color:"+i[l]+"!important;}");t.colorType=i,t.Color=r.join("")}(e,a),t(a))},getOpacity:function(e){return"0."+(10>e?"0"+e:e)},getImport:function(e){return e?'@import url("'+n.Config.pathSkin+"ago/"+e+'.css");':""},getColor:function(e,t){return!e||4!==e.length&&7!==e.length?"":0<t&&100>t?"rgba("+(e=7===e.length?parseInt(e.substring(1,3),16)+","+parseInt(e.substring(3,5),16)+","+parseInt(e.substring(5,7),16):parseInt(e.substring(1,2),16)+","+parseInt(e.substring(2,3),16)+","+parseInt(e.substring(3,4),16))+(10>t?",0.0":",0.")+t+")":e}},n.Item={Data:{},Info:{timeResource:{index:0},metal:{index:1},crystal:{index:2},deuterium:{index:3},energy:{index:4},timeMining:{index:31},timeStation:{index:32},1:{index:33,metal:60,crystal:15,deuterium:0,factor:1.5},2:{index:34,metal:48,crystal:24,deuterium:0,factor:1.6},3:{index:35,metal:225,crystal:75,deuterium:0,factor:1.5},4:{index:36,metal:75,crystal:30,deuterium:0,factor:1.5},12:{index:37,metal:900,crystal:360,deuterium:180,factor:1.8},14:{index:38,metal:400,crystal:120,deuterium:200,factor:2},15:{index:39,metal:1e6,crystal:5e5,deuterium:1e5,factor:2},21:{index:41,metal:400,crystal:200,deuterium:100,factor:2},22:{index:42,metal:1e3,crystal:0,deuterium:0,factor:2},23:{index:43,metal:1e3,crystal:500,deuterium:0,factor:2},24:{index:44,metal:1e3,crystal:1e3,deuterium:0,factor:2},25:{index:45,metal:2645,crystal:0,deuterium:0,factor:2.3},26:{index:46,metal:2645,crystal:1322,deuterium:0,factor:2.3},27:{index:47,metal:2645,crystal:2645,deuterium:0,factor:2.3},31:{index:48,metal:200,crystal:400,deuterium:200,factor:2},33:{index:49,metal:0,crystal:5e4,deuterium:1e5,factor:2},34:{index:50,metal:2e4,crystal:4e4,deuterium:0,factor:2},41:{index:51,metal:2e4,crystal:4e4,deuterium:2e4,factor:2},42:{index:52,metal:2e4,crystal:4e4,deuterium:2e4,factor:2},43:{index:53,metal:2e6,crystal:4e6,deuterium:2e6,factor:2},44:{index:54,metal:2e4,crystal:2e4,deuterium:1e3,factor:2},timeResearch:{index:31},106:{index:32,metal:200,crystal:1e3,deuterium:200,factor:2},108:{index:33,metal:0,crystal:400,deuterium:600,factor:2},109:{index:34,metal:800,crystal:200,deuterium:0,factor:2},110:{index:35,metal:200,crystal:600,deuterium:0,factor:2},111:{index:36,metal:1e3,crystal:0,deuterium:0,factor:2},113:{index:37,metal:0,crystal:800,deuterium:400,factor:2},114:{index:38,metal:0,crystal:4e3,deuterium:2e3,factor:2},115:{index:39,metal:400,crystal:0,deuterium:600,factor:2},117:{index:40,metal:2e3,crystal:4e3,deuterium:600,factor:2},118:{index:41,metal:1e4,crystal:2e4,deuterium:6e3,factor:2},120:{index:42,metal:200,crystal:100,deuterium:0,factor:2},121:{index:43,metal:1e3,crystal:300,deuterium:100,factor:2},122:{index:44,metal:2e3,crystal:4e3,deuterium:1e3,factor:2},123:{index:45,metal:24e4,crystal:4e5,deuterium:16e4,factor:2},124:{index:46,metal:4e3,crystal:8e3,deuterium:4e3,factor:1.75},199:{index:47,metal:0,crystal:0,deuterium:0,factor:3},timeShip:{index:5},202:{index:6,metal:2e3,crystal:2e3,deuterium:0,retreat:1e3,drive:"115",speed:5e3,capacity:5e3,consumption:20},203:{index:7,metal:6e3,crystal:6e3,deuterium:0,retreat:3e3,drive:"115",speed:7500,capacity:25e3,consumption:50},204:{index:8,metal:3e3,crystal:1e3,deuterium:0,retreat:4e3,drive:"115",speed:12500,capacity:50,consumption:20},205:{index:9,metal:6e3,crystal:4e3,deuterium:0,retreat:1e4,drive:"117",speed:1e4,capacity:100,consumption:75},206:{index:10,metal:2e4,crystal:7e3,deuterium:2e3,retreat:29e3,drive:"117",speed:15e3,capacity:800,consumption:300},207:{index:11,metal:45e3,crystal:15e3,deuterium:0,retreat:6e4,drive:"118",speed:1e4,capacity:1500,consumption:500},208:{index:12,metal:1e4,crystal:2e4,deuterium:1e4,retreat:1e4,drive:"117",speed:2500,capacity:7500,consumption:1e3},209:{index:13,metal:1e4,crystal:6e3,deuterium:2e3,retreat:4500,drive:"115",speed:2e3,capacity:2e4,consumption:300},210:{index:14,metal:0,crystal:1e3,deuterium:0,retreat:0,drive:"115",speed:1e8,capacity:0,consumption:1},211:{index:15,metal:5e4,crystal:25e3,deuterium:15e3,retreat:9e4,drive:"117",speed:4e3,capacity:500,consumption:1e3},212:{index:16,metal:0,crystal:2e3,deuterium:500,retreat:0,drive:0,speed:0,capacity:0,consumption:0},213:{index:17,metal:6e4,crystal:5e4,deuterium:15e3,retreat:125e3,drive:"118",speed:5e3,capacity:2e3,consumption:1e3},214:{index:18,metal:5e6,crystal:4e6,deuterium:1e6,retreat:1e7,drive:"118",speed:100,capacity:1e6,consumption:1},215:{index:19,metal:3e4,crystal:4e4,deuterium:15e3,retreat:85e3,drive:"118",speed:1e4,capacity:750,consumption:250},timeDefense:{index:20},401:{index:21,metal:2e3,crystal:0,deuterium:0,retreat:2e3},402:{index:22,metal:1500,crystal:500,deuterium:0,retreat:2e3},403:{index:23,metal:6e3,crystal:2e3,deuterium:0,retreat:8e3},404:{index:24,metal:2e4,crystal:15e3,deuterium:2e3,retreat:37e3},405:{index:25,metal:2e3,crystal:6e3,deuterium:0,retreat:8e3},406:{index:26,metal:5e4,crystal:5e4,deuterium:3e4,retreat:13e4},407:{index:27,metal:1e4,crystal:1e4,deuterium:0,retreat:2e4},408:{index:28,metal:5e4,crystal:5e4,deuterium:0,retreat:1e5},502:{index:29,metal:8e3,crystal:0,deuterium:2e3,retreat:0},503:{index:30,metal:12500,crystal:2500,deuterium:1e4,retreat:0}},Mining:{1:1,2:1,3:1,4:1,12:1,22:1,23:1,24:1,25:1,26:1,27:1,212:1},Station:{14:1,15:1,21:1,31:1,33:1,34:1,41:1,42:1,43:1,44:1},Ship:{202:1,203:1,204:2,205:2,206:2,207:2,208:1,209:1,210:1,211:2,212:3,213:2,214:2,215:2},ShipCivil:{202:1,203:1,208:1,209:1,210:1},ShipCombat:{204:2,205:2,206:2,207:2,215:2,211:2,213:2,214:2},ShipTransport:{203:1,202:1,209:1,214:1},Defense:{401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,502:2,503:2},Resource:{metal:"091",crystal:"092",deuterium:"093"},ResourceEnergy:{metal:"091",crystal:"092",deuterium:"093",energy:"094"},Coordinates:{galaxy:1,system:1,position:1},Research:{106:8,108:10,109:3,110:6,111:2,113:12,114:-8,115:6,117:6,118:8,120:-12,121:5,122:7,123:0,124:8,199:-1},ByName:{},Mission:{M15:0,M07:0,M08:0,M03:0,M04:0,M06:0,M05:0,M01:0,M02:0,M09:0},Init:function(e){var t,a;(a=n.App.getPlayer(e))&&1==+s.get(n.Label.Data[a],"status")&&(n.Item.Data[a]={},t=n.Item.Data[a],s.iterate(n.Item.Ship,function(a){t[n.Label.Get(e,a,1)||a]=a}),s.iterate(n.Item.Defense,function(a){t[n.Label.Get(e,a,1)||a]=a}),s.iterate(n.Item.Research,function(a){t[n.Label.Get(e,a,1)||a]=a}),s.iterate(n.Item.ResourceEnergy,function(a){t[n.Label.Get(e,n.Item.ResourceEnergy[a],1)||a]=a}))},valid:function(e){return e in n.Item.Info?e:""}},n.Units={Data:{},Messages:function(e,t,a){"Action"===e?n.Units.Action(t,a):"Update"===e?n.Units.Update(t,a):"List"===e&&n.Units.List(t,a)},Start:function(e){var t,a;return a={},(t=n.Units.Data[e])&&t.account&&(a.status=t.status,a.timeResearch=n.Time.timestampMinuteConvert(t.account.timeResearch),s.iterate(n.Item.Research,function(e){a[e]=+t.account[e]||0}),a.Moons={},s.is(t)&&s.iterate(t,function(e){!isNaN(e)&&s.is(t[e])&&t[e][43]&&(a.Moons[e]={43:t[e][43]})})),a},Init:function(e,t){var a,r,i,o,u;o=n.Data.get("Units","Data","version"),(i=n.App.getPlayer(e))&&(n.Units.Data[i]={status:2,version:o},(a=n.Units.Data[i]).account={},(r=s.parse(t[n.Data.getKey(i,"Units","Data")])).version===o&&(a.status=r.status||2,r.account&&(u=c.check(r.account).split(","),n.Item.Info.timeResearch&&(a.account.timeResearch=+u[n.Item.Info.timeResearch.index]||0),s.iterate(n.Item.Research,function(e){n.Item.Info[e]&&(a.account[e]=+u[n.Item.Info[e].index]||0)})),s.iterate(r,function(e){var t;0<+e&&(a[e]={},t=c.check(r[e]).split(","),s.iterate(n.Item.Info,function(r){100<+r&&200>+r||"timeResearch"===r||(a[e][r]=+t[n.Item.Info[r].index]||0)}))})),n.Units.SummarizePlanets(e))},Save:function(e){var t,a,r,i;r=n.App.getPlayer(e),t=n.Units.Data[r],n.Data.isStatus(r)&&t&&(e.backup||t.changed)&&(i={version:t.version,status:t.status},delete t.changed,t.account&&(a=[],n.Item.Info.timeResearch&&(a[n.Item.Info.timeResearch.index]=+t.account.timeResearch||""),s.iterate(n.Item.Research,function(e){n.Item.Info[e]&&(a[n.Item.Info[e].index]=+t.account[e]||"")}),i.account=a.join(",")),n.Units.iterate(r,function(e,t){var a,r;for(a=[],s.iterate(n.Item.Info,function(t){100<+t&&200>+t||"timeResearch"===t||(a[n.Item.Info[t].index]=+e[t]||"")}),r=a.length;0<r&&!a[r-1];)r--;a.length=r,i[t]=a.join(",")}),e.save&&(e.save[r+"_Units_Data"]=JSON.stringify(i)),e.backup&&n.Data.isBackup(r,"Units","Data",2)&&(e.backup.Units_Data=JSON.stringify(i)))},Update:function(e,t){var a,r,i;r=n.App.getPlayer(e),a=n.Units.Data[r],r&&a&&s.is(e.data)&&(i=[{planet:e.planet,tabs:["Resource"],data:e.data}],(a={research:"Research",resources:"Mining",station:"Station",shipyard:"Ship",defense:"Defense",fleet1:"Ship"}[e.data.page])&&i.push({planet:"Research"===a?"account":e.planet,tabs:[a],data:e.data}),n.Units.Action({keyPlayer:r,list:i},t))},Action:function(e,t){var a,r;r=n.App.getPlayer(e),a=n.Units.Data[r],r&&a&&Array.isArray(e.list)&&(s.iterateArray(e.list,function(e){e&&function(e,t,r,i){var o,c;if(("account"===e||0<+e)&&Array.isArray(t)&&s.is(i))for(s.is(a[e])||(a[e]={}),o=a[e],c=0;c<t.length;c++)"Resource"===(e=t[c])?(s.iterate(n.Item.ResourceEnergy,function(e){o[e]=+i[e]||0}),o.resources=o.metal+o.crystal+o.deuterium,o.timeResource=n.Time.timestampMinute()):"Ship"===e?(o.shipsCivil=0,o.shipsCombat=0,s.iterate(n.Item.Ship,function(e){var t=+i[e]||0;o[e]="add"===r?(+o[e]||0)+t:"remove"===r?Math.max((+o[e]||0)-t,0):t,e in n.Item.ShipCivil&&(o.shipsCivil+=o[e]),e in n.Item.ShipCombat&&(o.shipsCombat+=o[e])}),o.ships=o.shipsCivil+o.shipsCombat,o.timeShip=n.Time.timestampMinute()):"Research"===e?(s.iterate(n.Item.Research,function(e){o[e]=+i[e]||0}),o.timeResearch=n.Time.timestampMinute(),a.status=1):n.Item[e]&&(s.iterate(n.Item[e],function(e){o[e]=+i[e]||0}),o["time"+e]=1)}(e.planet,e.tabs,e.action,e.data)}),e.planets&&(function(e){var t,n;n=0,t={account:1,status:1,version:1,changed:1},s.iterate(e,function(r){var i;n++,i=e[r],t[i]=r,s.is(a[i])||(a[i]={})}),n&&s.iterate(a,function(e){e in t||(a[e]="")})}(e.planets),n.Units.SummarizePlanets(e)),a.changed=!0,n.Data.Change()),t&&t()},List:function(e,t){var a,r,i;r=n.App.getPlayer(e),a=n.Units.Data[r],r&&a&&(i={},"summarized"===e.action&&s.iterate(a,function(e){var t;0<+e&&(t=a[e],i[e]={ships:t.ships,shipsCivil:t.shipsCivil,shipsCombat:t.shipsCombat,timeShip:t.timeShip})})),t&&t(i)},Get:function(e,t,a,r){var i;return e&&n.Units.Data[e]&&t&&n.Units.Data[e][t]&&a&&(i=n.Units.Data[e][t][a]),6===r?c.check(i):+i||0},XXsummarizeAccount:function(e){var t,a;e=n.App.getPlayer(e),t=n.Units.Data[e],e&&t&&(t.account||(t.account={}),(a=t.account).resources=0,s.iterate(n.Item.Resource,function(e){a[e]=0}),a.ships=0,a.shipsCivil=0,a.shipsCombat=0,s.iterate(n.Item.Ship,function(e){a[e]=0}),s.iterate(t,function(e){var r;0<+e&&(r=t[e],s.iterate(n.Item.Resource,function(e){a[e]+=+r[e]||0}),a.resources+=+a.resources||0,s.iterate(n.Item.Ship,function(e){a[e]+=+r[e]||0}),a.ships+=+r.ships||0,a.shipsCivil+=+r.shipsCivil||0,a.shipsCombat+=+r.shipsCombat||0)}))},SummarizePlanets:function(e){var t;t=n.App.getPlayer(e),e=n.Units.Data[t],t&&e&&n.Units.iterate(t,function(e){e.resources=0,s.iterate(n.Item.Resource,function(t){e.resources+=+e[t]||0}),e.shipsCivil=0,e.shipsCombat=0,s.iterate(n.Item.ShipCivil,function(t){e.shipsCivil+=+e[t]||0}),s.iterate(n.Item.ShipCombat,function(t){e.shipsCombat+=+e[t]||0}),e.ships=e.shipsCivil+e.shipsCombat})},SummarizePosition:function(e){function t(e){u[e]=o?(+i[e]||0)+(+o[e]||0):+i[e]||0}function a(t){var a,n;a=+s.get(i,t)||0,n=+s.get(o,t)||0,u[t]=e.moon?a&&n?a:a||n?-1:0:a}var r,i,o,c,u;return c=n.App.getPlayer(e),r=n.Units.Data[c],u={},c&&r&&(i=r[e.planet]||{},o=r[e.moon],s.iterate(n.Item.Resource,t),s.iterate(n.Item.Ship,t),s.iterate({resources:0,ships:0,shipsCivil:0,shipsCombat:0},t),a("timeResource"),a("timeShip")),u},SummarizeAccount:function(e){var t,a;return t=n.App.getPlayer(e),e=n.Units.Data[t],t&&e&&(a={resources:0,ships:0,shipsCivil:0,shipsCombat:0,timeResource:0,timeShip:0},s.iterate(n.Item.Resource,function(e){a[e]=0}),s.iterate(n.Item.Ship,function(e){a[e]=0}),n.Units.iterate(t,function(e){e.timeResource&&(a.timeResource=1),e.timeShip&&(a.timeShip=1),s.iterate(n.Item.Resource,function(t){a[t]+=+e[t]||0}),a.resources+=+e.resources||0,s.iterate(n.Item.Ship,function(t){a[t]+=+e[t]||0}),a.ships+=+e.ships||0,a.shipsCivil+=+e.shipsCivil||0,a.shipsCombat+=+e.shipsCombat||0})),a},create:function(e,t,a){var r;return r=n.Units.Data[e],e&&r&&t?s.createFilter(n.Units.Data[e][t],a):{}},iterate:function(e,t){var a,r;if(a=n.Units.Data[e],e&&a)for(r in a)a.hasOwnProperty(r)&&0<+r&&t(a[r],r)}},n.Task={splitActive:function(e,t,a){var r,i;if((e=s.split(e)).standard&&e[a]){for(i in r=AGO.Task.split(e.standard,t,-1),t=AGO.Task.split(e[a],t,-1))t[i]&&(r[i]="string"==typeof t[i]?t[i]:Math.max(t[i],0));return r.ships=0,s.iterate(n.Item.Ship,function(e){r.ships+=+r[e]||0}),r}return n.Task.split(e[a]||e.standard,t)},split:function(e,t){var a,n,r,i;if((a={galaxy:+(n=c.check(e).split(":"))[0]||0,system:+n[1]||0,position:+n[2]||0,type:+n[3]||0,mission:+n[4]||0,speed:+n[5]||0,holdingtime:+n[6]||0}).expeditiontime=+n[7]||0,a.union=+n[8]||0,a.routine=+n[9]||0,a.name=n[10]||"",a.detail=n[11]||"",a.detail2=+n[12]||0,a.preferCargo=n[13]||"",a.preferShip=n[14]||"",a.arrival=+n[15]||0,1<=t&&(a.metal=+n[16]||0,a.crystal=+n[17]||0,a.deuterium=+n[18]||0,a.preferResource=+n[19]||0,a.timeResource=+n[20]||0,a.resources=a.metal+a.crystal+a.deuterium),2<=t)for(a.timeShip=+n[21]||0,a.ships=0,i=22;35>=i;i++)r=+n[i]||0,(a[String(i+180)]=r)&&(a.ships+=r);return a},join:function(e,t){var a,n;if(s.is(e)){if((a=[e.galaxy||"",e.system||"",e.position||"",e.type||"",e.mission||"",e.speed||"",e.holdingtime||""])[7]=e.expeditiontime||"",a[8]=e.union||"",a[9]=e.routine||"",a[10]=e.name||"",a[11]=e.detail||"",a[12]=e.detail2||"",a[13]=e.preferCargo||"",a[14]=e.preferShip||"",a[15]=e.arrival||"",1<=t&&(a[16]=e.metal||"",a[17]=e.crystal||"",a[18]=e.deuterium||"",a[19]=e.preferResource||"",a[20]=e.timeResource||""),2<=t)for(a[21]=e.timeShip||"",n=22;35>=n;n++)e[String(n+180)]&&(a[n]=e[String(n+180)]||"");for(n=a.length;0<n&&!a[n-1];)n--;return a.length=n,a.join(":")}return""},getCoordsType:function(e){return s.is(e)&&e.galaxy&&e.system&&e.position&&e.type?e.galaxy+":"+e.system+":"+e.position+":"+e.type:""},updateCoordsType:function(e,t){var a;t=c.check(t),s.is(e)&&t&&(a=t.split(":"),u.isMinMax(+a[3],1,3)&&(e.type=+a[3]||0),e.galaxy=+a[0]||0,e.system=+a[1]||0,e.position=+a[2]||0,e.coords=e.galaxy+":"+e.system+":"+e.position,e.coordstype=e.type?e.coords+":"+e.type:"")},cut:function(e,t){return"string"==typeof e?e.split(":",t).join(":"):""},cutSystem:function(e){return"string"==typeof e?e.split(":",2).join(":"):""},cutCoords:function(e){return"string"==typeof e?e.split(":",3).join(":"):""},cutCoordsType:function(e){return"string"==typeof e?e.split(":",4).join(":"):""}},n.Construction={Data:{},Messages:function(e,t,a){"List"===e?n.Construction.List(t,a):"Action"===e&&n.Construction.Action(t,a)},Init:function(e,t){var a,r;(a=n.App.getPlayer(e))&&(r=s.parse(t[n.Data.getKey(a,"Construction","Data")]),n.Construction.Data[a]={version:r.version},s.iterate(r,function(e){Array.isArray(r[e])&&(n.Construction.Data[a][e]=[],r[e].forEach(function(t){n.Construction.Data[a][e].push(n.Construction.split(t))}))}),n.Construction.Upgrade(n.Construction.Data[a]))},Upgrade:function(e){var t;t=n.Data.get("Construction","Data","version"),e.version!==t&&(e.changed=!0,e.version=t,n.Data.Change())},Save:function(e){var t,a,r;r=n.App.getPlayer(e),t=n.Construction.Data[r],n.Data.isStatus(r)&&t&&(e.backup||t.changed)&&(delete t.changed,a={version:n.Data.get("Construction","Data","version")},s.iterate(t,function(e){Array.isArray(t[e])&&t[e].length&&(a[e]=[],t[e].forEach(function(t){a[e].push(n.Construction.join(t))}))}),e.save&&(e.save[r+"_Construction_Data"]=JSON.stringify(a)),e.backup&&n.Data.isBackup(r,"Construction","Data",2)&&(e.backup.Construction_Data=JSON.stringify(a)))},Action:function(e,t){var a,r,i,c,u,l,p;r=n.App.getPlayer(e),a=n.Construction.Data[r],r&&a&&e.value&&("set"===(i=e.action)?s.get(e.value,"id")&&((c=s.create(e.value)).time=0,u=n.Task.getCoordsType(c))&&(n.Construction.update(r,c),s.is(a[u])?a[u].unshift(c):a[u]=[c],a.changed=!0,n.Data.Change(),t({tab:"Construction",data:u+":0"})):"remove"===i?(u=n.Construction.getKey(e.value),l=n.Construction.getIndex(e.value),s.is(a[u])&&a[u][l]&&(a[u].splice(l,1),a.changed=!0,n.Data.Change(),t({tab:"Construction",data:u+":"+l}))):"reserve"===i?(u=n.Construction.getKey(e.value),l=n.Construction.getIndex(e.value),s.is(a[u])&&a[u][l]&&(c=s.create(a[u][l]),s.get(c,"id")&&u!==e.coords&&c.reserved&&(n.Task.updateCoordsType(c,e.coords),c.coordstype===e.coords&&(a[u].splice(l,1),u=c.coordstype,s.is(a[u])?a[u].push(c):a[u]=[c],l=a[u].length-1,a.changed=!0,n.Data.Change(),t({tab:"Construction",data:u+":"+l}))))):o.check(i,"increase","decrease","increaseRange","decreaseRange")&&(u=n.Construction.getKey(e.value),l=n.Construction.getIndex(e.value),s.is(a[u])&&a[u][l]&&(c=s.create(a[u][l]),s.get(c,"id")))&&(200>+c.id?((p={increase:1,decrease:-1}[i]||0)&&(c.increase+=p),(p={increaseRange:1,decreaseRange:-1}[i]||0)&&c.increase&&(c.range+=p)):(p={increase:1,decrease:-1,increaseRange:10,decreaseRange:-10}[i]||0)&&(c.level+=p),n.Construction.update(r,c),a[u][l]=c,a.changed=!0,n.Data.Change(),t({tab:"Construction",data:u+":"+l})))},update:function(e,t){var a,r,i,o,c,u,l;s.is(t)&&n.Item.valid(t.id)&&(a=t.id,s.copy({metal:0,crystal:0,deuterium:0,resources:0,duration:0},t),a in n.Item.Ship||a in n.Item.Defense?(t.level=Math.max(t.level,1),t.duration=t.time*t.level,t.range=0,t.increase=0,s.iterate(n.Item.Resource,function(e){var r;r=s.get(n.Item.Info[a],e),t[e]=r?r*t.level:0}),t.resources=t.metal+t.crystal+t.deuterium):(a in n.Item.Mining||a in n.Item.Station||a in n.Item.Research)&&(r=s.get(n.Item.Info[a],"factor"),t.increase=a in n.Item.Research?Math.max(t.increase||0,0):Math.max(t.increase||0,-1*t.level),t.range=t.reserved?0:0>t.increase?Math.max(Math.min(t.level+t.increase,t.range||0),0):Math.max(t.range||0,0),0>t.increase?(o=Math.max(t.level+t.increase,0),i=Math.max(o-t.range,0),c=4*n.Units.Get(e,"account","121")):(0<t.increase?(i=t.level+t.increase,o=i+t.range):i=o=t.level,c=0),t.start=i,t.stop=o,u={metal:0,crystal:0},s.iterate(n.Item.Resource,function(e){var p;if(p=s.get(n.Item.Info[a],e)){for(l=i;l<=o;l++)t[e]+=Math.floor(p*Math.pow(r,l-1));u[e]=t[e],c&&(t[e]=Math.floor(t[e]-t[e]/100*c))}}),t.duration=Math.floor((u.metal+u.crystal)*t.time),t.resources=t.metal+t.crystal+t.deuterium))},List:function(e,t){var a,r,i;r=n.App.getPlayer(e),a=n.Construction.Data[r],r&&a&&((i={tab:"Construction",list:a}).Active=n.Units.SummarizePosition({keyPlayer:r,planet:e.active}),i.Units=e.planet&&"account"!==e.planet?n.Units.SummarizePosition(e):n.Units.SummarizeAccount(e)),n.Panel.Cache(e,i),t&&t(i)},split:function(e){return(e={galaxy:+(e=c.check(e).split(":"))[0]||0,system:+e[1]||0,position:+e[2]||0,type:+e[3]||0,mission:+e[4]||0,speed:+e[5]||0,holdingtime:+e[6]||0,disabled:+e[7]||0,time:+e[8]||0,id:e[10]||"",level:+e[11]||0,increase:+e[12]||0,range:+e[13]||0,reserved:+e[14]||0,arrival:+e[15]||0,metal:+e[16]||0,crystal:+e[17]||0,deuterium:+e[18]||0,preferResource:+e[19]||0,timeResource:+e[20]||0}).resources=e.metal+e.crystal+e.deuterium,e},join:function(e){var t;if(s.is(e)){for(t=(e=[e.galaxy||"",e.system||"",e.position||"",e.type||"",e.mission||"",e.speed||"",e.holdingtime||"",e.disabled||"",e.time||"","",e.id||"",e.level||"",e.increase||"",e.range||"",e.reserved||"",e.arrival||"",e.metal||"",e.crystal||"",e.deuterium||"",e.preferResource||"",e.timeResource||""]).length;0<t&&!e[t-1];)t--;return e.length=t,e.join(":")}return""},getKey:function(e){return c.check(e).split(":",4).join(":")},getIndex:function(e){return+c.check(e).split(":")[4]||0}},n.Token={Data:{},Sort:{},Info:{21:{cls:"active"},22:{cls:"inactive"},23:{cls:"longinactive"},24:{cls:"noob"},25:{cls:"strong"},26:{cls:"honorableTarget"},27:{cls:"outlaw"},28:{cls:"banned"},29:{cls:"vacation"},30:{cls:"admin"},41:{cls:"ally_own"},42:{},43:{},44:{},45:{},46:{},47:{},48:{},49:{},51:{cls:"buddy"},52:{},53:{},54:{},55:{},56:{},57:{},58:{},59:{},61:{},62:{},63:{},64:{},65:{},66:{},67:{},68:{},69:{},71:{},72:{},73:{},74:{},75:{},76:{},77:{},78:{},79:{},81:{},91:{},92:{},94:{},95:{},96:{},97:{},98:{},99:{},S1:{},S2:{},S3:{},S4:{},S5:{},S6:{},S7:{},S8:{},S9:{},SA:{},SB:{},SC:{}},Messages:function(e,t,a){"Get"===e?n.Token.Get(t,a):"Action"===e?n.Token.Action(t,a):"List"===e&&n.Token.List(t,a)},Init:function(e,t){var a;(a=n.App.getPlayer(e))&&(n.Token.Data[a]={},n.Token.Sort[a]={},n.Data.iterate("Token",function(e,r){2<=e.tab?(n.Token.Data[a][r]=s.parse(t[n.Data.getKey(a,"Token",r)]),n.Token.Upgrade(a,r)):e.tab&&(n.Token.Data[a][r]={})}),n.Token.InitInfo(e))},InitInfo:function(e){var t,a;(a=n.App.getPlayer(e))&&n.Token.Data[a]&&(n.Token.Data[a].Info={},t=n.Token.Data[a].Info,s.iterate(n.Token.Info,function(e){var r;t[e]={},n.Token.Info[e].cls&&(t[e].cls=n.Token.Info[e].cls),(r=n.Option.Get(a,"C"+e))&&"string"==typeof r&&((r=r.split("|"))[0]&&(t[e].color=r[0],r[1]&&(t[e].opacity=+r[1]),r[2]&&(t[e].condition=+r[2]),r[3]&&(t[e].limit=+r[3]),r[4]&&(t[e].name=r[4])))}))},Upgrade:function(e,t){var a,r;r=n.Data.get("Token",t,"version"),a=n.Token.Data[e],s.is(a[t])||(a[t]={}),a[t].version!==r&&(a[t].changed=!0,a[t].version=r,n.Data.Change())},Save:function(e){var t,a;a=n.App.getPlayer(e),t=n.Token.Data[a],s.iterate(t,function(r){n.Data.isStorage(a,"Token",r)&&(e.backup||t[r].changed)&&(delete t[r].changed,e.save&&(e.save[n.Data.getKey(a,"Token",r)]=JSON.stringify(t[r])),e.backup&&n.Data.isBackup(a,"Token",r,2)&&(e.backup["Token_"+r]=JSON.stringify(t[r])))})},Action:function(e,t){var a,r,i,o,l,p,m,g;r=n.App.getPlayer(e),i=n.Token.getTab(e),a=n.Token.Data[r],o=-1===(o=+e.token||0)?o:"Alliance"!==i||!u.isMinMax(o,41,49)&&81!==o?"Player"===i&&u.isMinMax(o,51,89)?o:"Target"===i&&u.isMinMax(o,61,89)?o:0:o,r&&i&&a&&o&&(l=c.check(e.id),"Target"===i&&(1e8<e.time?l=n.Task.cutCoordsType(e.coords)||e.time:(e.time=0,l=l||n.Task.cutCoords(e.coords))),g={tab:i,action:e.action,id:l,token:o},"set"===e.action&&(p=o+"|"+c.check(e.name),"Alliance"===i&&e.tag&&(p+="|"+e.tag),"Target"===i&&(p+="|"+c.check(e.coords),e.time&&(p+="|"+e.time))),80>o?"set"===e.action?(g.changed=!0,a[i].changed=!0,a[i][l]=p):"remove"===e.action&&l in a[i]&&(g.changed=!0,a[i].changed=!0,delete a[i][l]):81===o&&s.is(a.Current)&&(l=i[0]+l,"set"===e.action?(g.changed=!0,a.Current.changed=!0,a.Current[l]=p,m=0,s.iterate(a.Current,function(e){e[0]===i[0]&&m++}),m=Math.max(0,m-n.Option.Get(r,"I05")),s.iterate(a.Current,function(e){0<m&&e[0]===i[0]&&(m--,delete a.Current[e])})):"remove"===e.action&&l in a.Current&&(g.changed=!0,a.Current.changed=!0,delete a.Current[l])),g.changed&&(s.is(n.Token.Sort[r])&&(n.Token.Sort[r][i]=null),e.refresh&&(g.Data=a),n.Data.Change())),t&&t(g)},List:function(e,t){var a,r,i,o,u;i=n.App.getPlayer(e),o=n.Token.getTab(e),a=n.Token.Data[i],o&&s.is(a)&&(n.Token.Sort[i]||(n.Token.Sort[i]={}),(r=n.Token.Sort[i])[o]||(r[o]={},s.iterate(a[o],function(e){var t;"version"!==e&&"changed"!==e&&(41<=(t=c.check(a[o][e]).split("|")[0])&&79>=t&&(r[o][t]?r[o][t].push(e):r[o][t]=[e]))}),s.iterate(a.Current,function(e){var t;"version"!==e&&"changed"!==e&&(t=c.check(a.Current[e]).split("|")[0],e[0]===o[0]&&81<=t&&89>=t&&(e=e.slice(1),r[o][t]?r[o][t].push(e):r[o][t]=[e]))})),u={tab:o,token:e.token,listTab:{},listToken:[]},s.iterate(r[o],function(e){u.listTab[e]=r[o][e].length}),e.token&&(s.iterateArray(r[o][e.token],function(t){(t=n.Token.get(a,o,e.token,t))&&u.listToken.push(t)}),"Target"===o&&e.sort?u.listToken.sort(function(e,t){var a=(s.get(e,"coords")||"").split(":"),n=(s.get(t,"coords")||"").split(":");return+a[0]<+n[0]?-1:+a[0]>+n[0]?1:+a[1]<+n[1]?-1:+a[1]>+n[1]?1:+a[2]<+n[2]?-1:+a[2]>+n[2]?1:0}):u.listToken.sort(function(e,t){var a=(s.get(e,"name")||"").toLowerCase(),n=(s.get(t,"name")||"").toLowerCase();return a<n?-1:a===n?0:1}))),n.Panel.Cache(e,u),t&&t(u)},Get:function(e,t){var a,r,i;if(a=n.App.getPlayer(e),(r=n.Token.getTab(e))&&(i=n.Token.get(n.Token.Data[a],r,e.token,e.id)),!t)return i||"";t(i)},get:function(e,t,a,r){var i;return s.is(e)&&t&&r&&(80>a?s.is(e[t])&&e[t][r]&&(i={id:r,name:n.Token.getName(e[t],r)},"Alliance"===t&&(i.tag=n.Token.getTag(e[t],r)),"Target"===t&&(i.coords=n.Token.getCoords(e[t],r),i.time=n.Token.getTime(e[t],r))):81===a&&s.is(e.Current)&&e.Current[t[0]+r]&&(i={id:r,name:n.Token.getName(e.Current,t[0]+r)},"Alliance"===t&&(i.tag=n.Token.getTag(e.Current,t[0]+r)),"Target"===t&&(i.coords=n.Token.getCoords(e.Current,t[0]+r),i.time=n.Token.getTime(e.Current,t[0]+r)))),i||""},getName:function(e,t){return s.is(e)&&t&&c.check(e[t]).split("|")[1]||""},getCoords:function(e,t){return s.is(e)&&t&&c.check(e[t]).split("|")[2]||""},getTag:function(e,t){return s.is(e)&&t&&c.check(e[t]).split("|")[2]||""},getTime:function(e,t){var a;return s.is(e)&&t?1e8<(a=+c.check(e[t]).split("|")[3]||0)?a:0:0},getColor:function(e,t){return n.Token.is(e,"Info")&&n.Token.Data[e].Info[t]&&n.Token.Data[e].Info[t].color||""},getClass:function(e,t){return n.Token.is(e,"Info")&&n.Token.Data[e].Info[t]?"status_abbr_"+(n.Token.Data[e].Info[t].cls||t):""},getCondition:function(e,t){return n.Token.is(e,"Info")&&n.Token.Data[e].Info[t]&&+n.Token.Data[e].Info[t].condition||0},getOpacity:function(e,t){return n.Token.is(e,"Info")&&n.Token.Data[e].Info[t]&&+n.Token.Data[e].Info[t].opacity||0},getColorOpacity:function(e,t,a){var r,i;return r=n.Token.getColor(e,t),i=n.Token.getOpacity(e,t),r?(i=i||(80>t?n.Option.Get(e,"CT2"):n.Styles.opacity)||100,"INHERIT"===r?i/100:n.Styles.getColor(r,a?2*i:i)):""},getTab:function(e){return s.is(e)&&e.keyPlayer&&n.Token.Data[e.keyPlayer]&&e.tab&&s.is(n.Token.Data[e.keyPlayer][e.tab])?e.tab:""},is:function(e,t){return e&&t&&n.Token.Data[e]&&s.is(n.Token.Data[e][t])?t:""}},n.Fleet={Data:{},Messages:function(e,t){"Set"===e?n.Fleet.Set(t):"Action"===e&&n.Fleet.Action(t)},Init:function(e,t){var a,r,i,o;(i=n.App.getPlayer(e))&&(a=n.Fleet.Data[i]={version:n.Data.get("Fleet","Data","version")},r=s.parse(t[n.Data.getKey(i,"Fleet","Data")]),o=a.version!==r.version,n.Data.iterate("Fleet",function(e,t){2<=e.tab?a[t]=s.is(r[t])&&!o?r[t]:3===e.tab?[]:{}:e.tab&&(a[t]={})}),o&&(a.changed=!0,n.Data.Change())),a=r=i=o=null},Save:function(e){var t,a;a=n.App.getPlayer(e),t=n.Fleet.Data[a],n.Data.isStatus(a)&&t&&(e.backup||t.changed)&&(delete t.changed,e.save&&(e.save[a+"_Fleet_Data"]=JSON.stringify(t)),e.backup&&n.Data.isBackup(a,"Fleet","Data",2)&&(e.backup.Fleet_Data=JSON.stringify(t)))},Set:function(e){var t,a,r,i;a=n.App.getPlayer(e),r=n.Data.getTab(e,"Fleet"),t=n.Fleet.Data[a],a&&r&&t&&(s.is(t[r])||(t[r]={}),s.iterate(e.data,function(a){t[r][a]!==e.data[a]&&(t[r][a]=e.data[a],i=!0)}),i&&(t.changed=!0,n.Data.Change())),t=a=r=i=null},Action:function(e){var t,a,r,i,c;if(a=n.App.getPlayer(e),r=n.Data.getTab(e,"Fleet"),t=n.Fleet.Data[a],a&&r&&t&&"Last"===r&&s.get(e.data,"coords"))if(Array.isArray(t.Last)||(t.Last=[]),i=+(r=e.data).routine||0,c=r.mission,r.routine=0,!i||o.check(i,1,2,3,4)){for(1!==c&&delete r.retreatAfterDefenderRetreat,5!==c&&delete r.holdingtime,15!==c&&delete r.expeditiontime,2!==c&&delete r.union,3===i?(1===c&&(r.routine=3),r.metal=r.crystal=r.deuterium=0):4===i?(8===c&&(r.routine=4),r.metal=r.crystal=r.deuterium=0):(2===i||r.resources)&&(!r.resources||3!==c&&4!==c?r.metal=r.crystal=r.deuterium=0:r.routine=2),i=[n.Task.join(r,2)],a=0;a<t.Last.length;a++)(e=n.Task.split(t.Last[a],2)).mission&&(r.coordstype===n.Task.cutCoordsType(t.Last[a])&&c===e.mission&&r.routine===e.routine||i.push(t.Last[a]));for(t.Last=[],a=0;a<i.length&&(i[a]&&t.Last.push(i[a]),!(8<t.Last.length));a++);t.changed=!0,n.Data.Change()}else 5===i?(e=n.Task.split(s.get(t.Routine,"Collect"))).routine&&(r.routine=e.routine,i=n.Task.cut(n.Task.join(r),10),n.Fleet.Set({keyPlayer:a,tab:"Routine",data:{Collect:i}})):6===i?(e=n.Task.split(s.get(t.Routine,"Save"))).routine&&(r.routine=e.routine,i=n.Task.cut(n.Task.join(r),10),n.Fleet.Set({keyPlayer:a,tab:"Routine",data:{Save:i}})):7===i&&(i=n.Task.cutSystem(e.coords),15===c&&i&&n.Fleet.Set({keyPlayer:a,tab:"Expo",data:s.createKey(i,(+s.get(t.Expo,i)||0)+1)}))}},n.DataBase={status:0,readLimit:2e3,Info:{Player:{keyPath:"I",hour:24,url:"/api/players.xml",split:"<player "},Universe:{keyPath:"pI",hour:168,url:"/api/universe.xml",split:"<planet "}},Data:{},Cache:{},Messages:function(e,t,a){s.is(t)&&("Remove"===e?n.DataBase.Remove(t):"Set"===e?n.DataBase.Set(t,a):"GetPlayer"===e?n.DataBase.GetPlayer(t,a):"GetPlanet"===e&&n.DataBase.GetPlanet(t,a))},Start:function(e){s.is(e.indexedDB)&&"function"==typeof e.IDBKeyRange&&(n.DataBase.indexedDB=e.indexedDB,n.DataBase.IDBKeyRange=e.IDBKeyRange,n.DataBase.status=1)},Init:function(e){var t;(t=n.App.getUni(e))&&(s.is(n.DataBase.Data[t])||(n.DataBase.Data[t]={status:0,keyUni:e.keyUni,urlUni:e.urlUni}),0<=(t=n.DataBase.Data[t]).status&&2>=t.status&&(t.status=3,t.keyPlayer=e.keyPlayer,t.api=n.Option.Get(e.keyPlayer,"D20"),n.DataBase.Open(s.create(t),"Player")))},Status:function(e){var t,a;return(a=n.App.getUni(e))&&n.DataBase.Data[a]&&(t={status:n.DataBase.Data[a].status,tab:e.tab},s.iterate(n.DataBase.Info,function(e){var r;r=n.DataBase.Data[a+"_"+e]||{},t[e]={status:+r.status||0,timestamp:+r.timestamp||0,loading:+r.loading||0,entries:+r.entries||0}})),t},Close:function(e){if(s.is(n.DataBase.Data[e])){if(s.is(n.DataBase.Data[e].db))try{n.DataBase.Data[e].db.close()}catch(e){}n.DataBase.Data[e].db=null}},Remove:function(e){var t;(t=n.App.getUni(e))&&(n.DataBase.set(t,"status",-3),s.iterate(n.DataBase.Info,function(e){var a;a=t+"_"+e,n.DataBase.Close(a),n.DataBase.Data[a]={status:-3},n.DataBase.indexedDB.deleteDatabase(a).onsuccess=function(){!function(e,t){var a;n.App.getUni({keyUni:e})&&n.DataBase.Info[t]&&(n.Core.Log("DataBase - Remove   : "+e+"_"+t,!0),a=!0,n.DataBase.set(e+"_"+t,"status",0),s.iterate(n.DataBase.Info,function(t){-3===n.DataBase.get(e+"_"+t,"status")&&(a=!1)}),a&&n.DataBase.set(e,"status",0))}(t,e)}}))},set:function(e,t,a){e&&t&&s.is(n.DataBase.Data[e])&&(n.DataBase.Data[e][t]=a)},get:function(e,t){return e&&t&&s.is(n.DataBase.Data[e])?n.DataBase.Data[e][t]:0},isStatus:function(e,t){var a,r;if((a=n.App.getUni(e))&&t&&n.DataBase.Info[t]){if(1===n.DataBase.get(a,"status"))return a=a+"_"+t,1===(r=n.DataBase.get(a,"status"))||2===r?a:"";e.error=!0}return""},ObjectStore:function(e,t,a,r){if(e&&s.is(n.DataBase.Data[e].db))try{r(n.DataBase.Data[e].db.transaction(t,a||"readonly").objectStore(t))}catch(i){n.DataBase.indexedDB.open(e).onsuccess=function(i){try{n.DataBase.Data[e].db=i.target.result}catch(t){n.DataBase.Data[e].db=null}try{r(n.DataBase.Data[e].db.transaction(t,a||"readonly").objectStore(t))}catch(e){r(null)}}}else r(null)},Set:function(e){var t;s.is(e)&&s.is(e.data)&&(t=n.DataBase.isStatus(e,"Player"),e.api=n.DataBase.get(e.keyUni,"api"),t&&s.is(e.data.Player)&&n.DataBase.ObjectStore(t,"I","readwrite",function(t){t&&s.iterate(e.data.Player,function(a){var r;(r=e.data.Player[a]).I&&(t.get(+a).onsuccess=function(a){(a=a.target.result)&&r.N===a.N&&r.s===a.s&&r.aI===a.aI||(e.api&&n.Core.Log("Galaxy - Update Player "+r.N),t.put(r))})})}),(t=n.DataBase.isStatus(e,"Universe"))&&s.is(e.data.Planet)&&n.DataBase.ObjectStore(t,"pI","readwrite",function(t){t&&s.iterate(e.data.Planet,function(a){var r;r=e.data.Planet[a],t.index("c").get(a).onsuccess=function(i){i=i.target.result,r&&!i?(e.api&&n.Core.Log("Galaxy - New planet: "+a),t.put(r)):r&&i?r.I!==i.I?(n.Core.Log("Galaxy - Different player: "+a+" - Player "+i.I),i.c="moved",t.put(i),t.put(r)):r.pI!==i.pI?(n.Core.Log("Galaxy - Different planet: "+a),i.c="moved",t.put(i),t.put(r)):r.pN===i.pN&&r.mI===i.mI&&r.mN===i.mN||(n.Core.Log("Galaxy - Update planet: "+a),t.put(r)):!r&&i&&(n.Core.Log("Galaxy - Missing planet: "+a+" - Player "+i.I),i.c="moved",t.put(i))}})}))},GetPlayer:function(e,t){function a(a){e.error&&t(e),e.planets?(a=a||{},n.DataBase.getPlanetsByPlayerId(e,function(n){a.planets=n,Array.isArray(a.planets)&&(s.iterateArray(a.planets,function(e){e&&(!a.planetHome||+e.planetId<+a.planetHome)&&(a.planetHome=e.planetId)}),1===e.planets?a.planets.sort(function(e,t){var a,n;return a=c.check(e.coords).split(":"),n=c.check(t.coords).split(":"),+a[0]<+n[0]?-1:+a[0]>+n[0]?1:+a[1]<+n[1]?-1:+a[1]>+n[1]?1:+a[2]<+n[2]?-1:+a[2]>+n[2]?1:0}):2===e.planets&&a.planets.sort(function(e,t){return c.check(e.planetName),c.check(t.planetName),e<t?-1:e===t?0:1})),t(a)})):t(a)}"function"==typeof t&&(e.id?n.DataBase.getPlayerById(e,a):e.coords?n.DataBase.getPlanetByCoords(e,function(t){e.id=s.get(t,"playerId"),n.DataBase.getPlayerById(e,a)}):t())},GetPlanet:function(e,t){"function"==typeof t&&(e.id?t():e.coords?n.DataBase.getPlanetByCoords(e,function(a){a=a||{},e.id=a.playerId,n.DataBase.getPlayerById(e,function(e){s.copy(e,a),t(a)})}):t())},getPlayerById:function(e,t){var a;if("function"==typeof t)if(a=n.DataBase.isStatus(e,"Player"))try{n.DataBase.ObjectStore(a,"I","readonly",function(a){a&&+e.id?a.get(+e.id).onsuccess=function(e){var a;e=e.target.result,s.is(e)&&e.I&&(a={playerId:(e.I||"")+"",playerName:e.N||"",playerStatus:e.s||"",allianceId:(e.aI||"")+""}),t(a)}:t()})}catch(e){t()}else t()},getPlanetsByPlayerId:function(e,t){var a;if("function"==typeof t)if(a=n.DataBase.isStatus(e,"Universe"))try{n.DataBase.ObjectStore(a,"pI","readonly",function(a){var r;a&&+e.id?(r=[],a.index("I").openCursor(n.DataBase.IDBKeyRange.only(+e.id)).onsuccess=function(e){var a,n;e.target.result?(n=e.target.result.value,s.get(n,"pI")&&(a={coords:n.c||"",planetId:(n.pI||"")+"",planetName:n.pN||""},n.mI&&(a.moonId=(n.mI||"")+"",a.moonName=n.mN||""),r.push(a)),e.target.result.continue()):t(r)}):t()})}catch(e){t()}else t()},getPlanetByCoords:function(e,t){var a;if("function"==typeof t)if(a=n.DataBase.isStatus(e,"Universe"))try{n.DataBase.ObjectStore(a,"pI","readonly",function(a){a&&e.coords?a.index("c").get(e.coords).onsuccess=function(e){var a;e=e.target.result,s.is(e)&&e.pI&&(a={playerId:(e.I||"")+"",coords:e.c||"",planetId:(e.pI||"")+"",planetName:e.pN||"",moonId:(e.mI||"")+"",moonName:e.mN||""}),t(a)}:t()})}catch(e){t()}else t()},Open:function(e,t){function a(t,a,i){r.timestamp=+i||1,r.status=a||("blocked"===t.type?-1:-2);try{r.db=t.target.result}catch(e){r.db=null}n.DataBase.Check(e)}var r,i,o;o=-3,n.App.getUni(e)&&t&&(e.key="",e.tab=t,n.DataBase.Info[e.tab]&&(e.key=e.keyUni+"_"+e.tab,s.is(n.DataBase.Data[e.key])||(n.DataBase.Data[e.key]={}),o=-1>(o=+(r=n.DataBase.Data[e.key]).status||0)?o:1===o||2===o?o:0,r.status=o)),0>o?n.DataBase.Check(e):s.is(r.db)&&r.timestamp?n.DataBase.Check(e):(r.status=4,n.DataBase.Close(e.key),(i=n.DataBase.indexedDB.open(e.key,2)).onblocked=a,i.onerror=a,i.onupgradeneeded=function(r){var o,s;o=n.DataBase.Info[e.tab].keyPath,i.onsuccess=null,(s=r.target.result).onerror=a,s.objectStoreNames.contains("info")||s.createObjectStore("info"),s.objectStoreNames.contains(o)||(o=s.createObjectStore(o,{keyPath:o}),"Universe"===t&&(o.createIndex("I","I",{unique:!1}),o.createIndex("c","c",{unique:!1}))),a(r,2)},i.onsuccess=function(e){var t;try{(t=e.target.result.transaction("info").objectStore("info").get("timestampServer")).onerror=a,t.onsuccess=function(t){a(e,1,t.target.result)}}catch(t){a(e,-2)}})},isRead:function(e){return n.status&&e.api&&e.key&&3<=n.DataBase.get(e.keyUni,"status")?n.DataBase.Data[e.key].status:0},Check:function(e){var t,a,r;1<=n.DataBase.isRead(e)?((t=n.DataBase.Data[e.key]).status=1!==t.status?t.status:1e3>t.timestamp?2:n.Time.timestamp()-t.timestamp>3600*n.DataBase.Info[e.tab].hour?2:1,2<=t.status&&(e.load||!t.timestampRead||n.Time.timestamp()-t.timestampRead>n.DataBase.readLimit)?((a=new XMLHttpRequest).timeout=2e3,a.open("HEAD",e.urlUni+n.DataBase.Info[e.tab].url,!0),a.onerror=a.onload=function(){n.DataBase.isRead(e)&&(t.timestampRead=n.Time.timestamp(),t.timestampHeader=Math.floor(new Date(a.getResponseHeader("Last-Modified")).getTime()/1e3),200==+a.status&&1e4<t.timestampHeader?t.status=t.timestamp/100<t.timestampHeader/100?3:1:(t.timestampHeader=0,n.Core.Log("DataBase   - ########## Problem: These OGame API is not available - "+e.tab,!0))),n.DataBase.Read(e)},a.send(null)):n.DataBase.Read(e)):(-1===(r=n.DataBase.get(e.key,"status"))&&n.Core.Log("DataBase   - Problem: Please restart your browser ("+e.key+")",!0),-2===r&&n.Core.Log("DataBase   - Problem: Please delete the database "+e.tab+" for the universe "+e.keyUni,!0),n.DataBase.Read(e))},Read:function(e){function t(t,r){var s,u,l,p,m,g;g=0,s=r.split(n.DataBase.Info[e.tab].split),p={a:30,v:29,b:28,o:27,h:26,I:23,i:22},m=t.target.result,i.db=t.target.result,i.entries=s.length,i.timestamp=i.timestampHeader||+c.getAttribute(s[0],"timestamp")||n.Time.timestamp(),m.objectStoreNames.contains("info")&&m.objectStoreNames.contains(o.keyPath)?((u=m.transaction("info","readwrite")).objectStore("info").put(0,"timestampServer"),u.objectStore("info").put(0,"entries"),(u=m.transaction(o.keyPath,"readwrite")).onabort=function(){a(1)},u.ontimeout=a,u.oncomplete=function(){s=null,3===n.DataBase.isRead(e)&&((u=m.transaction("info","readwrite")).objectStore("info").put(i.timestamp,"timestampServer"),u.objectStore("info").put(i.entries,"entries"),a(1))},(l=u.objectStore(o.keyPath)).clear(),"Player"===e.tab?function t(){var r,o;if(g++,3!==n.DataBase.isRead(e))a();else if(g<s.length){o=" "+s[g],r=+c.getAttribute(o,"id")||g;var u=c.getAttribute(o,"name"),m=c.getAttribute(o,"status"),d=21;m&&(m[0]&&(d=Math.max(+p[m[0]]||0,d)),m[1]&&(d=Math.max(+p[m[1]]||0,d)),m[2]&&(d=Math.max(+p[m[2]]||0,d))),r={I:r,N:u,s:d},(o=+c.getAttribute(o,"alliance")||0)&&(r.aI=o),0==g%Math.ceil(s.length/100)&&(i.loading=Math.ceil(g/(s.length/100))||1,n.Manager.message(e,"DataBase","Notify",{tab:e.tab,loading:i.loading})),l.add(r).onsuccess=t}}():"Universe"===e.tab&&function t(){var r,o;g++,3!==n.DataBase.isRead(e)?a():g<s.length&&(o=(" "+s[g]).split("<moon"),r={pI:+c.getAttribute(o[0],"id")||g,I:+c.getAttribute(o[0],"player")||2,pN:c.getAttribute(o[0],"name"),c:c.getAttribute(o[0],"coords")},o[1]&&(r.mI=+c.getAttribute(o[1],"id")||0,r.mN=c.getAttribute(o[1],"name")),0==g%Math.ceil(s.length/100)&&(i.loading=Math.ceil(g/(s.length/100))||1,n.Manager.message(e,"DataBase","Notify",{tab:e.tab,loading:i.loading})),l.add(r).onsuccess=t)}()):a(-2)}function a(t){i.status=t||-1,i.loading=0;try{i.db.close()}catch(e){}n.Manager.message(e,"DataBase","Notify",n.DataBase.Status(e)),n.Core.Log("DataBase - Read     : "+e.key+" - Finished with entries: "+(i.entries||"")+" ("+t+")",!0),r(e)}function r(e){"Player"===e.tab?n.DataBase.Open(e,"Universe"):"Universe"===e.tab&&e.keyUni&&(n.DataBase.Data[e.keyUni].status=1,s.iterate(n.DataBase.Info,function(t){0>=(t=+n.DataBase.get(e.keyUni+"_"+t,"status")||0)&&(n.DataBase.Data[e.keyUni].status=-1),3<=t&&-1!==n.DataBase.Data[e.keyUni].status&&(n.DataBase.Data[e.keyUni].status=3)}))}var i,o,u;3===n.DataBase.isRead(e)?(n.Core.Log("DataBase - Read     : "+e.key,!0),o=n.DataBase.Info[e.tab],(i=n.DataBase.Data[e.key]).loading=0,n.Manager.message(e,"DataBase","Notify",{tab:e.tab,loading:i.loading}),(u=new XMLHttpRequest).open("GET",e.urlUni+o.url,!0),u.overrideMimeType("text/html"),u.onerror=u.onload=function(){var r,i;n.DataBase.isRead(e)&&(r=u.responseText||"",200==+u.status&&-1<r.indexOf(o.split)?(n.DataBase.Close(e.key),(i=n.DataBase.indexedDB.open(e.key)).onerror=a,i.onblocked=a,i.onsuccess=function(e){t(e,r||"")}):(n.Core.Log("DataBase   - ########## Problem: These OGame API is not available - "+o.url,!0),a())),u=null},u.send(null)):r(e)}},n.Tools={Data:{},List:["A","B","C","D","E","F",1,2,3,4,5,6,7,8,9],Links:{T3A:"http://proxyforgame.com/ogame/calc/trade.php",T3B:"http://ogamespec.com/tools/trade.php",T4A:"http://proxyforgame.com/ogame/calc/flight.php",T4B:"http://www.toolsforogame.com/battle/batalla_ACS_SAC.aspx",T4C:"http://snaquekiller.free.fr/ogame/tableau.html",T7A:"http://kb.un1matr1x.de/save.php",T7B:"http://logserver.net/index.php",T9A:"http://wiki.ogame.org/",T9B:"http://board.origin.ogame.de/index.php?page=Thread&threadID=104"},Messages:function(e,t,a){"Action"===e&&n.Tools.Action(t,a)},Action:function(e,t){var a,r,i;if(r=n.App.getPlayer(e,"copy")){if(i={id:e.id},n.Option.Get(r,"T05")&&((a=n.Task.splitActive(n.Option.Get(r,"T06"),2,e.coordstype)).ships?e.Ships=s.createFilter(a,n.Item.Ship):e.planetId&&(e.Ships=n.Units.create(r,e.planetId,n.Item.ShipCombat))),s.is(e.Search))switch(e.tab=e.Search.tab,e.tab){case"Alliance":e.searchAlliance=e.Search.id,e.searchAllianceName=e.Search.name,e.searchAllianceTag=e.Search.tag;break;case"Player":e.searchPlayer=e.Search.id,e.searchPlayerName=e.Search.name;break;case"Target":e.searchTarget=e.Search.id,e.searchTargetCoords=e.Search.coords}else e.searchAlliance=n.Panel.getActive(r,"Alliance","id",6),e.searchAllianceName=n.Panel.getActive(r,"Alliance","name",6),e.searchAllianceTag=n.Panel.getActive(r,"Alliance","tag",6),e.searchPlayer=n.Panel.getActive(r,"Player","id",6),e.searchPlayerName=n.Panel.getActive(r,"Player","name",6),e.searchTarget=n.Panel.getActive(r,"Target","id",6),e.searchTargetCoords=n.Panel.getActive(r,"Target","coords",6);switch(-1<c.check(e.searchTarget).indexOf(":")&&(e.searchTarget=""),e.searchTargetMoon=3==+c.check(e.searchTargetCoords).split(":")[3],e.searchTargetCoords=n.Task.cutCoords(e.searchTargetCoords),e.id){case"T1A":n.Tools.createOgniter(e);break;case"T1B":n.Tools.createInfuza(e);break;case"T1C":n.Tools.createWarRiders(e);break;case"T2A":n.Tools.createCumulative(e);break;case"T2B":n.Tools.createOcalcAmortisation(e);break;case"T5A":n.Tools.createOsimulate(e);break;case"T5B":n.Tools.createWebsim(e);break;case"T5C":n.Tools.createDragosim(e);break;case"T5D":n.Tools.createTrashsim(e);break;default:n.Tools.createLink(e)}i.href=e.href}t&&t(i)},createLink:function(e){var t;t=n.App.getPlayer(e,"copy"),t=n.Tools.Links[e.id]||c.check(n.Option.Get(t,e.id)).split("|",2)[1],(t=c.check(t).trim())&&("http:/"!==t.slice(0,6).toLowerCase()&&"https:/"!==t.slice(0,7).toLowerCase()&&(t="http://"+t),t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\[UNI\]/g,u.parseIntAbs(e.abbrUni)||"")).replace(/\[ALLIANCE\]/g,e.searchAlliance||"")).replace(/\[ALLIANCENAME\]/g,e.searchAllianceName||"")).replace(/\[ALLIANCETAG\]/g,e.searchAllianceTag||"")).replace(/\[PLAYER\]/g,e.searchPlayer||"")).replace(/\[PLAYERNAME\]/g,e.searchPlayerName||"")).replace(/\[TARGET\]/g,e.searchTarget||"")).replace(/\[TARGETCOORDS\]/g,e.searchTargetCoords||"")).replace(/\[TARGETMOON\]/g,e.searchTargetMoon||""),e.href=t)},createWarRiders:function(e){var t,a;(a=n.Com.Get(e.abbrCom,"warriders"))&&(t="Alliance"===e.tab?"&page=details&type=ally&name="+(e.searchAllianceTag||""):"Player"===e.tab?"&page=details&type=player&name="+(e.searchPlayerName||""):"",e.href="http://ogame.gamestats.org/?lang="+a+"&uni="+(e.abbrUni||"").toLowerCase()+encodeURI(t))},createInfuza:function(e){var t;t="Alliance"===e.tab?"&pora=alliances&value="+(e.searchAllianceTag||""):"Player"===e.tab?"&pora=players&value="+(e.searchPlayerName||""):"",e.href="http://www.infuza.com/"+n.Com.Get(e.abbrCom,"infuza")+"/Search?server="+n.Com.Get(e.abbrCom,"infuzaServer")+encodeURI(t)},createOgniter:function(e){var t;t="Alliance"===e.tab?"/alliance/"+(e.searchAlliance||""):"Player"===e.tab?"/player/"+(e.searchPlayer||""):"",e.href="http://www.ogniter.org/"+n.Com.Get(e.abbrCom,"ogniter")+"/"+n.Com.Get(e.abbrCom,"ogniter")+u.parseIntAbs(e.abbrUni)+encodeURI(t)},createCumulative:function(e){var t,a;t=n.App.getPlayer(e,"copy"),a="http://calc.antigame.de/?lang="+(e.abbrCom||"").toLowerCase()+"&coords="+(e.coords||"")+"&type="+(e.type||"")+"&name="+(e.planetName||"")+"&uni_speed="+n.Uni.Get(t,"speed")+"&robo="+n.Units.Get(t,e.planetId,"14")+"&nanite="+n.Units.Get(t,e.planetId,"15")+"&rlab="+n.Units.Get(t,e.planetId,"31")+(n.Option.Get(t,"technocrat")?"&technocrat=1":""),s.iterate(n.Item.Mining,function(r){a+=c.addUrlPara(r+"c",n.Units.Get(t,e.planetId,r))}),s.iterate(n.Item.Station,function(r){a+=c.addUrlPara(r+"c",n.Units.Get(t,e.planetId,r))}),s.iterate(n.Item.Research,function(e){a+=c.addUrlPara(e+"c",n.Units.Get(t,"account",e))}),e.href=a},createOcalcAmortisation:function(e){var t,a,r;t=n.App.getPlayer(e,"copy"),r=n.Option.Get(t,"commander")&&n.Option.Get(t,"admiral")&&n.Option.Get(t,"engineer")&&n.Option.Get(t,"geologist")&&n.Option.Get(t,"technocrat")?"1.12":n.Option.Get(t,"geologist")?"1.1":"1",a="http://www.o-calc.com/?sec=_amortisation&lang="+(e.abbrCom||"").toLowerCase()+"&p="+n.Units.Get(t,"account","122")+"&g="+r+"&em=2&ec=1&ed=1&s="+n.Uni.Get(t,"speed")+"&d=",s.iterate(e.Planets,function(r){a+=encodeURI(s.get(e.Planets[r],"name"))+"."+((+s.get(e.Planets[r],"temp")||0)+40).toString(36)+"."+n.Units.Get(t,r,"1").toString(36)+"."+n.Units.Get(t,r,"2").toString(36)+"."+n.Units.Get(t,r,"3").toString(36)+"+"}),e.href=a},createOsimulate:function(e){var t,a,r;a=n.App.getPlayer(e,"copy"),t=e.Task,r="http://www.osimulate.com/?ref=antigame&lang="+n.Com.Get(e.abbrCom,"osimulate")+"&uni="+e.abbrCom+"_"+e.abbrUni+"&uni_speed="+n.Uni.Get(a,"speedFleet")+"&fleet_debris="+100*n.Uni.Get(a,"debrisFactor")+"&defense_debris="+(n.Uni.Get(a,"defToTF")?100*n.Uni.Get(a,"debrisFactorDef"):"0")+"&rapidfire="+(n.Uni.Get(a,"rapidFire")?1:0)+"&start_pos="+(e.coords||"")+"&engine0_0="+n.Units.Get(a,"account","115")+"&engine0_1="+n.Units.Get(a,"account","117")+"&engine0_2="+n.Units.Get(a,"account","118"),r=t&&!t.timeResearch&&n.Option.Get(a,"T03")?r+"&del_techs=1":r+"&tech_a0_0="+n.Units.Get(a,"account","109")+"&tech_a0_1="+n.Units.Get(a,"account","110")+"&tech_a0_2="+n.Units.Get(a,"account","111"),s.iterate(e.Ships,function(t){r+=c.addUrlPara("ship_a0_"+((+t||0)-202)+"_b",e.Ships[t])}),t&&(r+="&tech_d0_0="+(+t[109]||0)+"&tech_d0_1="+(+t[110]||0)+"&tech_d0_2="+(+t[111]||0)+"&enemy_metal="+(+t.metal||0)+"&enemy_crystal="+(+t.crystal||0)+"&enemy_deut="+(+t.deuterium||0)+"&enemy_name="+(t.name||"")+"&enemy_pos="+(t.coords||"")+"&enemy_type="+(t.type||"")+"&enemy_player="+(t.detail||"")+"&enemy_status="+(t.status||"")+"&report_time="+(t.time||"")+"&plunder_perc="+(t.plunder||"")+c.addUrlPara("abm_b",t[502]),s.iterate(n.Item.Ship,function(e){r+=c.addUrlPara("ship_d0_"+((+e||0)-202)+"_b",t[e])}),s.iterate(n.Item.Defense,function(e){1===n.Item.Defense[e]&&(r+=c.addUrlPara("ship_d0_"+((+e||0)-387)+"_b",t[e]))})),e.href=r},createWebsim:function(e){var t,a,r;a=n.App.getPlayer(e,"copy"),t=e.Task,r="http://websim.speedsim.net/index.php?version=1&ref=antigame&lang="+n.Com.Get(e.abbrCom,"websim")+"&uni="+e.abbrCom+"_"+e.abbrUni+"&uni_speed="+n.Uni.Get(a,"speedFleet")+"&perc-df="+100*n.Uni.Get(a,"debrisFactor")+"&def_to_df="+(n.Uni.Get(a,"defToTF")?1:0)+"&rf="+(n.Uni.Get(a,"rapidFire")?1:0)+"&start_pos="+(e.coords||"")+"&engine0_0="+n.Units.Get(a,"account","115")+"&engine0_1="+n.Units.Get(a,"account","117")+"&engine0_2="+n.Units.Get(a,"account","118"),r=t&&!t.timeResearch&&n.Option.Get(a,"T03")?r+"&del_techs=1":r+"&tech_a0_0="+n.Units.Get(a,"account","109")+"&tech_a0_1="+n.Units.Get(a,"account","110")+"&tech_a0_2="+n.Units.Get(a,"account","111"),s.iterate(e.Ships,function(t){r+=c.addUrlPara("ship_a0_"+((+t||0)-202)+"_b",e.Ships[t])}),t&&(r+="&tech_d0_0="+(+t[109]||0)+"&tech_d0_1="+(+t[110]||0)+"&tech_d0_2="+(+t[111]||0)+"&enemy_metal="+(+t.metal||0)+"&enemy_crystal="+(+t.crystal||0)+"&enemy_deut="+(+t.deuterium||0)+"&enemy_name="+(t.name||"")+"&enemy_pos="+(t.coords||"")+"&enemy_type="+(t.type||"")+"&enemy_player="+(t.detail||"")+"&enemy_status="+(t.status||"")+"&report_time="+(t.time||"")+"&plunder_perc="+(t.plunder||"")+c.addUrlPara("abm_b",t[502]),s.iterate(n.Item.Ship,function(e){r+=c.addUrlPara("ship_d0_"+((+e||0)-202)+"_b",t[e])}),s.iterate(n.Item.Defense,function(e){1===n.Item.Defense[e]&&(r+=c.addUrlPara("ship_d0_"+((+e||0)-387)+"_b",t[e]))})),e.href=r},createDragosim:function(e){var t,a,r,i;a=n.App.getPlayer(e,"copy"),t=e.Task,i={202:"k_t",203:"g_t",204:"l_j",205:"s_j",206:"kr",207:"sc",208:"ko",209:"re",210:"sp",211:"bo",212:"so",213:"z",214:"t",215:"sk",401:"ra",402:"l_l",403:"s_l",404:"g",405:"i",406:"p",407:"k_s",408:"g_s"},r="http://drago-sim.com/index.php?ref=antigame&lang="+n.Com.Get(e.abbrCom,"dragosim")+"&uni="+e.abbrCom+"_"+e.abbrUni+"&uni_speed="+n.Uni.Get(a,"speedFleet")+"&debris_ratio="+n.Uni.Get(a,"debrisFactor")+"&def_tf="+Boolean(n.Uni.Get(a,"defToTF"))+"&rapid_fire="+(n.Uni.Get(a,"rapidFire")?1:0),r=t&&!t.timeResearch&&n.Option.Get(a,"T03")?r+"&del_techs=1":r+"&techs[0][0][w_t]="+n.Units.Get(a,"account","109")+"&techs[0][0][s_t]="+n.Units.Get(a,"account","110")+"&techs[0][0][r_p]="+n.Units.Get(a,"account","111"),s.iterate(e.Ships,function(t){r+=c.addUrlPara("numunits[0][0]["+i[t]+"]",e.Ships[t])}),t&&(r+="&techs[1][0][w_t]="+(+t[109]||0)+"&techs[1][0][s_t]="+(+t[110]||0)+"&techs[1][0][r_p]="+(+t[111]||0)+"&v_met="+(+t.metal||0)+"&v_kris="+(+t.crystal||0)+"&v_deut="+(+t.deuterium||0)+"&v_planet="+(t.name||"")+"&v_coords="+(t.coords||"")+"&enemy_type="+(t.type||"")+"&enemy_player="+(t.detail||"")+"&enemy_status="+(t.status||"")+"&report_time="+(t.time||"")+"&plunder_perc="+(t.plunder||"")+c.addUrlPara("missiles_available_v",t[502]),s.iterate(n.Item.Ship,function(e){r+=c.addUrlPara("numunits[1][0]["+i[e]+"]",t[e])}),s.iterate(n.Item.Defense,function(e){1===n.Item.Defense[e]&&(r+=c.addUrlPara("numunits[1][0]["+i[e]+"]",t[e]))})),e.href=r},createTrashsim:function(e){var t=n.App.getPlayer(e,"copy"),a=r(e.coords.split(":"),3),i=a[0],o=a[1],c=a[2],u={0:[{research:{109:{level:n.Units.Get(t,"account","109")},110:{level:n.Units.Get(t,"account","110")},111:{level:n.Units.Get(t,"account","111")},115:{level:n.Units.Get(t,"account","115")},117:{level:n.Units.Get(t,"account","117")},118:{level:n.Units.Get(t,"account","118")}},planet:{galaxy:i,system:o,position:c},ships:{}}],settings:{speed_fleet:n.Uni.Get(t,"speedFleet"),galaxies:n.Uni.Get(t,"galaxies"),systems:n.Uni.Get(t,"systems"),rapid_fire:n.Uni.Get(t,"rapidFire"),def_to_tF:n.Uni.Get(t,"defToTF"),debris_factor:n.Uni.Get(t,"debrisFactor"),repair_factor:n.Uni.Get(t,"repairFactor"),donut_galaxy:n.Uni.Get(t,"donutGalaxy"),donut_system:n.Uni.Get(t,"donutSystem"),global_deuterium_save_factor:n.Uni.Get(t,"globalDeuteriumSaveFactor")}};if(s.iterate(e.Ships,function(t){e.Ships[t]&&(u[0][0].ships[t]={count:e.Ships[t]})}),e.Task){var l={ships:"ships",defense:"defence"},p=e.Task;u[1]=[{resources:{metal:p.metal,crystal:p.crystal,deuterium:p.deuterium},research:{},ships:{},defence:{},planet:p.coords}],s.iterate(p.research,function(e){u[1][0].research[e]={level:p.research[e]}}),s.iterate(p.units,function(e){s.iterate(p.units[e],function(t){u[1][0][l[e]][t]={count:p.units[e][t]}})})}u=window.btoa(JSON.stringify(u));var m="https://trashsim.universeview.be/"+n.Com.Get(e.abbrCom,"trashsim")+(e.api?"?SR_KEY="+e.api:"")+"#prefill="+u;e.href=m}},n.Panel={Data:{},Messages:function(e,t,a){"Set"===e?n.Panel.Set(t):"ListAccount"===e&&n.Panel.ListAccount(t,a)},Init:function(e,t){var a,r,i,o;(o=n.App.getPlayer(e))&&(n.Panel.Data[o]={},a=n.Panel.Data[o],(r=s.parse(t[n.Data.getKey(o,"Panel","Data")])).version!==n.Data.get("Panel","Data","version")&&(r={}),n.Data.iterate("Panel",function(e,t){e.tab&&(a[t]={},"label"in e&&(a[t].label=e.label||""),2<=e.tab&&(i=s.is(r[t])?r[t]:[],a[t].status=+i[0]||0,a[t].data=c.check(i[1])))}))},Save:function(e){var t,a,r;a=n.App.getPlayer(e),t=n.Panel.Data[a],n.Data.isStatus(a)&&t&&(e.backup||t.changed)&&(delete t.changed,r={version:n.Data.get("Panel","Data","version")},n.Data.iterate("Panel",function(e,t){2<=e.tab&&(r[t]=[n.Panel.get(a,t,"status"),n.Panel.get(a,t,"data",6)])}),e.save&&(e.save[a+"_Panel_Data"]=JSON.stringify(r)),e.backup&&n.Data.isBackup(a,"Panel","Data",2)&&(e.backup.Panel_Data=JSON.stringify(r)))},Cache:function(e,t){var a;a=n.App.getPlayer(e),n.Panel.Data[a]&&(n.Panel.Data[a].Cache=t)},ListAccount:function(e,t){var a,r,i;r=n.App.getPlayer(e),a=n.Panel.Data[r],r&&a&&((i={tab:"Account",statusColor:{}}).Units=e.planet&&"account"!==e.planet?n.Units.SummarizePosition(e):n.Units.SummarizeAccount(e),n.Units.iterate(r,function(e,t){var a,r=i.statusColor,o=+e.timeShip,s=+e.timeResource;o?a=3600<(o=n.Time.timestampMinute()-o)?4:60<o?5:6:s&&(a=3600<(o=n.Time.timestampMinute()-s)?1:60<o?2:3),r[t]=n.Styles.colorStatusUnits[a||0]||""})),t&&t(i)},Set:function(e){var t,a;a=n.App.getPlayer(e),t=n.Panel.Data[a],a&&t&&(a=n.Panel.getTab(e))&&e.key&&((s.is(e.value)||t[a][e.key]!==e.value)&&(t.changed=!0,n.Data.Change()),t[a][e.key]=e.value)},get:function(e,t,a,r){return e=e&&n.Panel.Data[e]&&t&&n.Panel.Data[e][t]&&a?n.Panel.Data[e][t][a]:"",6===r?c.check(e):+e||0},getActive:function(e,t,a,r){var i;return e&&n.Panel.Data[e]&&t&&n.Panel.Data[e][t]&&a&&(i=s.get(n.Panel.Data[e][t].active,a)),6===r?c.check(i):+i||0},getTab:function(e){return e.tab&&s.is(n.Panel.Data[e.keyPlayer][e.tab])?e.tab:""}},n.Box={Data:{},Messages:function(e,t,a){"List"===e&&n.Box.List(t,a)},Init:function(e){var t;(e=n.App.getPlayer(e))&&(n.Box.Data[e]={},t=n.Box.Data[e],n.Data.iterate("Box",function(e,a){e.tab&&(t[a]={})}))},List:function(e,t){var a;(a=n.App.getPlayer(e,"copy"))&&n.Box.Data[a]?n.DataBase.GetPlayer(e,function(r){(r=r||{}).tab=e.tab,r.id=e.id,n.Box.Data[a].Cache=r,t&&t(r)}):t&&t()}},n.Para={A00:[0],A01:[0],A02:[0],A03:[0],A04:[0],A05:[0],A06:[0],A07:[0],A08:[0],A10:[6,1,""],A11:[0],A30:[0],A31:[1,1,1,0,1,1],A32:[1,1,1,0,1,1],A34:[1,1,1,0,1,1],A33:[1,1,1],A38:[0],A39:[0],A50:[0],A51:[0],A52:[0],A53:[0],A54:[0],A55:[0],A56:[0],A57:[0],A59:[0],A80:[0],A81:[0],A82:[0],A83:[0],A90:[0],A99:[0],AH1:[0],AH2:[0],AH3:[0],AH5:[0],AH6:[0],AH8:[0],AH9:[0],AI1:[0],AI2:[0],AM0:[0],AM1:[0],AM2:[0],AM3:[0],AT0:[0],AT1:[0],AT2:[0],AT3:[0],AT4:[0],AT5:[0],AT6:[0],AT7:[0],AT8:[0],AT9:[0],ATC:[0],ATR:[0],ATS:[0],ATT:[0],U00:[0],U10:[0],U11:[2,1,0],U13:[0],U14:[0],U15:[0],U18:[0],U19:[20,1,"#03060b"],U22:[6,1,""],U30:[0],U31:[1,1,1,1,1,1],U32:[1,1,1,0,1,1],U33:[1,1,0,0,0,1],U34:[1,1,1,0,1,1],U35:[1,1,1],U41:[1,1,1],U51:[2,1,1],U52:[2,1,1],U60:[1,1,1,0,1,1],U61:[1,1,1,0,1,1],U62:[2,1,8],U65:[2,1,8],U66:[2,1,0],U67:[2,1,0],B00:[1,1,1],B01:[1,1,1],B02:[1,1,1],B04:[1,1,1,0,1,1],B11:[1,2,1],B12:[1,2,0],B15:[1,2,0],B16:[2,2,"203"],B17:[0],B18:[0],B19:[0],B20:[1,2,0],B21:[2,1,3],B22:[0],B23:[0],B24:[0],B31:[1,2,1,0,1,1],B32:[6,1,"2:1:1"],B35:[2,1,0],B36:[0],B37:[0],B38:[0],B40:[0],B80:[0],C00:[0],CA4:[0],CA5:[0],CA6:[0],CA7:[0],CA9:[0],CM0:[1,1,1],CM3:[2,1,55],C01:[20,1,"#D43635"],C02:[20,1,"#D43635"],C03:[20,1,"#7EAD3D"],C04:[20,1,"#36B588"],C05:[20,1,"#D57936"],C06:[20,1,"#BD9B2F"],C07:[20,1,"#2BBFBF"],C08:[20,1,"#11A140"],C09:[20,1,"#FF3356"],C15:[20,1,"#4162A5"],CT0:[1,1,1],CT2:[2,1,33],C20:[0],C21:[22,1,"#CFCBC2",""],C22:[22,1,"#6E6E6E",""],C23:[22,1,"#4F4F4F",""],C24:[22,1,"#05FF08",""],C25:[22,1,"#FF0000",""],C26:[22,1,"#FFFF66",""],C27:[22,1,"#FF33FF","#FF33FF||1"],C28:[22,1,"#FFFFFF","#FFFFFF|66|1"],C29:[22,1,"#00FFFF","INHERIT||1"],C30:[22,1,"#F48406",""],C40:[0],C41:[23,1,"#008000",""],C42:[23,1,"#008000",""],C43:[23,1,"#008000",""],C44:[23,1,"#008080",""],C45:[23,1,"#008080"],C46:[23,1,"#226EBF"],C47:[23,1,"#226EBF",""],C48:[23,1,"#ff0000",""],C49:[23,1,"#ff0000"],C50:[0],C51:[23,1,"#226EBF"],C52:[23,1,"#226EBF"],C53:[23,1,"#226EBF",""],C54:[23,1,"#226EBF",""],C55:[23,1,"#008080"],C56:[23,1,""],C57:[23,1,""],C58:[23,1,""],C59:[23,1,""],C60:[0],C61:[23,1,"#ffff00",""],C62:[23,1,"#ffff00","#ffff00||1"],C63:[23,1,"#ffff00",""],C64:[23,1,"#ffa500"],C65:[23,1,"#ffa500",""],C66:[23,1,"#ff4500","#ff4500||10"],C67:[23,1,"#ff0000"],C68:[23,1,""],C69:[23,1,""],C71:[23,1,""],C72:[23,1,""],C73:[23,1,""],C74:[23,1,""],C75:[23,1,""],C76:[23,1,""],C77:[23,1,""],C78:[23,1,""],C79:[23,1,""],CS0:[1,1,1],CS1:[22,1,"#99CC00","#99CC00|11|1"],CS2:[22,1,"#FFFFFF","#FFFFFF|11|1"],CS3:[22,1,"#FF9600","#FF9600|11|1"],CS5:[20,1,"#FF9600"],CSA:[20,1,"#69AFFC"],CSB:[20,1,"#1031A0"],CSC:[20,1,"#FF1ADA"],CE0:[1,1,1],C94:[22,1,"#D43635","#D43635||13|10000"],C95:[22,1,"#D43635","#D43635|66|13|1000000"],C96:[22,1,"#D43635","#D43635|88"],C97:[22,1,"#764DFF",""],C98:[22,1,"#764DFF",""],C99:[22,1,"#764DFF","#764DFF|88"],H01:[0],H02:[0],H03:[0],H05:[0],H06:[0],H07:[0],H08:[0],H10:[0],H11:[0],H13:[0],H15:[0],H16:[0],H18:[0],H21:[0],D00:[0],D01:[0],D02:[0],D03:[0],D04:[2,1,2,1,2,3],D05:[0],D06:[0],D07:[0],D08:[0],D09:[0],D0B:[0],D10:[6,0,""],D11:[0],D12:[0],D15:[0],D19:[0],D20:[1,1,1],D22:[0],D23:[0],D26:[0],D27:[0],D29:[0],D36:[0],D37:[0],D41:[0],D45:[0],D46:[0],D47:[0],D49:[0],D60:[1,1,1],D61:[2,1,1],D62:[6,1,""],D67:[0],D68:[0],D69:[0],D70:[0],D71:[2,3,1],D72:[0],D77:[0],D78:[0],D79:[0],D7A:[0],D80:[0],D81:[2,3,1],D82:[0],D85:[1,1,0],D87:[0],D88:[0],D89:[0],D8A:[0],D90:[0],D91:[0],D92:[0],D93:[0],D95:[0],D9A:[0],D9B:[0],D9C:[0],D9D:[0],D9E:[0],D9F:[0],DT1:[0],DX1:[2,0,0],DX2:[0],DX4:[0],DX6:[0],DX8:[0],DX9:[0],O00:[0],O02:[1,1,1],O03:[2,1,0],O04:[1,1,1,0,1,1],O50:[1,1,1],O51:[1,1,1],O52:[1,1,0],O53:[1,1,1],O54:[1,1,1],O55:[1,1,1],O60:[1,1,1],O61:[1,1,1],O70:[0],O71:[2,1,0],I00:[1,1,1],I02:[2,3,9],I03:[2,3,0],I04:[2,3,0],I05:[2,1,12],I0A:[0],I0B:[0],I0C:[0],I0D:[0],I0E:[0],I0T:[0],I10:[0],I20:[0],I21:[2,2,0],I22:[1,2,0],I23:[0],I24:[1,2,1],I25:[1,2,1],I26:[1,2,1],I27:[0],I28:[0],I29:[0],I30:[0],I31:[1,2,1],I32:[1,2,0],I33:[1,2,1],I34:[1,2,1],I35:[1,2,0],I36:[1,2,1],I37:[1,2,1],I38:[1,2,1],I39:[0],I3A:[0],I3B:[0],I40:[0],I41:[2,2,0],I42:[1,2,0],I47:[0],I80:[0],I81:[1,2,0,0,0,1],I82:[1,2,0,0,0,1],I83:[1,2,0,0,0,1],I84:[2,2,0],I85:[2,2,50],I90:[0],T00:[1,1,1],T01:[1,2,0],T02:[1,1,1],T03:[1,1,1],T05:[1,2,1],T06:[-1,1,""],T10:[0],T1A:[1,1,1],T1B:[1,1,1],T1C:[1,1,0],T11:[25,1,""],T12:[25,1,""],T13:[25,1,""],T14:[25,1,""],T15:[25,1,""],T16:[25,1,""],T17:[25,1,""],T18:[25,1,""],T19:[25,1,""],T20:[0],T2A:[1,1,1],T2B:[1,1,1],T21:[25,1,""],T22:[25,1,""],T23:[25,1,""],T24:[25,1,""],T25:[25,1,""],T26:[25,1,""],T27:[25,1,""],T28:[25,1,""],T29:[25,1,""],T30:[0],T3A:[1,1,1],T3B:[1,1,1],T31:[25,1,""],T32:[25,1,""],T33:[25,1,""],T34:[25,1,""],T35:[25,1,""],T36:[25,1,""],T37:[25,1,""],T38:[25,1,""],T39:[25,1,""],T40:[0],T4A:[1,1,1],T4B:[1,1,1],T4C:[1,1,1],T41:[25,1,""],T42:[25,1,""],T43:[25,1,""],T44:[25,1,""],T45:[25,1,""],T46:[25,1,""],T47:[25,1,""],T48:[25,1,""],T49:[25,1,""],T50:[0],T5A:[1,1,1],T5B:[1,1,1],T5C:[1,1,1],T5D:[1,1,1],T51:[25,1,""],T52:[25,1,""],T53:[25,1,""],T54:[25,1,""],T55:[25,1,""],T56:[25,1,""],T57:[25,1,""],T58:[25,1,""],T59:[25,1,""],T60:[0],T61:[25,1,""],T62:[25,1,""],T63:[25,1,""],T64:[25,1,""],T65:[25,1,""],T66:[25,1,""],T67:[25,1,""],T68:[25,1,""],T69:[25,1,""],T70:[0],T7A:[1,1,1],T7B:[1,1,1],T71:[25,1,"OGotcha|https://ogotcha.universeview.be/"],T72:[25,1,""],T73:[25,1,""],T74:[25,1,""],T75:[25,1,""],T76:[25,1,""],T77:[25,1,""],T78:[25,1,""],T79:[25,1,""],T80:[0],T81:[25,1,"Tools for Ogame|www.toolsforogame.com/"],T82:[25,1,"oRaiders|http://www.oraiders.com/"],T83:[25,1,"o-calc|o-calc.com/"],T84:[25,1,"Online tools|proxyforgame.com/"],T85:[25,1,"Project AlTernative|www.projet-alternative.fr/"],T86:[25,1,"o-tools|www.ghiroblu.com/o-tools/"],T87:[25,1,""],T88:[25,1,""],T89:[25,1,""],T90:[0],T9A:[1,1,1],T9B:[1,1,1],T91:[25,1,""],T92:[25,1,""],T93:[25,1,""],T94:[25,1,""],T95:[25,1,""],T96:[25,1,""],T97:[25,1,""],T98:[25,1,""],T99:[25,1,""],F00:[1,1,1],F01:[1,3,0],F02:[2,1,3],F03:[1,1,1,0,1,1],F05:[0],F06:[0],F07:[0],F08:[0],F09:[0],F13:[1,2,1],F14:[1,2,0],F15:[1,2,0],F16:[1,2,1,0,1,1],F18:[1,2,1],F19:[2,1,0],F21:[0],F22:[0],F23:[0],F24:[0],F26:[0],F28:[0],F31:[-1,1,""],F37:[0],F38:[0],F39:[0],F40:[0],F41:[-1,1,""],F42:[-1,1,""],F43:[-1,1,""],F44:[-1,1,""],F45:[-1,1,""],F46:[-1,1,""],F47:[-1,1,""],F48:[-1,1,""],F49:[-1,1,""],F50:[0],F51:[1,1,1],F52:[1,1,1],F53:[1,1,1],F54:[1,1,0],F60:[0],F62:[2,2,1],F63:[6,2,""],F65:[0],F67:[0],F70:[2,1,3],F71:[-1,1,""],F73:[1,1,1],F80:[2,1,3],F81:[-1,1,""],F90:[2,1,3],F91:[-1,1,""],FH0:[2,1,3],FA0:[2,1,3],FA1:[2,2,0],FA2:[2,1,0],FA3:[2,1,0],FA4:[2,1,10],FL0:[2,1,3],FL2:[2,1,0],E00:[0],E01:[0],E02:[0],E10:[1,1,1],E11:[1,1,1],E12:[1,1,0],E13:[1,1,0],E14:[1,1,1],E17:[0],E18:[0],E20:[1,1,1],E21:[1,1,1],E22:[1,1,0],E23:[2,2,1],E28:[0],E30:[1,1,1],E31:[1,1,1],E32:[1,1,0],E34:[1,1,0],E41:[2,1,3],E42:[2,1,3],E43:[2,1,3],E44:[2,1,3],E45:[2,1,3],E46:[2,1,3],E47:[2,1,3],E48:[2,1,3],E49:[2,1,3],E70:[0],E71:[0],E72:[0],E73:[0],E74:[0],E75:[0],E76:[0],E77:[0],E78:[0],G00:[0],G20:[1,1,1],G21:[1,1,1],G30:[1,1,1],G31:[1,1,1],G32:[1,1,0],G33:[1,1,1],G34:[1,2,0],G35:[1,2,0],G38:[-1,1,""],G40:[1,1,1],G41:[1,1,1],G42:[2,1,0],G43:[1,1,1],G44:[1,1,1],G45:[2,1,3],G46:[0],G47:[0],G48:[0],G51:[1,1,0,0,0,1],G52:[1,2,1],G58:[1,1,0],M04:[1,1,1],M05:[2,1,8],M06:[2,1,1e4],M10:[0],M12:[1,1,1],M14:[1,1,1],M16:[1,1,0],M20:[1,1,1],M22:[0],M24:[0],M28:[2,1,4],M30:[1,1,0],M31:[0],M32:[0],M33:[0],M34:[0],M35:[0],M36:[2,1,10],M37:[2,1,20],M51:[1,2,1],M52:[1,2,1],M53:[1,2,0],M54:[1,2,0],M70:[0],M74:[1,1,1],M80:[0],M81:[0],M82:[0],M83:[0],M84:[0],M85:[0],M86:[0],M87:[0],M88:[6,1,""],M89:[6,1,""],M90:[6,1,""],M91:[0],M92:[0],S21:[0],S24:[1,1,1,0,1,1],S25:[0],S26:[0],S27:[0],S29:[2,1,0],S2B:[0],S40:[0],S41:[0],S44:[1,1,0],S45:[1,1,0],S46:[1,1,0],S48:[1,1,0],S50:[0],S51:[0],S52:[0],S53:[0],S55:[0],S57:[0],S58:[0],S63:[0],S64:[0],S65:[0],S66:[0],S68:[0],S71:[0],S72:[0],S73:[0],S77:[0],S78:[0],S80:[0],S81:[0],S82:[0],S83:[0],S84:[0],S85:[0],B09:[2,1,2],X01:[0],X02:[0],X03:[0]},n.Manager={Start:function(){n.status=1,n.Config.pathSkin=chrome.extension.getURL("/skin/"),n.Config.id=chrome.runtime.id,n.Config.version=chrome.runtime.getManifest().version,n.Config.name=c.check(chrome.runtime.getManifest().name),n.Config.beta=-1<n.Config.name.indexOf("Alpha")?2:-1<n.Config.name.indexOf("Beta")?1:0,n.DataBase?n.DataBase.Start(window):n.DataBase={},n.Storage.Start(function(){var e;e=1<n.Config.beta?"  - Development mode":"",e+=n.Storage.status?"  Storage Quota: local "+chrome.storage.local.QUOTA_BYTES+"  sync "+chrome.storage.local.QUOTA_BYTES:"  Something wrong with chrome.storage",n.Core.Log("Start  Storage: "+n.Storage.status+"  DataBase: "+n.DataBase.status+(e||""),!0)})},Check:function(e,t,a){if(s.is(a)&&s.is(t)&&"loading"===t.status){var r=n.App.Check(a.url);s.is(r)&&r.mode&&n.Manager.Load(r,e)}},Load:function(e,t){1===e.mode&&chrome.tabs.executeScript(t,{file:"js/coordinates.js",runAt:"document_start"})},loadScripts:function(e,t){if(s.is(e)&&t)for(var a=0;a<e.length;a++)e[a]&&chrome.tabs.executeScript(t,{file:"js/"+e[a]+".js",runAt:"document_start"})},message:function(e,t,a,r){var i=n.App.getPlayer(e);i&&chrome.tabs.query({url:"*://*.ogame.gameforge.com/*"},function(e){for(var n=0;n<e.length;n++)e[n]&&e[n].id&&chrome.tabs.sendMessage(e[n].id,{player:i,page:t,role:a,data:r})})}},chrome.tabs.onUpdated.addListener(n.Manager.Check),chrome.runtime.onMessage.addListener(function(e,t,a){if(a="function"==typeof a?a:null,(t="object"===i(t)&&t.tab?t.tab.id:"")&&"object"===i(e)&&("Log"===e.page?window.console.log("AntiGameReborn:  "+e.para):"Storage"===e.page?"Set"===e.role?n.Storage.Set(e.para):"Get"===e.role?n.Storage.Get(e.para,a):"Remove"===e.role?n.Storage.Remove(e.para):"RemoveFilter"===e.role&&n.Storage.RemoveFilter(e.para,a):"Update"===e.page&&"Check"===e.role?chrome.runtime.requestUpdateCheck(function(t){n.Manager.message(e.para,"Menu","Install",t)}):e.page&&s.is(n[e.page])&&"function"==typeof n[e.page].Messages&&n[e.page].Messages(e.role,e.para,a,t),a))return!0}),n.Storage={status:0,Start:function(e){var t;n.Storage.status=0,chrome.storage&&chrome.storage.local?(t=Math.floor(Date.now()/1e3),chrome.storage.local.set({App_Start:t},function(){chrome.storage.local.get(["App_Start"],function(a){n.Storage.status=s.is(a)&&+a.App_Start===t?1:0,e()})})):e()},Set:function(e,t){var a,n;s.is(e)&&(a=e.sync?"sync":"local",e.key?(n={})[e.key]=e.data:(n=e.data,s.is(n)&&Object.keys(n).length&&(t?chrome.storage[a].set(n,function(){t(chrome.runtime.lastError?-1:1)}):chrome.storage[a].set(n))))},Get:function(e,t){var a;t&&(s.is(e)&&e.key?(a=e.sync?"sync":"local",s.is(e.key)?chrome.storage[a].get(Object.keys(e.key),t):chrome.storage[a].get(e.key,function(a){t(s.is(a)&&a[e.key]||"")})):t(""))},Remove:function(e){var t;s.is(e)&&e.key&&(t=e.sync?"sync":"local",n.Core.Log("Delete - storage  - "+e.key,!0),chrome.storage[t].remove(e.key))},List:function(e){s.is(e)&&(chrome.storage.local.get(null,function(t){s.iterate(t,function(t){e.filter&&0!==c.check(t).indexOf(e.filter)||n.Core.Log("List - storage  - "+t,!0)})}),chrome.storage.sync.get(null,function(t){s.iterate(t,function(t){e.filter&&0!==c.check(t).indexOf(e.filter)||n.Core.Log("List - sync  - "+t,!0)})}))},RemoveFilter:function(e){s.is(e)&&(chrome.storage.local.get(null,function(t){s.iterate(t,function(t){e.filter&&0!==c.check(t).indexOf(e.filter)||(n.Core.Log("Delete - storage  - "+t,!0),chrome.storage.local.remove(t))})}),chrome.storage.sync.get(null,function(t){s.iterate(t,function(t){e.filter&&0!==c.check(t).indexOf(e.filter)||(n.Core.Log("Delete - sync  - "+t,!0),chrome.storage.sync.remove(t))})}))},Sync:function(e){}},n.Config={id:"",beta:0,version:"",pathSkin:""},n.Core={Log:function(e,t){if(n.Config.beta||t){var a=new Date,r=c.trimZero(a.getHours(),2),i=c.trimZero(a.getMinutes(),2),o=c.trimZero(a.getSeconds(),2);window.console.log("AntiGameRebornX:  ".concat(r,":").concat(i,":").concat(o,"  ").concat(e))}},setTimeout:function(e,t){return window.setTimeout(e,t)},clearTimeout:function(e){e&&(window.clearTimeout(e),e=null)},resourceFile:function(e){var t;if(e)try{return(t=new XMLHttpRequest).open("GET",chrome.extension.getURL(e),!1),t.overrideMimeType("text/plain"),t.send(null),t.responseText||""}catch(e){return""}return""}},window.setTimeout(function(){n.Manager&&n.Manager.Start()},1e3)}}));